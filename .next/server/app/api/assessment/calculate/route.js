"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/assessment/calculate/route";
exports.ids = ["app/api/assessment/calculate/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate%2Froute&page=%2Fapi%2Fassessment%2Fcalculate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate%2Froute&page=%2Fapi%2Fassessment%2Fcalculate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_am112_OneDrive_Clients_MBTI_src_app_api_assessment_calculate_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/assessment/calculate/route.ts */ \"(rsc)/./src/app/api/assessment/calculate/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/assessment/calculate/route\",\n        pathname: \"/api/assessment/calculate\",\n        filename: \"route\",\n        bundlePath: \"app/api/assessment/calculate/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\am112\\\\OneDrive\\\\سطح المكتب\\\\Clients\\\\MBTI\\\\src\\\\app\\\\api\\\\assessment\\\\calculate\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_am112_OneDrive_Clients_MBTI_src_app_api_assessment_calculate_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/assessment/calculate/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhc3Nlc3NtZW50JTJGY2FsY3VsYXRlJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhc3Nlc3NtZW50JTJGY2FsY3VsYXRlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYXNzZXNzbWVudCUyRmNhbGN1bGF0ZSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNhbTExMiU1Q09uZURyaXZlJTVDJUQ4JUIzJUQ4JUI3JUQ4JUFEJTIwJUQ4JUE3JUQ5JTg0JUQ5JTg1JUQ5JTgzJUQ4JUFBJUQ4JUE4JTVDQ2xpZW50cyU1Q01CVEklNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q2FtMTEyJTVDT25lRHJpdmUlNUMlRDglQjMlRDglQjclRDglQUQlMjAlRDglQTclRDklODQlRDklODUlRDklODMlRDglQUElRDglQTglNUNDbGllbnRzJTVDTUJUSSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDcUQ7QUFDbEk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYnRpLWNvYWNoaW5nLXBsYXRmb3JtLz9mZTEzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXGFtMTEyXFxcXE9uZURyaXZlXFxcXNiz2LfYrSDYp9mE2YXZg9iq2KhcXFxcQ2xpZW50c1xcXFxNQlRJXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFzc2Vzc21lbnRcXFxcY2FsY3VsYXRlXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2Fzc2Vzc21lbnQvY2FsY3VsYXRlXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXGFtMTEyXFxcXE9uZURyaXZlXFxcXNiz2LfYrSDYp9mE2YXZg9iq2KhcXFxcQ2xpZW50c1xcXFxNQlRJXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFzc2Vzc21lbnRcXFxcY2FsY3VsYXRlXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate%2Froute&page=%2Fapi%2Fassessment%2Fcalculate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/assessment/calculate/route.ts":
/*!***************************************************!*\
  !*** ./src/app/api/assessment/calculate/route.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   OPTIONS: () => (/* binding */ OPTIONS),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_MBTICalculatorService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/MBTICalculatorService */ \"(rsc)/./src/lib/services/MBTICalculatorService.ts\");\n/* harmony import */ var _lib_services_ValidationService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/services/ValidationService */ \"(rsc)/./src/lib/services/ValidationService.ts\");\n\n\n\n// Simple in-memory cache for demonstration\nconst responseCache = new Map();\nconst CACHE_TTL = 1000 * 60 * 5 // 5 minutes\n;\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { sessionId, responses, methodology, isInterim } = body;\n        // Validate request body\n        if (!sessionId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Session ID is required\",\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        if (!responses || !Array.isArray(responses)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Responses array is required\",\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        if (!methodology) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Methodology is required\",\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        // Validate methodology\n        const validationService = _lib_services_ValidationService__WEBPACK_IMPORTED_MODULE_2__.ValidationService.getInstance();\n        if (!validationService.validateMethodology(methodology)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid methodology. Must be one of: scenarios, traits, sais\",\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        // Generate cache key\n        const cacheKey = `${sessionId}-${methodology}-${responses.length}-${JSON.stringify(responses)}`;\n        // Check cache\n        const cached = responseCache.get(cacheKey);\n        if (cached && Date.now() - cached.timestamp < CACHE_TTL) {\n            const cachedResult = {\n                ...cached.result,\n                cacheHit: true\n            };\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                data: cachedResult,\n                timestamp: new Date().toISOString()\n            });\n        }\n        // Sanitize and validate responses\n        const sanitizedResponses = validationService.sanitizeResponses(responses);\n        const validationResult = validationService.validateResponses(sanitizedResponses, methodology);\n        if (!validationResult.isValid) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Invalid responses\",\n                data: {\n                    errors: validationResult.errors\n                },\n                timestamp: new Date().toISOString()\n            }, {\n                status: 400\n            });\n        }\n        // Calculate MBTI\n        const calculatorService = _lib_services_MBTICalculatorService__WEBPACK_IMPORTED_MODULE_1__.MBTICalculatorService.getInstance();\n        const scoringInput = {\n            sessionId,\n            responses: sanitizedResponses,\n            methodology: methodology,\n            isInterim: isInterim || false\n        };\n        const scoringResult = calculatorService.calculateMBTI(scoringInput);\n        // Create MBTIResults\n        const result = {\n            ...scoringResult,\n            calculatedAt: new Date(),\n            cacheHit: false\n        };\n        // Store in cache\n        responseCache.set(cacheKey, {\n            result,\n            timestamp: Date.now()\n        });\n        // Clean up old cache entries\n        const entriesToDelete = [];\n        responseCache.forEach((entry, key)=>{\n            if (Date.now() - entry.timestamp > CACHE_TTL) {\n                entriesToDelete.push(key);\n            }\n        });\n        for (const key of entriesToDelete){\n            responseCache.delete(key);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: result,\n            timestamp: new Date().toISOString()\n        });\n    } catch (error) {\n        console.error(\"MBTI calculation error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error during MBTI calculation\",\n            timestamp: new Date().toISOString()\n        }, {\n            status: 500\n        });\n    }\n}\nasync function OPTIONS(request) {\n    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(null, {\n        status: 200,\n        headers: {\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Access-Control-Allow-Methods\": \"POST, OPTIONS\",\n            \"Access-Control-Allow-Headers\": \"Content-Type\"\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUF1RDtBQUNxQjtBQUNSO0FBU3BFLDJDQUEyQztBQUMzQyxNQUFNRyxnQkFBZ0IsSUFBSUM7QUFDMUIsTUFBTUMsWUFBWSxPQUFPLEtBQUssRUFBRSxZQUFZOztBQU9yQyxlQUFlQyxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0YsTUFBTUMsT0FBTyxNQUFNRCxRQUFRRSxJQUFJO1FBQy9CLE1BQU0sRUFBRUMsU0FBUyxFQUFFQyxTQUFTLEVBQUVDLFdBQVcsRUFBRUMsU0FBUyxFQUFFLEdBQUdMO1FBRXpELHdCQUF3QjtRQUN4QixJQUFJLENBQUNFLFdBQVc7WUFDZCxPQUFPVixxREFBWUEsQ0FBQ1MsSUFBSSxDQUFjO2dCQUNwQ0ssU0FBUztnQkFDVEMsT0FBTztnQkFDUEMsV0FBVyxJQUFJQyxPQUFPQyxXQUFXO1lBQ25DLEdBQUc7Z0JBQUVDLFFBQVE7WUFBSTtRQUNuQjtRQUVBLElBQUksQ0FBQ1IsYUFBYSxDQUFDUyxNQUFNQyxPQUFPLENBQUNWLFlBQVk7WUFDM0MsT0FBT1gscURBQVlBLENBQUNTLElBQUksQ0FBYztnQkFDcENLLFNBQVM7Z0JBQ1RDLE9BQU87Z0JBQ1BDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztZQUNuQyxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDbkI7UUFFQSxJQUFJLENBQUNQLGFBQWE7WUFDaEIsT0FBT1oscURBQVlBLENBQUNTLElBQUksQ0FBYztnQkFDcENLLFNBQVM7Z0JBQ1RDLE9BQU87Z0JBQ1BDLFdBQVcsSUFBSUMsT0FBT0MsV0FBVztZQUNuQyxHQUFHO2dCQUFFQyxRQUFRO1lBQUk7UUFDbkI7UUFFQSx1QkFBdUI7UUFDdkIsTUFBTUcsb0JBQW9CcEIsOEVBQWlCQSxDQUFDcUIsV0FBVztRQUN2RCxJQUFJLENBQUNELGtCQUFrQkUsbUJBQW1CLENBQUNaLGNBQWM7WUFDdkQsT0FBT1os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dXJjZXMiOlsid2VicGFjazovL21idGktY29hY2hpbmctcGxhdGZvcm0vLi9zcmMvYXBwL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS9yb3V0ZS50cz9iNjQ2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgTUJUSUNhbGN1bGF0b3JTZXJ2aWNlIH0gZnJvbSAnQC9saWIvc2VydmljZXMvTUJUSUNhbGN1bGF0b3JTZXJ2aWNlJ1xyXG5pbXBvcnQgeyBWYWxpZGF0aW9uU2VydmljZSB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL1ZhbGlkYXRpb25TZXJ2aWNlJ1xyXG5pbXBvcnQge1xyXG4gIFNjb3JpbmdJbnB1dCxcclxuICBNQlRJUmVzdWx0cyxcclxuICBBUElSZXNwb25zZSxcclxuICBRdWVzdGlvblJlc3BvbnNlLFxyXG4gIE1ldGhvZG9sb2d5VHlwZSxcclxufSBmcm9tICdAL2xpYi90eXBlcydcclxuXHJcbi8vIFNpbXBsZSBpbi1tZW1vcnkgY2FjaGUgZm9yIGRlbW9uc3RyYXRpb25cclxuY29uc3QgcmVzcG9uc2VDYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBDYWNoZUVudHJ5PigpXHJcbmNvbnN0IENBQ0hFX1RUTCA9IDEwMDAgKiA2MCAqIDUgLy8gNSBtaW51dGVzXHJcblxyXG5pbnRlcmZhY2UgQ2FjaGVFbnRyeSB7XHJcbiAgcmVzdWx0OiBNQlRJUmVzdWx0c1xyXG4gIHRpbWVzdGFtcDogbnVtYmVyXHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgY29uc3QgeyBzZXNzaW9uSWQsIHJlc3BvbnNlcywgbWV0aG9kb2xvZ3ksIGlzSW50ZXJpbSB9ID0gYm9keVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIHJlcXVlc3QgYm9keVxyXG4gICAgaWYgKCFzZXNzaW9uSWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFQSVJlc3BvbnNlPih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdTZXNzaW9uIElEIGlzIHJlcXVpcmVkJyxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghcmVzcG9uc2VzIHx8ICFBcnJheS5pc0FycmF5KHJlc3BvbnNlcykpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFQSVJlc3BvbnNlPih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdSZXNwb25zZXMgYXJyYXkgaXMgcmVxdWlyZWQnLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9LCB7IHN0YXR1czogNDAwIH0pXHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFtZXRob2RvbG9neSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb248QVBJUmVzcG9uc2U+KHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ01ldGhvZG9sb2d5IGlzIHJlcXVpcmVkJyxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcclxuICAgICAgfSwgeyBzdGF0dXM6IDQwMCB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFZhbGlkYXRlIG1ldGhvZG9sb2d5XHJcbiAgICBjb25zdCB2YWxpZGF0aW9uU2VydmljZSA9IFZhbGlkYXRpb25TZXJ2aWNlLmdldEluc3RhbmNlKClcclxuICAgIGlmICghdmFsaWRhdGlvblNlcnZpY2UudmFsaWRhdGVNZXRob2RvbG9neShtZXRob2RvbG9neSkpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFQSVJlc3BvbnNlPih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIG1ldGhvZG9sb2d5LiBNdXN0IGJlIG9uZSBvZjogc2NlbmFyaW9zLCB0cmFpdHMsIHNhaXMnLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9LCB7IHN0YXR1czogNDAwIH0pXHJcbiAgICB9XHJcblxyXG4gICAgLy8gR2VuZXJhdGUgY2FjaGUga2V5XHJcbiAgICBjb25zdCBjYWNoZUtleSA9IGAke3Nlc3Npb25JZH0tJHttZXRob2RvbG9neX0tJHtyZXNwb25zZXMubGVuZ3RofS0ke0pTT04uc3RyaW5naWZ5KHJlc3BvbnNlcyl9YFxyXG4gICAgXHJcbiAgICAvLyBDaGVjayBjYWNoZVxyXG4gICAgY29uc3QgY2FjaGVkID0gcmVzcG9uc2VDYWNoZS5nZXQoY2FjaGVLZXkpXHJcbiAgICBpZiAoY2FjaGVkICYmIERhdGUubm93KCkgLSBjYWNoZWQudGltZXN0YW1wIDwgQ0FDSEVfVFRMKSB7XHJcbiAgICAgIGNvbnN0IGNhY2hlZFJlc3VsdDogTUJUSVJlc3VsdHMgPSB7XHJcbiAgICAgICAgLi4uY2FjaGVkLnJlc3VsdCxcclxuICAgICAgICBjYWNoZUhpdDogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFQSVJlc3BvbnNlPE1CVElSZXN1bHRzPj4oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgZGF0YTogY2FjaGVkUmVzdWx0LFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFNhbml0aXplIGFuZCB2YWxpZGF0ZSByZXNwb25zZXNcclxuICAgIGNvbnN0IHNhbml0aXplZFJlc3BvbnNlcyA9IHZhbGlkYXRpb25TZXJ2aWNlLnNhbml0aXplUmVzcG9uc2VzKHJlc3BvbnNlcyBhcyBRdWVzdGlvblJlc3BvbnNlW10pXHJcbiAgICBjb25zdCB2YWxpZGF0aW9uUmVzdWx0ID0gdmFsaWRhdGlvblNlcnZpY2UudmFsaWRhdGVSZXNwb25zZXMoXHJcbiAgICAgIHNhbml0aXplZFJlc3BvbnNlcyxcclxuICAgICAgbWV0aG9kb2xvZ3kgYXMgTWV0aG9kb2xvZ3lUeXBlXHJcbiAgICApXHJcblxyXG4gICAgaWYgKCF2YWxpZGF0aW9uUmVzdWx0LmlzVmFsaWQpIHtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFQSVJlc3BvbnNlPih7XHJcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgZXJyb3I6ICdJbnZhbGlkIHJlc3BvbnNlcycsXHJcbiAgICAgICAgZGF0YTogeyBlcnJvcnM6IHZhbGlkYXRpb25SZXN1bHQuZXJyb3JzIH0sXHJcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBDYWxjdWxhdGUgTUJUSVxyXG4gICAgY29uc3QgY2FsY3VsYXRvclNlcnZpY2UgPSBNQlRJQ2FsY3VsYXRvclNlcnZpY2UuZ2V0SW5zdGFuY2UoKVxyXG4gICAgY29uc3Qgc2NvcmluZ0lucHV0OiBTY29yaW5nSW5wdXQgPSB7XHJcbiAgICAgIHNlc3Npb25JZCxcclxuICAgICAgcmVzcG9uc2VzOiBzYW5pdGl6ZWRSZXNwb25zZXMsXHJcbiAgICAgIG1ldGhvZG9sb2d5OiBtZXRob2RvbG9neSBhcyBNZXRob2RvbG9neVR5cGUsXHJcbiAgICAgIGlzSW50ZXJpbTogaXNJbnRlcmltIHx8IGZhbHNlLFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNjb3JpbmdSZXN1bHQgPSBjYWxjdWxhdG9yU2VydmljZS5jYWxjdWxhdGVNQlRJKHNjb3JpbmdJbnB1dClcclxuICAgIFxyXG4gICAgLy8gQ3JlYXRlIE1CVElSZXN1bHRzXHJcbiAgICBjb25zdCByZXN1bHQ6IE1CVElSZXN1bHRzID0ge1xyXG4gICAgICAuLi5zY29yaW5nUmVzdWx0LFxyXG4gICAgICBjYWxjdWxhdGVkQXQ6IG5ldyBEYXRlKCksXHJcbiAgICAgIGNhY2hlSGl0OiBmYWxzZSxcclxuICAgIH1cclxuXHJcbiAgICAvLyBTdG9yZSBpbiBjYWNoZVxyXG4gICAgcmVzcG9uc2VDYWNoZS5zZXQoY2FjaGVLZXksIHtcclxuICAgICAgcmVzdWx0LFxyXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXHJcbiAgICB9KVxyXG5cclxuICAgIC8vIENsZWFuIHVwIG9sZCBjYWNoZSBlbnRyaWVzXHJcbiAgICBjb25zdCBlbnRyaWVzVG9EZWxldGU6IHN0cmluZ1tdID0gW11cclxuICAgIHJlc3BvbnNlQ2FjaGUuZm9yRWFjaCgoZW50cnksIGtleSkgPT4ge1xyXG4gICAgICBpZiAoRGF0ZS5ub3coKSAtIGVudHJ5LnRpbWVzdGFtcCA+IENBQ0hFX1RUTCkge1xyXG4gICAgICAgIGVudHJpZXNUb0RlbGV0ZS5wdXNoKGtleSlcclxuICAgICAgfVxyXG4gICAgfSlcclxuICAgIFxyXG4gICAgZm9yIChjb25zdCBrZXkgb2YgZW50cmllc1RvRGVsZXRlKSB7XHJcbiAgICAgIHJlc3BvbnNlQ2FjaGUuZGVsZXRlKGtleSlcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb248QVBJUmVzcG9uc2U8TUJUSVJlc3VsdHM+Pih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGRhdGE6IHJlc3VsdCxcclxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXHJcbiAgICB9KVxyXG5cclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignTUJUSSBjYWxjdWxhdGlvbiBlcnJvcjonLCBlcnJvcilcclxuICAgIFxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uPEFQSVJlc3BvbnNlPih7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogJ0ludGVybmFsIHNlcnZlciBlcnJvciBkdXJpbmcgTUJUSSBjYWxjdWxhdGlvbicsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxyXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIE9QVElPTlMocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShudWxsLCB7XHJcbiAgICBzdGF0dXM6IDIwMCxcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbic6ICcqJyxcclxuICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiAnUE9TVCwgT1BUSU9OUycsXHJcbiAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJzogJ0NvbnRlbnQtVHlwZScsXHJcbiAgICB9LFxyXG4gIH0pXHJcbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiTUJUSUNhbGN1bGF0b3JTZXJ2aWNlIiwiVmFsaWRhdGlvblNlcnZpY2UiLCJyZXNwb25zZUNhY2hlIiwiTWFwIiwiQ0FDSEVfVFRMIiwiUE9TVCIsInJlcXVlc3QiLCJib2R5IiwianNvbiIsInNlc3Npb25JZCIsInJlc3BvbnNlcyIsIm1ldGhvZG9sb2d5IiwiaXNJbnRlcmltIiwic3VjY2VzcyIsImVycm9yIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwic3RhdHVzIiwiQXJyYXkiLCJpc0FycmF5IiwidmFsaWRhdGlvblNlcnZpY2UiLCJnZXRJbnN0YW5jZSIsInZhbGlkYXRlTWV0aG9kb2xvZ3kiLCJjYWNoZUtleSIsImxlbmd0aCIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYWNoZWQiLCJnZXQiLCJub3ciLCJjYWNoZWRSZXN1bHQiLCJyZXN1bHQiLCJjYWNoZUhpdCIsImRhdGEiLCJzYW5pdGl6ZWRSZXNwb25zZXMiLCJzYW5pdGl6ZVJlc3BvbnNlcyIsInZhbGlkYXRpb25SZXN1bHQiLCJ2YWxpZGF0ZVJlc3BvbnNlcyIsImlzVmFsaWQiLCJlcnJvcnMiLCJjYWxjdWxhdG9yU2VydmljZSIsInNjb3JpbmdJbnB1dCIsInNjb3JpbmdSZXN1bHQiLCJjYWxjdWxhdGVNQlRJIiwiY2FsY3VsYXRlZEF0Iiwic2V0IiwiZW50cmllc1RvRGVsZXRlIiwiZm9yRWFjaCIsImVudHJ5Iiwia2V5IiwicHVzaCIsImRlbGV0ZSIsImNvbnNvbGUiLCJPUFRJT05TIiwiaGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/assessment/calculate/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/MBTICalculatorService.ts":
/*!***************************************************!*\
  !*** ./src/lib/services/MBTICalculatorService.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MBTICalculatorService: () => (/* binding */ MBTICalculatorService)\n/* harmony export */ });\nclass MBTICalculatorService {\n    constructor(){\n        // SAIS Consciousness Domain Mapping (Arabic)\n        this.consciousnessDomains = {\n            \"E/I\": {\n                name: \"مصدر حيويتك وتفاعلك\",\n                E: {\n                    name: \"التفاعل الخارجي\",\n                    description: \"استمداد الحيوية من التفاعل مع الطيف الواسع من النشاطات والأشخاص\"\n                },\n                I: {\n                    name: \"الانغماس الداخلي\",\n                    description: \"الانغماس في عالمك الداخلي الغني والاتصال بمركز جذري عميق وهادئ\"\n                }\n            },\n            \"S/N\": {\n                name: \"طريقة استقبالك للمعلومات\",\n                S: {\n                    name: \"الواقع المادي\",\n                    description: \"التفاعل مع الواقع المادي الملموس واستخدام الحواس الخمس\"\n                },\n                N: {\n                    name: \"البصيرة الحدسية\",\n                    description: \"الغوص في بحر الاحتمالات والمعاني الخفية باستخدام العين الثالثة\"\n                }\n            },\n            \"T/F\": {\n                name: \"مركز اتخاذ القرار\",\n                T: {\n                    name: \"التحليل المنطقي\",\n                    description: \"تحليل منطقي وموضوعي للحقائق وبناء هيكل عقلي متماسك\"\n                },\n                F: {\n                    name: \"بوصلة القيم الداخلية\",\n                    description: \"الاتصال بمركز القلب والانسجام مع مشاعر الآخرين وقيمك الداخلية\"\n                }\n            },\n            \"J/P\": {\n                name: \"تنظيم عالمك الخارجي\",\n                J: {\n                    name: \"الهيكل المنظم\",\n                    description: \"وضع هيكل زمني ونظام واضح للسيطرة والتنبؤ بالأحداث\"\n                },\n                P: {\n                    name: \"المرونة العفوية\",\n                    description: \"ترك مساحة للمرونة والعفوية وإبقاء الخيارات مفتوحة\"\n                }\n            }\n        };\n    }\n    static getInstance() {\n        if (!MBTICalculatorService.instance) {\n            MBTICalculatorService.instance = new MBTICalculatorService();\n        }\n        return MBTICalculatorService.instance;\n    }\n    calculateMBTI(input) {\n        const { sessionId, responses, methodology, isInterim = false } = input;\n        const dimensionScores = this.calculateDimensionScores(responses, methodology);\n        const mbtiType = this.determineMBTIType(dimensionScores);\n        const overallConfidence = this.calculateOverallConfidence(dimensionScores);\n        // Generate consciousness profile for SAIS methodology\n        let consciousnessProfile = undefined;\n        if (methodology === \"sais\") {\n            consciousnessProfile = this.generateConsciousnessProfile(dimensionScores);\n        }\n        return {\n            sessionId,\n            mbtiType,\n            dimensionScores,\n            overallConfidence,\n            methodology,\n            isInterim,\n            totalResponses: responses.length,\n            consciousnessProfile\n        };\n    }\n    calculateDimensionScores(responses, methodology) {\n        const dimensions = [\n            \"E/I\",\n            \"S/N\",\n            \"T/F\",\n            \"J/P\"\n        ];\n        const scores = [];\n        for (const dimension of dimensions){\n            const dimensionResponses = responses.filter((r)=>r.mbtiDimension === dimension);\n            let rawScoreA = 0;\n            let rawScoreB = 0;\n            for (const response of dimensionResponses){\n                if (methodology === \"sais\" && response.responseType === \"distribution\") {\n                    // For SAIS, we need to consider the tendency mapping\n                    // The distribution points represent strength of preference\n                    const pointsA = response.distributionA || 0;\n                    const pointsB = response.distributionB || 0;\n                    rawScoreA += pointsA;\n                    rawScoreB += pointsB;\n                } else if (response.responseType === \"binary\") {\n                    if (response.selectedOption === \"A\") {\n                        rawScoreA += 1;\n                    } else if (response.selectedOption === \"B\") {\n                        rawScoreB += 1;\n                    }\n                }\n            }\n            const preference = this.determinePreference(dimension, rawScoreA, rawScoreB, dimensionResponses);\n            const confidence = this.calculateConfidence(rawScoreA, rawScoreB, methodology);\n            // SAIS consciousness enhancements\n            let consciousnessPercentage = undefined;\n            let consciousnessDomain = undefined;\n            let totalPossiblePoints = undefined;\n            if (methodology === \"sais\") {\n                totalPossiblePoints = 15 // 3 questions × 5 points per question\n                ;\n                // Calculate consciousness percentage based on tendency tracking for SAIS\n                let winningScore = 0;\n                for (const response of dimensionResponses){\n                    if (response.tendency === preference) {\n                        // Add the distribution points for this tendency\n                        if (response.responseType === \"distribution\") {\n                            const points = response.selectedOption === \"A\" ? response.distributionA : response.distributionB;\n                            winningScore += points;\n                        }\n                    }\n                }\n                consciousnessPercentage = Math.round(winningScore / totalPossiblePoints * 100);\n                consciousnessDomain = this.consciousnessDomains[dimension].name;\n            }\n            scores.push({\n                dimension,\n                rawScoreA,\n                rawScoreB,\n                preference,\n                confidence,\n                consciousnessPercentage,\n                consciousnessDomain,\n                totalPossiblePoints\n            });\n        }\n        return scores;\n    }\n    determinePreference(dimension, scoreA, scoreB, dimensionResponses) {\n        // For SAIS, we need to check the tendency mapping from the responses\n        if (dimensionResponses && dimensionResponses.length > 0) {\n            const saisResponse = dimensionResponses.find((r)=>r.responseType === \"distribution\");\n            if (saisResponse && saisResponse.tendency) {\n                // If we have SAIS responses, use the tendency directly from the response\n                // which was determined based on the question's optionATendency/optionBTendency\n                const tendencyCounts = {};\n                for (const response of dimensionResponses){\n                    if (response.tendency) {\n                        if (!tendencyCounts[response.tendency]) {\n                            tendencyCounts[response.tendency] = 0;\n                        }\n                        // Weight by distribution points for SAIS\n                        if (response.responseType === \"distribution\") {\n                            const weight = response.selectedOption === \"A\" ? response.distributionA || 0 : response.distributionB || 0;\n                            tendencyCounts[response.tendency] += weight;\n                        } else {\n                            tendencyCounts[response.tendency] += 1;\n                        }\n                    }\n                }\n                // Return the tendency with the highest count\n                const preferences = Object.entries(tendencyCounts);\n                if (preferences.length > 0) {\n                    preferences.sort((a, b)=>b[1] - a[1]);\n                    return preferences[0][0];\n                }\n            }\n        }\n        // Fallback to standard mapping for non-SAIS or if tendencies not found\n        const dimensionMap = {\n            \"E/I\": {\n                A: \"E\",\n                B: \"I\"\n            },\n            \"S/N\": {\n                A: \"S\",\n                B: \"N\"\n            },\n            \"T/F\": {\n                A: \"T\",\n                B: \"F\"\n            },\n            \"J/P\": {\n                A: \"J\",\n                B: \"P\"\n            }\n        };\n        return scoreA > scoreB ? dimensionMap[dimension].A : dimensionMap[dimension].B;\n    }\n    calculateConfidence(scoreA, scoreB, methodology) {\n        const total = scoreA + scoreB;\n        if (total === 0) return 50;\n        const higher = Math.max(scoreA, scoreB);\n        let confidence = higher / total * 100;\n        // For SAIS methodology, apply a different confidence scale\n        // since the 5-point distribution allows for more nuanced responses\n        if (methodology === \"sais\") {\n            // SAIS confidence scale:\n            // 5-0 distribution = 100% confidence\n            // 4-1 distribution = 80% confidence  \n            // 3-2 distribution = 60% confidence\n            const difference = Math.abs(scoreA - scoreB);\n            const maxPossibleDifference = total;\n            if (maxPossibleDifference > 0) {\n                // Scale confidence based on the strength of the preference\n                confidence = 50 + difference / maxPossibleDifference * 50;\n            }\n        }\n        return Math.round(confidence);\n    }\n    determineMBTIType(dimensionScores) {\n        const typeString = dimensionScores.map((score)=>score.preference).join(\"\");\n        return typeString;\n    }\n    calculateOverallConfidence(dimensionScores) {\n        const totalConfidence = dimensionScores.reduce((sum, score)=>sum + score.confidence, 0);\n        return Math.round(totalConfidence / dimensionScores.length);\n    }\n    calculateInterimResults(responses) {\n        const dimensionOrder = [\n            \"E/I\",\n            \"S/N\",\n            \"T/F\",\n            \"J/P\"\n        ];\n        const interimResponses = [];\n        for(let i = 0; i < Math.min(4, responses.length); i++){\n            const response = responses[i];\n            if (!response.mbtiDimension && i < dimensionOrder.length) {\n                response.mbtiDimension = dimensionOrder[i];\n            }\n            interimResponses.push(response);\n        }\n        return this.calculateMBTI({\n            sessionId: responses[0]?.sessionId || \"\",\n            responses: interimResponses,\n            methodology: \"scenarios\",\n            isInterim: true\n        });\n    }\n    isSAISScoreValid(distributionA, distributionB) {\n        const validCombinations = [\n            [\n                5,\n                0\n            ],\n            [\n                4,\n                1\n            ],\n            [\n                3,\n                2\n            ],\n            [\n                2,\n                3\n            ],\n            [\n                1,\n                4\n            ],\n            [\n                0,\n                5\n            ]\n        ];\n        return validCombinations.some(([a, b])=>distributionA === a && distributionB === b);\n    }\n    validateSAISDistribution(pointA, pointB) {\n        return pointA >= 0 && pointA <= 5 && pointB >= 0 && pointB <= 5 && pointA + pointB === 5 && Number.isInteger(pointA) && Number.isInteger(pointB);\n    }\n    // SAIS Consciousness Profile Generation\n    generateConsciousnessProfile(dimensionScores) {\n        const getConsciousnessDimension = (dimension)=>{\n            const score = dimensionScores.find((s)=>s.dimension === dimension);\n            const domainData = this.consciousnessDomains[dimension];\n            // Safely access preference data with type checking\n            const preferenceKey = score.preference;\n            const preferenceData = domainData[preferenceKey];\n            if (!preferenceData) {\n                console.warn(`No preference data found for ${dimension}:${score.preference}`);\n                return {\n                    dimension,\n                    preference: score.preference,\n                    percentage: score.consciousnessPercentage || 0,\n                    arabicDomainName: score.preference,\n                    consciousnessDescription: \"وصف غير متاح\"\n                };\n            }\n            return {\n                dimension,\n                preference: score.preference,\n                percentage: score.consciousnessPercentage || 0,\n                arabicDomainName: preferenceData.name,\n                consciousnessDescription: preferenceData.description\n            };\n        };\n        return {\n            energySourcePattern: getConsciousnessDimension(\"E/I\"),\n            awarenessStyle: getConsciousnessDimension(\"S/N\"),\n            decisionMakingCenter: getConsciousnessDimension(\"T/F\"),\n            lifeStructurePreference: getConsciousnessDimension(\"J/P\")\n        };\n    }\n    // Test method for SAIS scoring verification\n    testSAISScoring(responses) {\n        console.log(\"SAIS Scoring Test:\");\n        console.log(\"==================\");\n        const result = this.calculateMBTI({\n            sessionId: \"test-session\",\n            responses,\n            methodology: \"sais\",\n            isInterim: false\n        });\n        console.log(\"MBTI Type:\", result.mbtiType);\n        console.log(\"Overall Confidence:\", result.overallConfidence + \"%\");\n        console.log(\"\\nDimension Breakdown:\");\n        result.dimensionScores.forEach((score)=>{\n            console.log(`${score.dimension}: ${score.preference} (${score.confidence}% confidence)`);\n            console.log(`  Raw scores: A=${score.rawScoreA}, B=${score.rawScoreB}`);\n            if (score.consciousnessPercentage) {\n                console.log(`  Consciousness: ${score.consciousnessPercentage}% - ${score.consciousnessDomain}`);\n            }\n        });\n        // Display consciousness profile\n        if (result.consciousnessProfile) {\n            console.log(\"\\nConsciousness Profile:\");\n            console.log(\"Energy Source:\", result.consciousnessProfile.energySourcePattern.arabicDomainName, `(${result.consciousnessProfile.energySourcePattern.percentage}%)`);\n            console.log(\"Awareness Style:\", result.consciousnessProfile.awarenessStyle.arabicDomainName, `(${result.consciousnessProfile.awarenessStyle.percentage}%)`);\n            console.log(\"Decision Center:\", result.consciousnessProfile.decisionMakingCenter.arabicDomainName, `(${result.consciousnessProfile.decisionMakingCenter.percentage}%)`);\n            console.log(\"Life Structure:\", result.consciousnessProfile.lifeStructurePreference.arabicDomainName, `(${result.consciousnessProfile.lifeStructurePreference.percentage}%)`);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL01CVElDYWxjdWxhdG9yU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBWU8sTUFBTUE7SUEyQlgsYUFBc0I7UUF4QnRCLDZDQUE2QzthQUM1QkMsdUJBQXVCO1lBQ3RDLE9BQU87Z0JBQ0xDLE1BQU07Z0JBQ05DLEdBQUc7b0JBQUVELE1BQU07b0JBQW1CRSxhQUFhO2dCQUFrRTtnQkFDN0dDLEdBQUc7b0JBQUVILE1BQU07b0JBQW9CRSxhQUFhO2dCQUFpRTtZQUMvRztZQUNBLE9BQU87Z0JBQ0xGLE1BQU07Z0JBQ05JLEdBQUc7b0JBQUVKLE1BQU07b0JBQWlCRSxhQUFhO2dCQUF5RDtnQkFDbEdHLEdBQUc7b0JBQUVMLE1BQU07b0JBQW1CRSxhQUFhO2dCQUFpRTtZQUM5RztZQUNBLE9BQU87Z0JBQ0xGLE1BQU07Z0JBQ05NLEdBQUc7b0JBQUVOLE1BQU07b0JBQW1CRSxhQUFhO2dCQUFxRDtnQkFDaEdLLEdBQUc7b0JBQUVQLE1BQU07b0JBQXdCRSxhQUFhO2dCQUFnRTtZQUNsSDtZQUNBLE9BQU87Z0JBQ0xGLE1BQU07Z0JBQ05RLEdBQUc7b0JBQUVSLE1BQU07b0JBQWlCRSxhQUFhO2dCQUFvRDtnQkFDN0ZPLEdBQUc7b0JBQUVULE1BQU07b0JBQW1CRSxhQUFhO2dCQUFvRDtZQUNqRztRQUNGO0lBRXVCO0lBRXZCLE9BQWNRLGNBQXFDO1FBQ2pELElBQUksQ0FBQ1osc0JBQXNCYSxRQUFRLEVBQUU7WUFDbkNiLHNCQUFzQmEsUUFBUSxHQUFHLElBQUliO1FBQ3ZDO1FBQ0EsT0FBT0Esc0JBQXNCYSxRQUFRO0lBQ3ZDO0lBRU9DLGNBQWNDLEtBQW1CLEVBQWlCO1FBQ3ZELE1BQU0sRUFBRUMsU0FBUyxFQUFFQyxTQUFTLEVBQUVDLFdBQVcsRUFBRUMsWUFBWSxLQUFLLEVBQUUsR0FBR0o7UUFFakUsTUFBTUssa0JBQWtCLElBQUksQ0FBQ0Msd0JBQXdCLENBQUNKLFdBQVdDO1FBQ2pFLE1BQU1JLFdBQVcs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Q0FBQ0osZ0JBQWdCLEVBQ3JGLENBQUMsQ0FBQyxFQUFFUSxPQUFPM0Ysb0JBQW9CLENBQUN1RixvQkFBb0IsQ0FBQ0wsVUFBVSxDQUFDLEVBQUUsQ0FBQztZQUMvRUYsUUFBUVUsR0FBRyxDQUFDLG1CQUFtQkMsT0FBTzNGLG9CQUFvQixDQUFDd0YsdUJBQXVCLENBQUNMLGdCQUFnQixFQUN2RixDQUFDLENBQUMsRUFBRVEsT0FBTzNGLG9CQUFvQixDQUFDd0YsdUJBQXVCLENBQUNOLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDcEY7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWJ0aS1jb2FjaGluZy1wbGF0Zm9ybS8uL3NyYy9saWIvc2VydmljZXMvTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLnRzPzIyYjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBRdWVzdGlvblJlc3BvbnNlLFxyXG4gIE1CVElUeXBlLFxyXG4gIE1CVElEaW1lbnNpb24sXHJcbiAgU2NvcmluZ0lucHV0LFxyXG4gIFNjb3JpbmdSZXN1bHQsXHJcbiAgRGltZW5zaW9uU2NvcmUsXHJcbiAgTWV0aG9kb2xvZ3lUeXBlLFxyXG4gIENvbnNjaW91c25lc3NQcm9maWxlLFxyXG4gIENvbnNjaW91c25lc3NEaW1lbnNpb24sXHJcbn0gZnJvbSAnQC9saWIvdHlwZXMnXHJcblxyXG5leHBvcnQgY2xhc3MgTUJUSUNhbGN1bGF0b3JTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogTUJUSUNhbGN1bGF0b3JTZXJ2aWNlXHJcblxyXG4gIC8vIFNBSVMgQ29uc2Npb3VzbmVzcyBEb21haW4gTWFwcGluZyAoQXJhYmljKVxyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29uc2Npb3VzbmVzc0RvbWFpbnMgPSB7XHJcbiAgICAnRS9JJzoge1xyXG4gICAgICBuYW1lOiAn2YXYtdiv2LEg2K3ZitmI2YrYqtmDINmI2KrZgdin2LnZhNmDJyxcclxuICAgICAgRTogeyBuYW1lOiAn2KfZhNiq2YHYp9i52YQg2KfZhNiu2KfYsdis2YonLCBkZXNjcmlwdGlvbjogJ9in2LPYqtmF2K/Yp9ivINin2YTYrdmK2YjZitipINmF2YYg2KfZhNiq2YHYp9i52YQg2YXYuSDYp9mE2LfZitmBINin2YTZiNin2LPYuSDZhdmGINin2YTZhti02KfYt9in2Kog2YjYp9mE2KPYtNiu2KfYtScgfSxcclxuICAgICAgSTogeyBuYW1lOiAn2KfZhNin2YbYutmF2KfYsyDYp9mE2K/Yp9iu2YTZiicsIGRlc2NyaXB0aW9uOiAn2KfZhNin2YbYutmF2KfYsyDZgdmKINi52KfZhNmF2YMg2KfZhNiv2KfYrtmE2Yog2KfZhNi62YbZiiDZiNin2YTYp9iq2LXYp9mEINio2YXYsdmD2LIg2KzYsNix2Yog2LnZhdmK2YIg2YjZh9in2K/YpicgfVxyXG4gICAgfSxcclxuICAgICdTL04nOiB7XHJcbiAgICAgIG5hbWU6ICfYt9ix2YrZgtipINin2LPYqtmC2KjYp9mE2YMg2YTZhNmF2LnZhNmI2YXYp9iqJyxcclxuICAgICAgUzogeyBuYW1lOiAn2KfZhNmI2KfZgti5INin2YTZhdin2K/ZiicsIGRlc2NyaXB0aW9uOiAn2KfZhNiq2YHYp9i52YQg2YXYuSDYp9mE2YjYp9mC2Lkg2KfZhNmF2KfYr9mKINin2YTZhdmE2YXZiNizINmI2KfYs9iq2K7Yr9in2YUg2KfZhNit2YjYp9izINin2YTYrtmF2LMnIH0sXHJcbiAgICAgIE46IHsgbmFtZTogJ9in2YTYqNi12YrYsdipINin2YTYrdiv2LPZitipJywgZGVzY3JpcHRpb246ICfYp9mE2LrZiNi1INmB2Yog2KjYrdixINin2YTYp9it2KrZhdin2YTYp9iqINmI2KfZhNmF2LnYp9mG2Yog2KfZhNiu2YHZitipINio2KfYs9iq2K7Yr9in2YUg2KfZhNi52YrZhiDYp9mE2KvYp9mE2KvYqScgfVxyXG4gICAgfSxcclxuICAgICdUL0YnOiB7XHJcbiAgICAgIG5hbWU6ICfZhdix2YPYsiDYp9iq2K7Yp9iwINin2YTZgtix2KfYsScsXHJcbiAgICAgIFQ6IHsgbmFtZTogJ9in2YTYqtit2YTZitmEINin2YTZhdmG2LfZgtmKJywgZGVzY3JpcHRpb246ICfYqtit2YTZitmEINmF2YbYt9mC2Yog2YjZhdmI2LbZiNi52Yog2YTZhNit2YLYp9im2YIg2YjYqNmG2KfYoSDZh9mK2YPZhCDYudmC2YTZiiDZhdiq2YXYp9iz2YMnIH0sXHJcbiAgICAgIEY6IHsgbmFtZTogJ9io2YjYtdmE2Kkg2KfZhNmC2YrZhSDYp9mE2K/Yp9iu2YTZitipJywgZGVzY3JpcHRpb246ICfYp9mE2KfYqti12KfZhCDYqNmF2LHZg9iyINin2YTZgtmE2Kgg2YjYp9mE2KfZhtiz2KzYp9mFINmF2Lkg2YXYtNin2LnYsSDYp9mE2KLYrtix2YrZhiDZiNmC2YrZhdmDINin2YTYr9in2K7ZhNmK2KknIH1cclxuICAgIH0sXHJcbiAgICAnSi9QJzoge1xyXG4gICAgICBuYW1lOiAn2KrZhti42YrZhSDYudin2YTZhdmDINin2YTYrtin2LHYrNmKJyxcclxuICAgICAgSjogeyBuYW1lOiAn2KfZhNmH2YrZg9mEINin2YTZhdmG2LjZhScsIGRlc2NyaXB0aW9uOiAn2YjYtti5INmH2YrZg9mEINiy2YXZhtmKINmI2YbYuNin2YUg2YjYp9i22K0g2YTZhNiz2YrYt9ix2Kkg2YjYp9mE2KrZhtio2KQg2KjYp9mE2KPYrdiv2KfYqycgfSxcclxuICAgICAgUDogeyBuYW1lOiAn2KfZhNmF2LHZiNmG2Kkg2KfZhNi52YHZiNmK2KknLCBkZXNjcmlwdGlvbjogJ9iq2LHZgyDZhdiz2KfYrdipINmE2YTZhdix2YjZhtipINmI2KfZhNi52YHZiNmK2Kkg2YjYpdio2YLYp9ihINin2YTYrtmK2KfYsdin2Kog2YXZgdiq2YjYrdipJyB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cclxuXHJcbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBNQlRJQ2FsY3VsYXRvclNlcnZpY2Uge1xyXG4gICAgaWYgKCFNQlRJQ2FsY3VsYXRvclNlcnZpY2UuaW5zdGFuY2UpIHtcclxuICAgICAgTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLmluc3RhbmNlID0gbmV3IE1CVElDYWxjdWxhdG9yU2VydmljZSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLmluc3RhbmNlXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY2FsY3VsYXRlTUJUSShpbnB1dDogU2NvcmluZ0lucHV0KTogU2NvcmluZ1Jlc3VsdCB7XHJcbiAgICBjb25zdCB7IHNlc3Npb25JZCwgcmVzcG9uc2VzLCBtZXRob2RvbG9neSwgaXNJbnRlcmltID0gZmFsc2UgfSA9IGlucHV0XHJcblxyXG4gICAgY29uc3QgZGltZW5zaW9uU2NvcmVzID0gdGhpcy5jYWxjdWxhdGVEaW1lbnNpb25TY29yZXMocmVzcG9uc2VzLCBtZXRob2RvbG9neSlcclxuICAgIGNvbnN0IG1idGlUeXBlID0gdGhpcy5kZXRlcm1pbmVNQlRJVHlwZShkaW1lbnNpb25TY29yZXMpXHJcbiAgICBjb25zdCBvdmVyYWxsQ29uZmlkZW5jZSA9IHRoaXMuY2FsY3VsYXRlT3ZlcmFsbENvbmZpZGVuY2UoZGltZW5zaW9uU2NvcmVzKVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGNvbnNjaW91c25lc3MgcHJvZmlsZSBmb3IgU0FJUyBtZXRob2RvbG9neVxyXG4gICAgbGV0IGNvbnNjaW91c25lc3NQcm9maWxlOiBDb25zY2lvdXNuZXNzUHJvZmlsZSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxyXG4gICAgaWYgKG1ldGhvZG9sb2d5ID09PSAnc2FpcycpIHtcclxuICAgICAgY29uc2Npb3VzbmVzc1Byb2ZpbGUgPSB0aGlzLmdlbmVyYXRlQ29uc2Npb3VzbmVzc1Byb2ZpbGUoZGltZW5zaW9uU2NvcmVzKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNlc3Npb25JZCxcclxuICAgICAgbWJ0aVR5cGUsXHJcbiAgICAgIGRpbWVuc2lvblNjb3JlcyxcclxuICAgICAgb3ZlcmFsbENvbmZpZGVuY2UsXHJcbiAgICAgIG1ldGhvZG9sb2d5LFxyXG4gICAgICBpc0ludGVyaW0sXHJcbiAgICAgIHRvdGFsUmVzcG9uc2VzOiByZXNwb25zZXMubGVuZ3RoLFxyXG4gICAgICBjb25zY2lvdXNuZXNzUHJvZmlsZSxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlRGltZW5zaW9uU2NvcmVzKFxyXG4gICAgcmVzcG9uc2VzOiBRdWVzdGlvblJlc3BvbnNlW10sXHJcbiAgICBtZXRob2RvbG9neTogTWV0aG9kb2xvZ3lUeXBlXHJcbiAgKTogRGltZW5zaW9uU2NvcmVbXSB7XHJcbiAgICBjb25zdCBkaW1lbnNpb25zOiBNQlRJRGltZW5zaW9uW10gPSBbJ0UvSScsICdTL04nLCAnVC9GJywgJ0ovUCddXHJcbiAgICBjb25zdCBzY29yZXM6IERpbWVuc2lvblNjb3JlW10gPSBbXVxyXG5cclxuICAgIGZvciAoY29uc3QgZGltZW5zaW9uIG9mIGRpbWVuc2lvbnMpIHtcclxuICAgICAgY29uc3QgZGltZW5zaW9uUmVzcG9uc2VzID0gcmVzcG9uc2VzLmZpbHRlcihyID0+IHIubWJ0aURpbWVuc2lvbiA9PT0gZGltZW5zaW9uKVxyXG4gICAgICBcclxuICAgICAgbGV0IHJhd1Njb3JlQSA9IDBcclxuICAgICAgbGV0IHJhd1Njb3JlQiA9IDBcclxuXHJcbiAgICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgZGltZW5zaW9uUmVzcG9uc2VzKSB7XHJcbiAgICAgICAgaWYgKG1ldGhvZG9sb2d5ID09PSAnc2FpcycgJiYgcmVzcG9uc2UucmVzcG9uc2VUeXBlID09PSAnZGlzdHJpYnV0aW9uJykge1xyXG4gICAgICAgICAgLy8gRm9yIFNBSVMsIHdlIG5lZWQgdG8gY29uc2lkZXIgdGhlIHRlbmRlbmN5IG1hcHBpbmdcclxuICAgICAgICAgIC8vIFRoZSBkaXN0cmlidXRpb24gcG9pbnRzIHJlcHJlc2VudCBzdHJlbmd0aCBvZiBwcmVmZXJlbmNlXHJcbiAgICAgICAgICBjb25zdCBwb2ludHNBID0gcmVzcG9uc2UuZGlzdHJpYnV0aW9uQSB8fCAwXHJcbiAgICAgICAgICBjb25zdCBwb2ludHNCID0gcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiB8fCAwXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHJhd1Njb3JlQSArPSBwb2ludHNBXHJcbiAgICAgICAgICByYXdTY29yZUIgKz0gcG9pbnRzQlxyXG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UucmVzcG9uc2VUeXBlID09PSAnYmluYXJ5Jykge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnNlbGVjdGVkT3B0aW9uID09PSAnQScpIHtcclxuICAgICAgICAgICAgcmF3U2NvcmVBICs9IDFcclxuICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc2VsZWN0ZWRPcHRpb24gPT09ICdCJykge1xyXG4gICAgICAgICAgICByYXdTY29yZUIgKz0gMVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcHJlZmVyZW5jZSA9IHRoaXMuZGV0ZXJtaW5lUHJlZmVyZW5jZShkaW1lbnNpb24sIHJhd1Njb3JlQSwgcmF3U2NvcmVCLCBkaW1lbnNpb25SZXNwb25zZXMpXHJcbiAgICAgIGNvbnN0IGNvbmZpZGVuY2UgPSB0aGlzLmNhbGN1bGF0ZUNvbmZpZGVuY2UocmF3U2NvcmVBLCByYXdTY29yZUIsIG1ldGhvZG9sb2d5KVxyXG5cclxuICAgICAgLy8gU0FJUyBjb25zY2lvdXNuZXNzIGVuaGFuY2VtZW50c1xyXG4gICAgICBsZXQgY29uc2Npb3VzbmVzc1BlcmNlbnRhZ2U6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxyXG4gICAgICBsZXQgY29uc2Npb3VzbmVzc0RvbWFpbjogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkXHJcbiAgICAgIGxldCB0b3RhbFBvc3NpYmxlUG9pbnRzOiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWRcclxuXHJcbiAgICAgIGlmIChtZXRob2RvbG9neSA9PT0gJ3NhaXMnKSB7XHJcbiAgICAgICAgdG90YWxQb3NzaWJsZVBvaW50cyA9IDE1IC8vIDMgcXVlc3Rpb25zIMOXIDUgcG9pbnRzIHBlciBxdWVzdGlvblxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENhbGN1bGF0ZSBjb25zY2lvdXNuZXNzIHBlcmNlbnRhZ2UgYmFzZWQgb24gdGVuZGVuY3kgdHJhY2tpbmcgZm9yIFNBSVNcclxuICAgICAgICBsZXQgd2lubmluZ1Njb3JlID0gMFxyXG4gICAgICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgZGltZW5zaW9uUmVzcG9uc2VzKSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2UudGVuZGVuY3kgPT09IHByZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgLy8gQWRkIHRoZSBkaXN0cmlidXRpb24gcG9pbnRzIGZvciB0aGlzIHRlbmRlbmN5XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXNwb25zZVR5cGUgPT09ICdkaXN0cmlidXRpb24nKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcG9pbnRzID0gcmVzcG9uc2Uuc2VsZWN0ZWRPcHRpb24gPT09ICdBJyA/IHJlc3BvbnNlLmRpc3RyaWJ1dGlvbkEhIDogcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiFcclxuICAgICAgICAgICAgICB3aW5uaW5nU2NvcmUgKz0gcG9pbnRzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc2Npb3VzbmVzc1BlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh3aW5uaW5nU2NvcmUgLyB0b3RhbFBvc3NpYmxlUG9pbnRzKSAqIDEwMClcclxuICAgICAgICBjb25zY2lvdXNuZXNzRG9tYWluID0gdGhpcy5jb25zY2lvdXNuZXNzRG9tYWluc1tkaW1lbnNpb25dLm5hbWVcclxuICAgICAgfVxyXG5cclxuICAgICAgc2NvcmVzLnB1c2goe1xyXG4gICAgICAgIGRpbWVuc2lvbixcclxuICAgICAgICByYXdTY29yZUEsXHJcbiAgICAgICAgcmF3U2NvcmVCLFxyXG4gICAgICAgIHByZWZlcmVuY2UsXHJcbiAgICAgICAgY29uZmlkZW5jZSxcclxuICAgICAgICBjb25zY2lvdXNuZXNzUGVyY2VudGFnZSxcclxuICAgICAgICBjb25zY2lvdXNuZXNzRG9tYWluLFxyXG4gICAgICAgIHRvdGFsUG9zc2libGVQb2ludHMsXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHNjb3Jlc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBkZXRlcm1pbmVQcmVmZXJlbmNlKFxyXG4gICAgZGltZW5zaW9uOiBNQlRJRGltZW5zaW9uLFxyXG4gICAgc2NvcmVBOiBudW1iZXIsXHJcbiAgICBzY29yZUI6IG51bWJlcixcclxuICAgIGRpbWVuc2lvblJlc3BvbnNlcz86IFF1ZXN0aW9uUmVzcG9uc2VbXVxyXG4gICk6IHN0cmluZyB7XHJcbiAgICAvLyBGb3IgU0FJUywgd2UgbmVlZCB0byBjaGVjayB0aGUgdGVuZGVuY3kgbWFwcGluZyBmcm9tIHRoZSByZXNwb25zZXNcclxuICAgIGlmIChkaW1lbnNpb25SZXNwb25zZXMgJiYgZGltZW5zaW9uUmVzcG9uc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3Qgc2Fpc1Jlc3BvbnNlID0gZGltZW5zaW9uUmVzcG9uc2VzLmZpbmQociA9PiByLnJlc3BvbnNlVHlwZSA9PT0gJ2Rpc3RyaWJ1dGlvbicpXHJcbiAgICAgIGlmIChzYWlzUmVzcG9uc2UgJiYgc2Fpc1Jlc3BvbnNlLnRlbmRlbmN5KSB7XHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBTQUlTIHJlc3BvbnNlcywgdXNlIHRoZSB0ZW5kZW5jeSBkaXJlY3RseSBmcm9tIHRoZSByZXNwb25zZVxyXG4gICAgICAgIC8vIHdoaWNoIHdhcyBkZXRlcm1pbmVkIGJhc2VkIG9uIHRoZSBxdWVzdGlvbidzIG9wdGlvbkFUZW5kZW5jeS9vcHRpb25CVGVuZGVuY3lcclxuICAgICAgICBjb25zdCB0ZW5kZW5jeUNvdW50czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCByZXNwb25zZSBvZiBkaW1lbnNpb25SZXNwb25zZXMpIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS50ZW5kZW5jeSkge1xyXG4gICAgICAgICAgICBpZiAoIXRlbmRlbmN5Q291bnRzW3Jlc3BvbnNlLnRlbmRlbmN5XSkge1xyXG4gICAgICAgICAgICAgIHRlbmRlbmN5Q291bnRzW3Jlc3BvbnNlLnRlbmRlbmN5XSA9IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBXZWlnaHQgYnkgZGlzdHJpYnV0aW9uIHBvaW50cyBmb3IgU0FJU1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2UucmVzcG9uc2VUeXBlID09PSAnZGlzdHJpYnV0aW9uJykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHdlaWdodCA9IHJlc3BvbnNlLnNlbGVjdGVkT3B0aW9uID09PSAnQScgXHJcbiAgICAgICAgICAgICAgICA/IHJlc3BvbnNlLmRpc3RyaWJ1dGlvbkEgfHwgMCBcclxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiB8fCAwXHJcbiAgICAgICAgICAgICAgdGVuZGVuY3lDb3VudHNbcmVzcG9uc2UudGVuZGVuY3ldICs9IHdlaWdodFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHRlbmRlbmN5Q291bnRzW3Jlc3BvbnNlLnRlbmRlbmN5XSArPSAxXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmV0dXJuIHRoZSB0ZW5kZW5jeSB3aXRoIHRoZSBoaWdoZXN0IGNvdW50XHJcbiAgICAgICAgY29uc3QgcHJlZmVyZW5jZXMgPSBPYmplY3QuZW50cmllcyh0ZW5kZW5jeUNvdW50cylcclxuICAgICAgICBpZiAocHJlZmVyZW5jZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgcHJlZmVyZW5jZXMuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXHJcbiAgICAgICAgICByZXR1cm4gcHJlZmVyZW5jZXNbMF1bMF1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRmFsbGJhY2sgdG8gc3RhbmRhcmQgbWFwcGluZyBmb3Igbm9uLVNBSVMgb3IgaWYgdGVuZGVuY2llcyBub3QgZm91bmRcclxuICAgIGNvbnN0IGRpbWVuc2lvbk1hcDogUmVjb3JkPE1CVElEaW1lbnNpb24sIHsgQTogc3RyaW5nOyBCOiBzdHJpbmcgfT4gPSB7XHJcbiAgICAgICdFL0knOiB7IEE6ICdFJywgQjogJ0knIH0sXHJcbiAgICAgICdTL04nOiB7IEE6ICdTJywgQjogJ04nIH0sXHJcbiAgICAgICdUL0YnOiB7IEE6ICdUJywgQjogJ0YnIH0sXHJcbiAgICAgICdKL1AnOiB7IEE6ICdKJywgQjogJ1AnIH0sXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHNjb3JlQSA+IHNjb3JlQiA/IGRpbWVuc2lvbk1hcFtkaW1lbnNpb25dLkEgOiBkaW1lbnNpb25NYXBbZGltZW5zaW9uXS5CXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbmZpZGVuY2Uoc2NvcmVBOiBudW1iZXIsIHNjb3JlQjogbnVtYmVyLCBtZXRob2RvbG9neT86IE1ldGhvZG9sb2d5VHlwZSk6IG51bWJlciB7XHJcbiAgICBjb25zdCB0b3RhbCA9IHNjb3JlQSArIHNjb3JlQlxyXG4gICAgaWYgKHRvdGFsID09PSAwKSByZXR1cm4gNTBcclxuXHJcbiAgICBjb25zdCBoaWdoZXIgPSBNYXRoLm1heChzY29yZUEsIHNjb3JlQilcclxuICAgIGxldCBjb25maWRlbmNlID0gKGhpZ2hlciAvIHRvdGFsKSAqIDEwMFxyXG4gICAgXHJcbiAgICAvLyBGb3IgU0FJUyBtZXRob2RvbG9neSwgYXBwbHkgYSBkaWZmZXJlbnQgY29uZmlkZW5jZSBzY2FsZVxyXG4gICAgLy8gc2luY2UgdGhlIDUtcG9pbnQgZGlzdHJpYnV0aW9uIGFsbG93cyBmb3IgbW9yZSBudWFuY2VkIHJlc3BvbnNlc1xyXG4gICAgaWYgKG1ldGhvZG9sb2d5ID09PSAnc2FpcycpIHtcclxuICAgICAgLy8gU0FJUyBjb25maWRlbmNlIHNjYWxlOlxyXG4gICAgICAvLyA1LTAgZGlzdHJpYnV0aW9uID0gMTAwJSBjb25maWRlbmNlXHJcbiAgICAgIC8vIDQtMSBkaXN0cmlidXRpb24gPSA4MCUgY29uZmlkZW5jZSAgXHJcbiAgICAgIC8vIDMtMiBkaXN0cmlidXRpb24gPSA2MCUgY29uZmlkZW5jZVxyXG4gICAgICBjb25zdCBkaWZmZXJlbmNlID0gTWF0aC5hYnMoc2NvcmVBIC0gc2NvcmVCKVxyXG4gICAgICBjb25zdCBtYXhQb3NzaWJsZURpZmZlcmVuY2UgPSB0b3RhbFxyXG4gICAgICBcclxuICAgICAgaWYgKG1heFBvc3NpYmxlRGlmZmVyZW5jZSA+IDApIHtcclxuICAgICAgICAvLyBTY2FsZSBjb25maWRlbmNlIGJhc2VkIG9uIHRoZSBzdHJlbmd0aCBvZiB0aGUgcHJlZmVyZW5jZVxyXG4gICAgICAgIGNvbmZpZGVuY2UgPSA1MCArIChkaWZmZXJlbmNlIC8gbWF4UG9zc2libGVEaWZmZXJlbmNlKSAqIDUwXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQoY29uZmlkZW5jZSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGV0ZXJtaW5lTUJUSVR5cGUoZGltZW5zaW9uU2NvcmVzOiBEaW1lbnNpb25TY29yZVtdKTogTUJUSVR5cGUge1xyXG4gICAgY29uc3QgdHlwZVN0cmluZyA9IGRpbWVuc2lvblNjb3Jlc1xyXG4gICAgICAubWFwKHNjb3JlID0+IHNjb3JlLnByZWZlcmVuY2UpXHJcbiAgICAgIC5qb2luKCcnKVxyXG4gICAgXHJcbiAgICByZXR1cm4gdHlwZVN0cmluZyBhcyBNQlRJVHlwZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVPdmVyYWxsQ29uZmlkZW5jZShkaW1lbnNpb25TY29yZXM6IERpbWVuc2lvblNjb3JlW10pOiBudW1iZXIge1xyXG4gICAgY29uc3QgdG90YWxDb25maWRlbmNlID0gZGltZW5zaW9uU2NvcmVzLnJlZHVjZShcclxuICAgICAgKHN1bSwgc2NvcmUpID0+IHN1bSArIHNjb3JlLmNvbmZpZGVuY2UsXHJcbiAgICAgIDBcclxuICAgIClcclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQodG90YWxDb25maWRlbmNlIC8gZGltZW5zaW9uU2NvcmVzLmxlbmd0aClcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjYWxjdWxhdGVJbnRlcmltUmVzdWx0cyhyZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSk6IFNjb3JpbmdSZXN1bHQge1xyXG4gICAgY29uc3QgZGltZW5zaW9uT3JkZXI6IE1CVElEaW1lbnNpb25bXSA9IFsnRS9JJywgJ1MvTicsICdUL0YnLCAnSi9QJ11cclxuICAgIGNvbnN0IGludGVyaW1SZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSA9IFtdXHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1pbig0LCByZXNwb25zZXMubGVuZ3RoKTsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gcmVzcG9uc2VzW2ldXHJcbiAgICAgIGlmICghcmVzcG9uc2UubWJ0aURpbWVuc2lvbiAmJiBpIDwgZGltZW5zaW9uT3JkZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgcmVzcG9uc2UubWJ0aURpbWVuc2lvbiA9IGRpbWVuc2lvbk9yZGVyW2ldXHJcbiAgICAgIH1cclxuICAgICAgaW50ZXJpbVJlc3BvbnNlcy5wdXNoKHJlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZU1CVEkoe1xyXG4gICAgICBzZXNzaW9uSWQ6IHJlc3BvbnNlc1swXT8uc2Vzc2lvbklkIHx8ICcnLFxyXG4gICAgICByZXNwb25zZXM6IGludGVyaW1SZXNwb25zZXMsXHJcbiAgICAgIG1ldGhvZG9sb2d5OiAnc2NlbmFyaW9zJyxcclxuICAgICAgaXNJbnRlcmltOiB0cnVlLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpc1NBSVNTY29yZVZhbGlkKGRpc3RyaWJ1dGlvbkE6IG51bWJlciwgZGlzdHJpYnV0aW9uQjogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCB2YWxpZENvbWJpbmF0aW9ucyA9IFtcclxuICAgICAgWzUsIDBdLCBbNCwgMV0sIFszLCAyXSwgWzIsIDNdLCBbMSwgNF0sIFswLCA1XVxyXG4gICAgXVxyXG4gICAgXHJcbiAgICByZXR1cm4gdmFsaWRDb21iaW5hdGlvbnMuc29tZShcclxuICAgICAgKFthLCBiXSkgPT4gZGlzdHJpYnV0aW9uQSA9PT0gYSAmJiBkaXN0cmlidXRpb25CID09PSBiXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgdmFsaWRhdGVTQUlTRGlzdHJpYnV0aW9uKHBvaW50QTogbnVtYmVyLCBwb2ludEI6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgcG9pbnRBID49IDAgJiYgcG9pbnRBIDw9IDUgJiZcclxuICAgICAgcG9pbnRCID49IDAgJiYgcG9pbnRCIDw9IDUgJiZcclxuICAgICAgcG9pbnRBICsgcG9pbnRCID09PSA1ICYmXHJcbiAgICAgIE51bWJlci5pc0ludGVnZXIocG9pbnRBKSAmJlxyXG4gICAgICBOdW1iZXIuaXNJbnRlZ2VyKHBvaW50QilcclxuICAgIClcclxuICB9XHJcblxyXG4gIC8vIFNBSVMgQ29uc2Npb3VzbmVzcyBQcm9maWxlIEdlbmVyYXRpb25cclxuICBwcml2YXRlIGdlbmVyYXRlQ29uc2Npb3VzbmVzc1Byb2ZpbGUoZGltZW5zaW9uU2NvcmVzOiBEaW1lbnNpb25TY29yZVtdKTogQ29uc2Npb3VzbmVzc1Byb2ZpbGUge1xyXG4gICAgY29uc3QgZ2V0Q29uc2Npb3VzbmVzc0RpbWVuc2lvbiA9IChkaW1lbnNpb246IE1CVElEaW1lbnNpb24pOiBDb25zY2lvdXNuZXNzRGltZW5zaW9uID0+IHtcclxuICAgICAgY29uc3Qgc2NvcmUgPSBkaW1lbnNpb25TY29yZXMuZmluZChzID0+IHMuZGltZW5zaW9uID09PSBkaW1lbnNpb24pIVxyXG4gICAgICBjb25zdCBkb21haW5EYXRhID0gdGhpcy5jb25zY2lvdXNuZXNzRG9tYWluc1tkaW1lbnNpb25dXHJcbiAgICAgIFxyXG4gICAgICAvLyBTYWZlbHkgYWNjZXNzIHByZWZlcmVuY2UgZGF0YSB3aXRoIHR5cGUgY2hlY2tpbmdcclxuICAgICAgY29uc3QgcHJlZmVyZW5jZUtleSA9IHNjb3JlLnByZWZlcmVuY2UgYXMgJ0UnIHwgJ0knIHwgJ1MnIHwgJ04nIHwgJ1QnIHwgJ0YnIHwgJ0onIHwgJ1AnXHJcbiAgICAgIGNvbnN0IHByZWZlcmVuY2VEYXRhID0gKGRvbWFpbkRhdGEgYXMgYW55KVtwcmVmZXJlbmNlS2V5XSBhcyB7IG5hbWU6IHN0cmluZzsgZGVzY3JpcHRpb246IHN0cmluZyB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXByZWZlcmVuY2VEYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBObyBwcmVmZXJlbmNlIGRhdGEgZm91bmQgZm9yICR7ZGltZW5zaW9ufToke3Njb3JlLnByZWZlcmVuY2V9YClcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgZGltZW5zaW9uLFxyXG4gICAgICAgICAgcHJlZmVyZW5jZTogc2NvcmUucHJlZmVyZW5jZSxcclxuICAgICAgICAgIHBlcmNlbnRhZ2U6IHNjb3JlLmNvbnNjaW91c25lc3NQZXJjZW50YWdlIHx8IDAsXHJcbiAgICAgICAgICBhcmFiaWNEb21haW5OYW1lOiBzY29yZS5wcmVmZXJlbmNlLFxyXG4gICAgICAgICAgY29uc2Npb3VzbmVzc0Rlc2NyaXB0aW9uOiAn2YjYtdmBINi62YrYsSDZhdiq2KfYrScsXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGRpbWVuc2lvbixcclxuICAgICAgICBwcmVmZXJlbmNlOiBzY29yZS5wcmVmZXJlbmNlLFxyXG4gICAgICAgIHBlcmNlbnRhZ2U6IHNjb3JlLmNvbnNjaW91c25lc3NQZXJjZW50YWdlIHx8IDAsXHJcbiAgICAgICAgYXJhYmljRG9tYWluTmFtZTogcHJlZmVyZW5jZURhdGEubmFtZSxcclxuICAgICAgICBjb25zY2lvdXNuZXNzRGVzY3JpcHRpb246IHByZWZlcmVuY2VEYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZW5lcmd5U291cmNlUGF0dGVybjogZ2V0Q29uc2Npb3VzbmVzc0RpbWVuc2lvbignRS9JJyksXHJcbiAgICAgIGF3YXJlbmVzc1N0eWxlOiBnZXRDb25zY2lvdXNuZXNzRGltZW5zaW9uKCdTL04nKSwgXHJcbiAgICAgIGRlY2lzaW9uTWFraW5nQ2VudGVyOiBnZXRDb25zY2lvdXNuZXNzRGltZW5zaW9uKCdUL0YnKSxcclxuICAgICAgbGlmZVN0cnVjdHVyZVByZWZlcmVuY2U6IGdldENvbnNjaW91c25lc3NEaW1lbnNpb24oJ0ovUCcpLFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gVGVzdCBtZXRob2QgZm9yIFNBSVMgc2NvcmluZyB2ZXJpZmljYXRpb25cclxuICBwdWJsaWMgdGVzdFNBSVNTY29yaW5nKHJlc3BvbnNlczogUXVlc3Rpb25SZXNwb25zZVtdKTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnU0FJUyBTY29yaW5nIFRlc3Q6JylcclxuICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT0nKVxyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNhbGN1bGF0ZU1CVEkoe1xyXG4gICAgICBzZXNzaW9uSWQ6ICd0ZXN0LXNlc3Npb24nLFxyXG4gICAgICByZXNwb25zZXMsXHJcbiAgICAgIG1ldGhvZG9sb2d5OiAnc2FpcycsXHJcbiAgICAgIGlzSW50ZXJpbTogZmFsc2UsXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnTUJUSSBUeXBlOicsIHJlc3VsdC5tYnRpVHlwZSlcclxuICAgIGNvbnNvbGUubG9nKCdPdmVyYWxsIENvbmZpZGVuY2U6JywgcmVzdWx0Lm92ZXJhbGxDb25maWRlbmNlICsgJyUnKVxyXG4gICAgY29uc29sZS5sb2coJ1xcbkRpbWVuc2lvbiBCcmVha2Rvd246JylcclxuICAgIFxyXG4gICAgcmVzdWx0LmRpbWVuc2lvblNjb3Jlcy5mb3JFYWNoKHNjb3JlID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYCR7c2NvcmUuZGltZW5zaW9ufTogJHtzY29yZS5wcmVmZXJlbmNlfSAoJHtzY29yZS5jb25maWRlbmNlfSUgY29uZmlkZW5jZSlgKVxyXG4gICAgICBjb25zb2xlLmxvZyhgICBSYXcgc2NvcmVzOiBBPSR7c2NvcmUucmF3U2NvcmVBfSwgQj0ke3Njb3JlLnJhd1Njb3JlQn1gKVxyXG4gICAgICBpZiAoc2NvcmUuY29uc2Npb3VzbmVzc1BlcmNlbnRhZ2UpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgICBDb25zY2lvdXNuZXNzOiAke3Njb3JlLmNvbnNjaW91c25lc3NQZXJjZW50YWdlfSUgLSAke3Njb3JlLmNvbnNjaW91c25lc3NEb21haW59YClcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBEaXNwbGF5IGNvbnNjaW91c25lc3MgcHJvZmlsZVxyXG4gICAgaWYgKHJlc3VsdC5jb25zY2lvdXNuZXNzUHJvZmlsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnXFxuQ29uc2Npb3VzbmVzcyBQcm9maWxlOicpXHJcbiAgICAgIGNvbnNvbGUubG9nKCdFbmVyZ3kgU291cmNlOicsIHJlc3VsdC5jb25zY2lvdXNuZXNzUHJvZmlsZS5lbmVyZ3lTb3VyY2VQYXR0ZXJuLmFyYWJpY0RvbWFpbk5hbWUsIFxyXG4gICAgICAgICAgICAgICAgICBgKCR7cmVzdWx0LmNvbnNjaW91c25lc3NQcm9maWxlLmVuZXJneVNvdXJjZVBhdHRlcm4ucGVyY2VudGFnZX0lKWApXHJcbiAgICAgIGNvbnNvbGUubG9nKCdBd2FyZW5lc3MgU3R5bGU6JywgcmVzdWx0LmNvbnNjaW91c25lc3NQcm9maWxlLmF3YXJlbmVzc1N0eWxlLmFyYWJpY0RvbWFpbk5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIGAoJHtyZXN1bHQuY29uc2Npb3VzbmVzc1Byb2ZpbGUuYXdhcmVuZXNzU3R5bGUucGVyY2VudGFnZX0lKWApXHJcbiAgICAgIGNvbnNvbGUubG9nKCdEZWNpc2lvbiBDZW50ZXI6JywgcmVzdWx0LmNvbnNjaW91c25lc3NQcm9maWxlLmRlY2lzaW9uTWFraW5nQ2VudGVyLmFyYWJpY0RvbWFpbk5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIGAoJHtyZXN1bHQuY29uc2Npb3VzbmVzc1Byb2ZpbGUuZGVjaXNpb25NYWtpbmdDZW50ZXIucGVyY2VudGFnZX0lKWApXHJcbiAgICAgIGNvbnNvbGUubG9nKCdMaWZlIFN0cnVjdHVyZTonLCByZXN1bHQuY29uc2Npb3VzbmVzc1Byb2ZpbGUubGlmZVN0cnVjdHVyZVByZWZlcmVuY2UuYXJhYmljRG9tYWluTmFtZSxcclxuICAgICAgICAgICAgICAgICAgYCgke3Jlc3VsdC5jb25zY2lvdXNuZXNzUHJvZmlsZS5saWZlU3RydWN0dXJlUHJlZmVyZW5jZS5wZXJjZW50YWdlfSUpYClcclxuICAgIH1cclxuICB9XHJcbn0iXSwibmFtZXMiOlsiTUJUSUNhbGN1bGF0b3JTZXJ2aWNlIiwiY29uc2Npb3VzbmVzc0RvbWFpbnMiLCJuYW1lIiwiRSIsImRlc2NyaXB0aW9uIiwiSSIsIlMiLCJOIiwiVCIsIkYiLCJKIiwiUCIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJjYWxjdWxhdGVNQlRJIiwiaW5wdXQiLCJzZXNzaW9uSWQiLCJyZXNwb25zZXMiLCJtZXRob2RvbG9neSIsImlzSW50ZXJpbSIsImRpbWVuc2lvblNjb3JlcyIsImNhbGN1bGF0ZURpbWVuc2lvblNjb3JlcyIsIm1idGlUeXBlIiwiZGV0ZXJtaW5lTUJUSVR5cGUiLCJvdmVyYWxsQ29uZmlkZW5jZSIsImNhbGN1bGF0ZU92ZXJhbGxDb25maWRlbmNlIiwiY29uc2Npb3VzbmVzc1Byb2ZpbGUiLCJ1bmRlZmluZWQiLCJnZW5lcmF0ZUNvbnNjaW91c25lc3NQcm9maWxlIiwidG90YWxSZXNwb25zZXMiLCJsZW5ndGgiLCJkaW1lbnNpb25zIiwic2NvcmVzIiwiZGltZW5zaW9uIiwiZGltZW5zaW9uUmVzcG9uc2VzIiwiZmlsdGVyIiwiciIsIm1idGlEaW1lbnNpb24iLCJyYXdTY29yZUEiLCJyYXdTY29yZUIiLCJyZXNwb25zZSIsInJlc3BvbnNlVHlwZSIsInBvaW50c0EiLCJkaXN0cmlidXRpb25BIiwicG9pbnRzQiIsImRpc3RyaWJ1dGlvbkIiLCJzZWxlY3RlZE9wdGlvbiIsInByZWZlcmVuY2UiLCJkZXRlcm1pbmVQcmVmZXJlbmNlIiwiY29uZmlkZW5jZSIsImNhbGN1bGF0ZUNvbmZpZGVuY2UiLCJjb25zY2lvdXNuZXNzUGVyY2VudGFnZSIsImNvbnNjaW91c25lc3NEb21haW4iLCJ0b3RhbFBvc3NpYmxlUG9pbnRzIiwid2lubmluZ1Njb3JlIiwidGVuZGVuY3kiLCJwb2ludHMiLCJNYXRoIiwicm91bmQiLCJwdXNoIiwic2NvcmVBIiwic2NvcmVCIiwic2Fpc1Jlc3BvbnNlIiwiZmluZCIsInRlbmRlbmN5Q291bnRzIiwid2VpZ2h0IiwicHJlZmVyZW5jZXMiLCJPYmplY3QiLCJlbnRyaWVzIiwic29ydCIsImEiLCJiIiwiZGltZW5zaW9uTWFwIiwiQSIsIkIiLCJ0b3RhbCIsImhpZ2hlciIsIm1heCIsImRpZmZlcmVuY2UiLCJhYnMiLCJtYXhQb3NzaWJsZURpZmZlcmVuY2UiLCJ0eXBlU3RyaW5nIiwibWFwIiwic2NvcmUiLCJqb2luIiwidG90YWxDb25maWRlbmNlIiwicmVkdWNlIiwic3VtIiwiY2FsY3VsYXRlSW50ZXJpbVJlc3VsdHMiLCJkaW1lbnNpb25PcmRlciIsImludGVyaW1SZXNwb25zZXMiLCJpIiwibWluIiwiaXNTQUlTU2NvcmVWYWxpZCIsInZhbGlkQ29tYmluYXRpb25zIiwic29tZSIsInZhbGlkYXRlU0FJU0Rpc3RyaWJ1dGlvbiIsInBvaW50QSIsInBvaW50QiIsIk51bWJlciIsImlzSW50ZWdlciIsImdldENvbnNjaW91c25lc3NEaW1lbnNpb24iLCJzIiwiZG9tYWluRGF0YSIsInByZWZlcmVuY2VLZXkiLCJwcmVmZXJlbmNlRGF0YSIsImNvbnNvbGUiLCJ3YXJuIiwicGVyY2VudGFnZSIsImFyYWJpY0RvbWFpbk5hbWUiLCJjb25zY2lvdXNuZXNzRGVzY3JpcHRpb24iLCJlbmVyZ3lTb3VyY2VQYXR0ZXJuIiwiYXdhcmVuZXNzU3R5bGUiLCJkZWNpc2lvbk1ha2luZ0NlbnRlciIsImxpZmVTdHJ1Y3R1cmVQcmVmZXJlbmNlIiwidGVzdFNBSVNTY29yaW5nIiwibG9nIiwicmVzdWx0IiwiZm9yRWFjaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/MBTICalculatorService.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/ValidationService.ts":
/*!***********************************************!*\
  !*** ./src/lib/services/ValidationService.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ValidationService: () => (/* binding */ ValidationService)\n/* harmony export */ });\nclass ValidationService {\n    constructor(){}\n    static getInstance() {\n        if (!ValidationService.instance) {\n            ValidationService.instance = new ValidationService();\n        }\n        return ValidationService.instance;\n    }\n    validateResponses(responses, methodology) {\n        const errors = [];\n        if (!responses || responses.length === 0) {\n            errors.push({\n                field: \"responses\",\n                message: \"No responses provided\",\n                code: \"EMPTY_RESPONSES\"\n            });\n            return {\n                isValid: false,\n                errors\n            };\n        }\n        for(let i = 0; i < responses.length; i++){\n            const response = responses[i];\n            const responseErrors = this.validateSingleResponse(response, methodology, i);\n            errors.push(...responseErrors);\n        }\n        if (methodology === \"sais\") {\n            const saisErrors = this.validateSAISDistributions(responses);\n            errors.push(...saisErrors);\n        }\n        return {\n            isValid: errors.length === 0,\n            errors\n        };\n    }\n    validateSingleResponse(response, methodology, index) {\n        const errors = [];\n        const fieldPrefix = `responses[${index}]`;\n        if (!response.questionId) {\n            errors.push({\n                field: `${fieldPrefix}.questionId`,\n                message: \"Question ID is required\",\n                code: \"MISSING_QUESTION_ID\"\n            });\n        }\n        if (!response.sessionId) {\n            errors.push({\n                field: `${fieldPrefix}.sessionId`,\n                message: \"Session ID is required\",\n                code: \"MISSING_SESSION_ID\"\n            });\n        }\n        if (!response.mbtiDimension) {\n            errors.push({\n                field: `${fieldPrefix}.mbtiDimension`,\n                message: \"MBTI dimension is required\",\n                code: \"MISSING_DIMENSION\"\n            });\n        } else if (!this.isValidDimension(response.mbtiDimension)) {\n            errors.push({\n                field: `${fieldPrefix}.mbtiDimension`,\n                message: \"Invalid MBTI dimension\",\n                code: \"INVALID_DIMENSION\"\n            });\n        }\n        if (!response.responseType) {\n            errors.push({\n                field: `${fieldPrefix}.responseType`,\n                message: \"Response type is required\",\n                code: \"MISSING_RESPONSE_TYPE\"\n            });\n        }\n        if (response.responseType === \"binary\") {\n            if (!response.selectedOption || ![\n                \"A\",\n                \"B\"\n            ].includes(response.selectedOption)) {\n                errors.push({\n                    field: `${fieldPrefix}.selectedOption`,\n                    message: \"Binary response must have selectedOption as A or B\",\n                    code: \"INVALID_BINARY_OPTION\"\n                });\n            }\n        } else if (response.responseType === \"distribution\") {\n            if (response.distributionA === undefined || response.distributionB === undefined) {\n                errors.push({\n                    field: `${fieldPrefix}.distribution`,\n                    message: \"Distribution responses must have both distributionA and distributionB\",\n                    code: \"MISSING_DISTRIBUTION\"\n                });\n            }\n        }\n        return errors;\n    }\n    validateSAISDistributions(responses) {\n        const errors = [];\n        const distributionTotals = {};\n        for (const response of responses){\n            if (response.responseType === \"distribution\") {\n                const total = (response.distributionA || 0) + (response.distributionB || 0);\n                distributionTotals[response.questionId] = total;\n                if (total !== 5) {\n                    errors.push({\n                        field: `question-${response.questionId}`,\n                        message: `SAIS distribution must total exactly 5, got ${total}`,\n                        code: \"INVALID_SAIS_TOTAL\"\n                    });\n                }\n                if (!this.isValidSAISCombination(response.distributionA || 0, response.distributionB || 0)) {\n                    errors.push({\n                        field: `question-${response.questionId}`,\n                        message: `Invalid SAIS distribution combination: ${response.distributionA}/${response.distributionB}`,\n                        code: \"INVALID_SAIS_COMBINATION\"\n                    });\n                }\n            }\n        }\n        return errors;\n    }\n    isValidSAISCombination(distributionA, distributionB) {\n        const validCombinations = [\n            [\n                5,\n                0\n            ],\n            [\n                4,\n                1\n            ],\n            [\n                3,\n                2\n            ],\n            [\n                2,\n                3\n            ],\n            [\n                1,\n                4\n            ],\n            [\n                0,\n                5\n            ]\n        ];\n        return validCombinations.some(([a, b])=>distributionA === a && distributionB === b);\n    }\n    isValidDimension(dimension) {\n        const validDimensions = [\n            \"E/I\",\n            \"S/N\",\n            \"T/F\",\n            \"J/P\"\n        ];\n        return validDimensions.includes(dimension);\n    }\n    validateSAISResponses(responses) {\n        const baseValidation = this.validateResponses(responses, \"sais\");\n        const distributionTotals = {};\n        for (const response of responses){\n            if (response.responseType === \"distribution\") {\n                distributionTotals[response.questionId] = (response.distributionA || 0) + (response.distributionB || 0);\n            }\n        }\n        return {\n            ...baseValidation,\n            distributionTotals\n        };\n    }\n    validateMethodology(methodology) {\n        const validMethodologies = [\n            \"scenarios\",\n            \"traits\",\n            \"sais\"\n        ];\n        return validMethodologies.includes(methodology);\n    }\n    sanitizeResponses(responses) {\n        return responses.map((response)=>({\n                ...response,\n                questionId: response.questionId?.toString() || \"\",\n                sessionId: response.sessionId?.toString() || \"\",\n                responseId: response.responseId?.toString() || \"\",\n                distributionA: typeof response.distributionA === \"number\" ? Math.max(0, Math.min(5, response.distributionA)) : undefined,\n                distributionB: typeof response.distributionB === \"number\" ? Math.max(0, Math.min(5, response.distributionB)) : undefined\n            }));\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL1ZhbGlkYXRpb25TZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7QUFRTyxNQUFNQTtJQUdYLGFBQXNCLENBQUM7SUFFdkIsT0FBY0MsY0FBaUM7UUFDN0MsSUFBSSxDQUFDRCxrQkFBa0JFLFFBQVEsRUFBRTtZQUMvQkYsa0JBQWtCRSxRQUFRLEdBQUcsSUFBSUY7UUFDbkM7UUFDQSxPQUFPQSxrQkFBa0JFLFFBQVE7SUFDbkM7SUFFT0Msa0JBQ0xDLFNBQTZCLEVBQzdCQyxXQUE0QixFQUNWO1FBQ2xCLE1BQU1DLFNBQTRCLEVBQUU7UUFFcEMsSUFBSSxDQUFDRixhQUFhQSxVQUFVRyxNQUFNLEtBQUssR0FBRztZQUN4Q0QsT0FBT0UsSUFBSSxDQUFDO2dCQUNWQyxPQUFPO2dCQUNQQyxTQUFTO2dCQUNUQyxNQUFNO1lBQ1I7WUFDQSxPQUFPO2dCQUFFQyxTQUFTO2dCQUFPTjtZQUFPO1FBQ2xDO1FBRUEsSUFBSyxJQUFJTyxJQUFJLEdBQUdBLElBQUlULFVBQVVHLE1BQU0sRUFBRU0sSUFBSztZQUN6QyxNQUFNQyxXQUFXVixTQUFTLENBQUNTLEVBQUU7WUFDN0IsTUFBTUUsaUJBQWlCLElBQUksQ0FBQ0Msc0JBQXNCLENBQUNGLFVBQVVULGFBQWFRO1lBQzFFUCxPQUFPRSxJQUFJLElBQUlPO1FBQ2pCO1FBRUEsSUFBSVYsZ0JBQWdCLFFBQVE7WUFDMUIsTUFBTVksYUFBYSxJQUFJLENBQUNDLHlCQUF5QixDQUFDZDtZQUNsREUsT0FBT0UsSUFBSSxJQUFJUztRQUNqQjtRQUVBLE9BQU87WUFDTEwsU0FBU04sT0FBT0MsTUFBTSxLQUFLO1lBQzNCRDtRQUNGO0lBQ0Y7SUFFUVUsdUJBQ05GLFFBQTBCLEVBQzFCVCxXQUE0QixFQUM1QmMsS0FBYSxFQUNNO1FBQ25CLE1BQU1iLFNBQTRCLEVBQUU7UUFDcEMsTUFBTWMsY0FBYyxDQUFDLFVBQVUsRUFBRUQsTUFBTSxDQUFDLENBQUM7UUFFekMsSUFBSSxDQUFDTCxTQUFTTyxVQUFVLEVBQUU7WUFDeEJmLE9BQU9FLElBQUksQ0FBQztnQkFDVkMsT0FBTyxDQUFDLEVBQUVXLFlBQVksV0FBVyxDQUFDO2dCQUNsQ1YsU0FBUztnQkFDVEMsTUFBTTtZQUNSO1FBQ0Y7UUFFQSxJQUFJLENBQUNHLFNBQVNRLFNBQVMsRUFBRTtZQUN2QmhCLE9BQU9FLElBQUksQ0FBQztnQkFDVkMsT0FBTyxDQUFDLEVBQUVXLFlBQVksVUFBVSxDQUFDO2dCQUNqQ1YsU0FBUztnQkFDVEMsTUFBTTtZQUNSO1FBQ0Y7UUFFQSxJQUFJLENBQUNHLFNBQVNTLGFBQWEsRUFBRTtZQUMzQmpCLE9BQU9FLElBQUksQ0FBQztnQkFDVkMsT0FBTyxDQUFDLEVBQUVXLFlBQVksY0FBYyxDQUFDO2dCQUNyQ1YsU0FBUztnQkFDVEMsTUFBTTtZQUNSO1FBQ0YsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDYSxnQkFBZ0IsQ0FBQ1YsU0FBU1MsYUFBYSxHQUFHO1lBQ3pEakIsT0FBT0UsSUFBSSxDQUFDO2dCQUNWQyxPQUFPLENBQUMsRUFBRVcsWUFBWSxjQUFjLENBQUM7Z0JBQ3JDVixTQUFTO2dCQUNUQyxNQUFNO1lBQ1I7UUFDRjtRQUVBLElBQUksQ0FBQ0csU0FBU1csWUFBWSxFQUFFO1lBQzFCbkIsT0FBT0UsSUFBSSxDQUFDO2dCQUNWQyxPQUFPLENBQUMsRUFBRVcsWUFBWSxhQUFhLENBQUM7Z0JBQ3BDVixTQUFTO2dCQUNUQyxNQUFNO1lBQ1I7UUFDRjtRQUVBLElBQUlHLFNBQVNXLFlBQVksS0FBSyxVQUFVO1lBQ3RDLElBQUksQ0FBQ1gsU0FBU1ksY0FBYyxJQUFJLENBQUM7Z0JBQUM7Z0JBQUs7YUFBSSxDQUFDQyxRQUFRLENBQUNiLFNBQVNZLGNBQWMsR0FBRztnQkFDN0VwQixPQUFPRSxJQUFJLENBQUM7b0JBQ1ZDLE9BQU8sQ0FBQyxFQUFFVyxZQUFZLGVBQWUsQ0FBQztvQkFDdENWLFNBQVM7b0JBQ1RDLE1BQU07Z0JBQ1I7WUFDRjtRQUNGLE9BQU8sSUFBSUcsU0FBU1csWUFBWSxLQUFLLGdCQUFnQjtZQUNuRCxJQUFJWCxTQUFTYyxhQUFhLEtBQUtDLGFBQWFmLFNBQVNnQixhQUFhLEtBQUtELFdBQVc7Z0JBQ2hGdkIsT0FBT0UsSUFBSSxDQUFDO29CQUNWQyxPQUFPLENBQUMsRUFBRVcsWUFBWSxhQUFhLENBQUM7b0JBQ3BDVixTQUFTO29CQUNUQyxNQUFNO2dCQUNSO1lBQ0Y7UUFDRjtRQUVBLE9BQU9MO0lBQ1Q7SUFFUVksMEJBQTBCZCxTQUE2QixFQUFxQjtRQUNsRixNQUFNRSxTQUE0QixFQUFFO1FBQ3BDLE1BQU15QixxQkFBdUQsQ0FBQztRQUU5RCxLQUFLLE1BQU1qQixZQUFZVixVQUFXO1lBQ2hDLElBQUlVLFNBQVNXLFlBQVksS0FBSyxnQkFBZ0I7Z0JBQzVDLE1BQU1PLFFBQVEsQ0FBQ2xCLFNBQVNjLGFBQWEsSUFBSSxLQUFNZCxDQUFBQSxTQUFTZ0IsYUFBYSxJQUFJO2dCQUN6RUMsa0JBQWtCLENBQUNqQixTQUFTTyxVQUFVLENBQUMsR0FBR1c7Z0JBRTFDLElBQUlBLFVBQVUsR0FBRztvQkFDZjFCLE9BQU9FLElBQUksQ0FBQzt3QkFDVkMsT0FBTyxDQUFDLFNBQVMsRUFBRUssU0FBU08sVUFBVSxDQUFDLENBQUM7d0JBQ3hDWCxTQUFTLENBQUMsNENBQTRDLEVBQUVzQixNQUFNLENBQUM7d0JBQy9EckIsTUFBTTtvQkFDUjtnQkFDRjtnQkFFQSxJQUFJLENBQUMsSUFBSSxDQUFDc0Isc0JBQXNCLENBQUNuQixTQUFTYyxhQUFhLElBQUksR0FBR2QsU0FBU2dCLGFBQWEsSUFBSSxJQUFJO29CQUMxRnhCLE9BQU9FLElBQUksQ0FBQzt3QkFDVkMsT0FBTyxDQUFDLFNBQVMsRUFBRUssU0FBU08sVUFBVSxDQUFDLENBQUM7d0JBQ3hDWCxTQUFTLENBQUMsdUNBQXVDLEVBQUVJLFNBQVNjLGFBQWEsQ0FBQyxDQUFDLEVBQUVkLFNBQVNnQixhQUFhLENBQUMsQ0FBQzt3QkFDckduQixNQUFNO29CQUNSO2dCQUNGO1lBQ0Y7UUFDRjtRQUVBLE9BQU9MO0lBQ1Q7SUFFUTJCLHVCQUF1QkwsYUFBcUIsRUFBRUUsYUFBcUIsRUFBVztRQUNwRixNQUFNSSxvQkFBb0I7WUFDeEI7Z0JBQUM7Z0JBQUc7YUFBRTtZQUFFO2dCQUFDO2dCQUFHO2FBQUU7WUFBRTtnQkFBQztnQkFBRzthQUFFO1lBQUU7Z0JBQUM7Z0JBQUc7YUFBRTtZQUFFO2dCQUFDO2dCQUFHO2FBQUU7WUFBRTtnQkFBQztnQkFBRzthQUFFO1NBQy9DO1FBRUQsT0FBT0Esa0JBQWtCQyxJQUFJLENBQzNCLENBQUMsQ0FBQ0MsR0FBR0MsRUFBRSxHQUFLVCxrQkFBa0JRLEtBQUtOLGtCQUFrQk87SUFFekQ7SUFFUWIsaUJBQWlCYyxTQUFpQixFQUFXO1FBQ25ELE1BQU1DLGtCQUFrQjtZQUFDO1lBQU87WUFBTztZQUFPO1NBQU07UUFDcEQsT0FBT0EsZ0JBQWdCWixRQUFRLENBQUNXO0lBQ2xDO0lBRU9FLHNCQUFzQnBDLFNBQTZCLEVBQXdCO1FBQ2hGLE1BQU1xQyxpQkFBaUIsSUFBSSxDQUFDdEMsaUJBQWlCLENBQUNDLFdBQVc7UUFDekQsTUFBTTJCLHFCQUF1RCxDQUFDO1FBRTlELEtBQUssTUFBTWpCLFlBQVlWLFVBQVc7WUFDaEMsSUFBSVUsU0FBU1csWUFBWSxLQUFLLGdCQUFnQjtnQkFDNUNNLGtCQUFrQixDQUFDakIsU0FBU08sVUFBVSxDQUFDLEdBQ3JDLENBQUNQLFNBQVNjLGFBQWEsSUFBSSxLQUFNZCxDQUFBQSxTQUFTZ0IsYUFBYSxJQUFJO1lBQy9EO1FBQ0Y7UUFFQSxPQUFPO1lBQ0wsR0FBR1csY0FBYztZQUNqQlY7UUFDRjtJQUNGO0lBRU9XLG9CQUFvQnJDLFdBQW1CLEVBQVc7UUFDdkQsTUFBTXNDLHFCQUFxQjtZQUFDO1lBQWE7WUFBVTtTQUFPO1FBQzFELE9BQU9BLG1CQUFtQmhCLFFBQVEsQ0FBQ3RCO0lBQ3JDO0lBRU91QyxrQkFBa0J4QyxTQUE2QixFQUFzQjtRQUMxRSxPQUFPQSxVQUFVeUMsR0FBRyxDQUFDL0IsQ0FBQUEsV0FBYTtnQkFDaEMsR0FBR0EsUUFBUTtnQkFDWE8sWUFBWVAsU0FBU08sVUFBVSxFQUFFeUIsY0FBYztnQkFDL0N4QixXQUFXUixTQUFTUSxTQUFTLEVBQUV3QixjQUFjO2dCQUM3Q0MsWUFBWWpDLFNBQVNpQyxVQUFVLEVBQUVELGNBQWM7Z0JBQy9DbEIsZUFBZSxPQUFPZCxTQUFTYyxhQUFhLEtBQUssV0FDN0NvQixLQUFLQyxHQUFHLENBQUMsR0FBR0QsS0FBS0UsR0FBRyxDQUFDLEdBQUdwQyxTQUFTYyxhQUFhLEtBQzlDQztnQkFDSkMsZUFBZSxPQUFPaEIsU0FBU2dCLGFBQWEsS0FBSyxXQUM3Q2tCLEtBQUtDLEdBQUcsQ0FBQyxHQUFHRCxLQUFLRSxHQUFHLENBQUMsR0FBR3BDLFNBQVNnQixhQUFhLEtBQzlDRDtZQUNOO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL21idGktY29hY2hpbmctcGxhdGZvcm0vLi9zcmMvbGliL3NlcnZpY2VzL1ZhbGlkYXRpb25TZXJ2aWNlLnRzPzQxN2EiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBRdWVzdGlvblJlc3BvbnNlLFxyXG4gIFZhbGlkYXRpb25SZXN1bHQsXHJcbiAgVmFsaWRhdGlvbkVycm9yLFxyXG4gIFNBSVNWYWxpZGF0aW9uUmVzdWx0LFxyXG4gIE1ldGhvZG9sb2d5VHlwZSxcclxufSBmcm9tICdAL2xpYi90eXBlcydcclxuXHJcbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uU2VydmljZSB7XHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFZhbGlkYXRpb25TZXJ2aWNlXHJcblxyXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7fVxyXG5cclxuICBwdWJsaWMgc3RhdGljIGdldEluc3RhbmNlKCk6IFZhbGlkYXRpb25TZXJ2aWNlIHtcclxuICAgIGlmICghVmFsaWRhdGlvblNlcnZpY2UuaW5zdGFuY2UpIHtcclxuICAgICAgVmFsaWRhdGlvblNlcnZpY2UuaW5zdGFuY2UgPSBuZXcgVmFsaWRhdGlvblNlcnZpY2UoKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIFZhbGlkYXRpb25TZXJ2aWNlLmluc3RhbmNlXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgdmFsaWRhdGVSZXNwb25zZXMoXHJcbiAgICByZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSxcclxuICAgIG1ldGhvZG9sb2d5OiBNZXRob2RvbG9neVR5cGVcclxuICApOiBWYWxpZGF0aW9uUmVzdWx0IHtcclxuICAgIGNvbnN0IGVycm9yczogVmFsaWRhdGlvbkVycm9yW10gPSBbXVxyXG5cclxuICAgIGlmICghcmVzcG9uc2VzIHx8IHJlc3BvbnNlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICAgIGZpZWxkOiAncmVzcG9uc2VzJyxcclxuICAgICAgICBtZXNzYWdlOiAnTm8gcmVzcG9uc2VzIHByb3ZpZGVkJyxcclxuICAgICAgICBjb2RlOiAnRU1QVFlfUkVTUE9OU0VTJyxcclxuICAgICAgfSlcclxuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIGVycm9ycyB9XHJcbiAgICB9XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXNwb25zZXMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgcmVzcG9uc2UgPSByZXNwb25zZXNbaV1cclxuICAgICAgY29uc3QgcmVzcG9uc2VFcnJvcnMgPSB0aGlzLnZhbGlkYXRlU2luZ2xlUmVzcG9uc2UocmVzcG9uc2UsIG1ldGhvZG9sb2d5LCBpKVxyXG4gICAgICBlcnJvcnMucHVzaCguLi5yZXNwb25zZUVycm9ycylcclxuICAgIH1cclxuXHJcbiAgICBpZiAobWV0aG9kb2xvZ3kgPT09ICdzYWlzJykge1xyXG4gICAgICBjb25zdCBzYWlzRXJyb3JzID0gdGhpcy52YWxpZGF0ZVNBSVNEaXN0cmlidXRpb25zKHJlc3BvbnNlcylcclxuICAgICAgZXJyb3JzLnB1c2goLi4uc2Fpc0Vycm9ycylcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgICBlcnJvcnMsXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRlU2luZ2xlUmVzcG9uc2UoXHJcbiAgICByZXNwb25zZTogUXVlc3Rpb25SZXNwb25zZSxcclxuICAgIG1ldGhvZG9sb2d5OiBNZXRob2RvbG9neVR5cGUsXHJcbiAgICBpbmRleDogbnVtYmVyXHJcbiAgKTogVmFsaWRhdGlvbkVycm9yW10ge1xyXG4gICAgY29uc3QgZXJyb3JzOiBWYWxpZGF0aW9uRXJyb3JbXSA9IFtdXHJcbiAgICBjb25zdCBmaWVsZFByZWZpeCA9IGByZXNwb25zZXNbJHtpbmRleH1dYFxyXG5cclxuICAgIGlmICghcmVzcG9uc2UucXVlc3Rpb25JZCkge1xyXG4gICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgZmllbGQ6IGAke2ZpZWxkUHJlZml4fS5xdWVzdGlvbklkYCxcclxuICAgICAgICBtZXNzYWdlOiAnUXVlc3Rpb24gSUQgaXMgcmVxdWlyZWQnLFxyXG4gICAgICAgIGNvZGU6ICdNSVNTSU5HX1FVRVNUSU9OX0lEJyxcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXJlc3BvbnNlLnNlc3Npb25JZCkge1xyXG4gICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgZmllbGQ6IGAke2ZpZWxkUHJlZml4fS5zZXNzaW9uSWRgLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdTZXNzaW9uIElEIGlzIHJlcXVpcmVkJyxcclxuICAgICAgICBjb2RlOiAnTUlTU0lOR19TRVNTSU9OX0lEJyxcclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBpZiAoIXJlc3BvbnNlLm1idGlEaW1lbnNpb24pIHtcclxuICAgICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICAgIGZpZWxkOiBgJHtmaWVsZFByZWZpeH0ubWJ0aURpbWVuc2lvbmAsXHJcbiAgICAgICAgbWVzc2FnZTogJ01CVEkgZGltZW5zaW9uIGlzIHJlcXVpcmVkJyxcclxuICAgICAgICBjb2RlOiAnTUlTU0lOR19ESU1FTlNJT04nLFxyXG4gICAgICB9KVxyXG4gICAgfSBlbHNlIGlmICghdGhpcy5pc1ZhbGlkRGltZW5zaW9uKHJlc3BvbnNlLm1idGlEaW1lbnNpb24pKSB7XHJcbiAgICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgICBmaWVsZDogYCR7ZmllbGRQcmVmaXh9Lm1idGlEaW1lbnNpb25gLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdJbnZhbGlkIE1CVEkgZGltZW5zaW9uJyxcclxuICAgICAgICBjb2RlOiAnSU5WQUxJRF9ESU1FTlNJT04nLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGlmICghcmVzcG9uc2UucmVzcG9uc2VUeXBlKSB7XHJcbiAgICAgIGVycm9ycy5wdXNoKHtcclxuICAgICAgICBmaWVsZDogYCR7ZmllbGRQcmVmaXh9LnJlc3BvbnNlVHlwZWAsXHJcbiAgICAgICAgbWVzc2FnZTogJ1Jlc3BvbnNlIHR5cGUgaXMgcmVxdWlyZWQnLFxyXG4gICAgICAgIGNvZGU6ICdNSVNTSU5HX1JFU1BPTlNFX1RZUEUnLFxyXG4gICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChyZXNwb25zZS5yZXNwb25zZVR5cGUgPT09ICdiaW5hcnknKSB7XHJcbiAgICAgIGlmICghcmVzcG9uc2Uuc2VsZWN0ZWRPcHRpb24gfHwgIVsnQScsICdCJ10uaW5jbHVkZXMocmVzcG9uc2Uuc2VsZWN0ZWRPcHRpb24pKSB7XHJcbiAgICAgICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICAgICAgZmllbGQ6IGAke2ZpZWxkUHJlZml4fS5zZWxlY3RlZE9wdGlvbmAsXHJcbiAgICAgICAgICBtZXNzYWdlOiAnQmluYXJ5IHJlc3BvbnNlIG11c3QgaGF2ZSBzZWxlY3RlZE9wdGlvbiBhcyBBIG9yIEInLFxyXG4gICAgICAgICAgY29kZTogJ0lOVkFMSURfQklOQVJZX09QVElPTicsXHJcbiAgICAgICAgfSlcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIGlmIChyZXNwb25zZS5yZXNwb25zZVR5cGUgPT09ICdkaXN0cmlidXRpb24nKSB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5kaXN0cmlidXRpb25BID09PSB1bmRlZmluZWQgfHwgcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgZXJyb3JzLnB1c2goe1xyXG4gICAgICAgICAgZmllbGQ6IGAke2ZpZWxkUHJlZml4fS5kaXN0cmlidXRpb25gLFxyXG4gICAgICAgICAgbWVzc2FnZTogJ0Rpc3RyaWJ1dGlvbiByZXNwb25zZXMgbXVzdCBoYXZlIGJvdGggZGlzdHJpYnV0aW9uQSBhbmQgZGlzdHJpYnV0aW9uQicsXHJcbiAgICAgICAgICBjb2RlOiAnTUlTU0lOR19ESVNUUklCVVRJT04nLFxyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZXJyb3JzXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHZhbGlkYXRlU0FJU0Rpc3RyaWJ1dGlvbnMocmVzcG9uc2VzOiBRdWVzdGlvblJlc3BvbnNlW10pOiBWYWxpZGF0aW9uRXJyb3JbXSB7XHJcbiAgICBjb25zdCBlcnJvcnM6IFZhbGlkYXRpb25FcnJvcltdID0gW11cclxuICAgIGNvbnN0IGRpc3RyaWJ1dGlvblRvdGFsczogeyBbcXVlc3Rpb25JZDogc3RyaW5nXTogbnVtYmVyIH0gPSB7fVxyXG5cclxuICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgcmVzcG9uc2VzKSB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5yZXNwb25zZVR5cGUgPT09ICdkaXN0cmlidXRpb24nKSB7XHJcbiAgICAgICAgY29uc3QgdG90YWwgPSAocmVzcG9uc2UuZGlzdHJpYnV0aW9uQSB8fCAwKSArIChyZXNwb25zZS5kaXN0cmlidXRpb25CIHx8IDApXHJcbiAgICAgICAgZGlzdHJpYnV0aW9uVG90YWxzW3Jlc3BvbnNlLnF1ZXN0aW9uSWRdID0gdG90YWxcclxuXHJcbiAgICAgICAgaWYgKHRvdGFsICE9PSA1KSB7XHJcbiAgICAgICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgICAgIGZpZWxkOiBgcXVlc3Rpb24tJHtyZXNwb25zZS5xdWVzdGlvbklkfWAsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBTQUlTIGRpc3RyaWJ1dGlvbiBtdXN0IHRvdGFsIGV4YWN0bHkgNSwgZ290ICR7dG90YWx9YCxcclxuICAgICAgICAgICAgY29kZTogJ0lOVkFMSURfU0FJU19UT1RBTCcsXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLmlzVmFsaWRTQUlTQ29tYmluYXRpb24ocmVzcG9uc2UuZGlzdHJpYnV0aW9uQSB8fCAwLCByZXNwb25zZS5kaXN0cmlidXRpb25CIHx8IDApKSB7XHJcbiAgICAgICAgICBlcnJvcnMucHVzaCh7XHJcbiAgICAgICAgICAgIGZpZWxkOiBgcXVlc3Rpb24tJHtyZXNwb25zZS5xdWVzdGlvbklkfWAsXHJcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBJbnZhbGlkIFNBSVMgZGlzdHJpYnV0aW9uIGNvbWJpbmF0aW9uOiAke3Jlc3BvbnNlLmRpc3RyaWJ1dGlvbkF9LyR7cmVzcG9uc2UuZGlzdHJpYnV0aW9uQn1gLFxyXG4gICAgICAgICAgICBjb2RlOiAnSU5WQUxJRF9TQUlTX0NPTUJJTkFUSU9OJyxcclxuICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVycm9yc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBpc1ZhbGlkU0FJU0NvbWJpbmF0aW9uKGRpc3RyaWJ1dGlvbkE6IG51bWJlciwgZGlzdHJpYnV0aW9uQjogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCB2YWxpZENvbWJpbmF0aW9ucyA9IFtcclxuICAgICAgWzUsIDBdLCBbNCwgMV0sIFszLCAyXSwgWzIsIDNdLCBbMSwgNF0sIFswLCA1XVxyXG4gICAgXVxyXG4gICAgXHJcbiAgICByZXR1cm4gdmFsaWRDb21iaW5hdGlvbnMuc29tZShcclxuICAgICAgKFthLCBiXSkgPT4gZGlzdHJpYnV0aW9uQSA9PT0gYSAmJiBkaXN0cmlidXRpb25CID09PSBiXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGlzVmFsaWREaW1lbnNpb24oZGltZW5zaW9uOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IHZhbGlkRGltZW5zaW9ucyA9IFsnRS9JJywgJ1MvTicsICdUL0YnLCAnSi9QJ11cclxuICAgIHJldHVybiB2YWxpZERpbWVuc2lvbnMuaW5jbHVkZXMoZGltZW5zaW9uKVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHZhbGlkYXRlU0FJU1Jlc3BvbnNlcyhyZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSk6IFNBSVNWYWxpZGF0aW9uUmVzdWx0IHtcclxuICAgIGNvbnN0IGJhc2VWYWxpZGF0aW9uID0gdGhpcy52YWxpZGF0ZVJlc3BvbnNlcyhyZXNwb25zZXMsICdzYWlzJylcclxuICAgIGNvbnN0IGRpc3RyaWJ1dGlvblRvdGFsczogeyBbcXVlc3Rpb25JZDogc3RyaW5nXTogbnVtYmVyIH0gPSB7fVxyXG5cclxuICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgcmVzcG9uc2VzKSB7XHJcbiAgICAgIGlmIChyZXNwb25zZS5yZXNwb25zZVR5cGUgPT09ICdkaXN0cmlidXRpb24nKSB7XHJcbiAgICAgICAgZGlzdHJpYnV0aW9uVG90YWxzW3Jlc3BvbnNlLnF1ZXN0aW9uSWRdID0gXHJcbiAgICAgICAgICAocmVzcG9uc2UuZGlzdHJpYnV0aW9uQSB8fCAwKSArIChyZXNwb25zZS5kaXN0cmlidXRpb25CIHx8IDApXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAuLi5iYXNlVmFsaWRhdGlvbixcclxuICAgICAgZGlzdHJpYnV0aW9uVG90YWxzLFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHVibGljIHZhbGlkYXRlTWV0aG9kb2xvZ3kobWV0aG9kb2xvZ3k6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgY29uc3QgdmFsaWRNZXRob2RvbG9naWVzID0gWydzY2VuYXJpb3MnLCAndHJhaXRzJywgJ3NhaXMnXVxyXG4gICAgcmV0dXJuIHZhbGlkTWV0aG9kb2xvZ2llcy5pbmNsdWRlcyhtZXRob2RvbG9neSlcclxuICB9XHJcblxyXG4gIHB1YmxpYyBzYW5pdGl6ZVJlc3BvbnNlcyhyZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSk6IFF1ZXN0aW9uUmVzcG9uc2VbXSB7XHJcbiAgICByZXR1cm4gcmVzcG9uc2VzLm1hcChyZXNwb25zZSA9PiAoe1xyXG4gICAgICAuLi5yZXNwb25zZSxcclxuICAgICAgcXVlc3Rpb25JZDogcmVzcG9uc2UucXVlc3Rpb25JZD8udG9TdHJpbmcoKSB8fCAnJyxcclxuICAgICAgc2Vzc2lvbklkOiByZXNwb25zZS5zZXNzaW9uSWQ/LnRvU3RyaW5nKCkgfHwgJycsXHJcbiAgICAgIHJlc3BvbnNlSWQ6IHJlc3BvbnNlLnJlc3BvbnNlSWQ/LnRvU3RyaW5nKCkgfHwgJycsXHJcbiAgICAgIGRpc3RyaWJ1dGlvbkE6IHR5cGVvZiByZXNwb25zZS5kaXN0cmlidXRpb25BID09PSAnbnVtYmVyJyBcclxuICAgICAgICA/IE1hdGgubWF4KDAsIE1hdGgubWluKDUsIHJlc3BvbnNlLmRpc3RyaWJ1dGlvbkEpKSBcclxuICAgICAgICA6IHVuZGVmaW5lZCxcclxuICAgICAgZGlzdHJpYnV0aW9uQjogdHlwZW9mIHJlc3BvbnNlLmRpc3RyaWJ1dGlvbkIgPT09ICdudW1iZXInIFxyXG4gICAgICAgID8gTWF0aC5tYXgoMCwgTWF0aC5taW4oNSwgcmVzcG9uc2UuZGlzdHJpYnV0aW9uQikpIFxyXG4gICAgICAgIDogdW5kZWZpbmVkLFxyXG4gICAgfSkpXHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbIlZhbGlkYXRpb25TZXJ2aWNlIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsInZhbGlkYXRlUmVzcG9uc2VzIiwicmVzcG9uc2VzIiwibWV0aG9kb2xvZ3kiLCJlcnJvcnMiLCJsZW5ndGgiLCJwdXNoIiwiZmllbGQiLCJtZXNzYWdlIiwiY29kZSIsImlzVmFsaWQiLCJpIiwicmVzcG9uc2UiLCJyZXNwb25zZUVycm9ycyIsInZhbGlkYXRlU2luZ2xlUmVzcG9uc2UiLCJzYWlzRXJyb3JzIiwidmFsaWRhdGVTQUlTRGlzdHJpYnV0aW9ucyIsImluZGV4IiwiZmllbGRQcmVmaXgiLCJxdWVzdGlvbklkIiwic2Vzc2lvbklkIiwibWJ0aURpbWVuc2lvbiIsImlzVmFsaWREaW1lbnNpb24iLCJyZXNwb25zZVR5cGUiLCJzZWxlY3RlZE9wdGlvbiIsImluY2x1ZGVzIiwiZGlzdHJpYnV0aW9uQSIsInVuZGVmaW5lZCIsImRpc3RyaWJ1dGlvbkIiLCJkaXN0cmlidXRpb25Ub3RhbHMiLCJ0b3RhbCIsImlzVmFsaWRTQUlTQ29tYmluYXRpb24iLCJ2YWxpZENvbWJpbmF0aW9ucyIsInNvbWUiLCJhIiwiYiIsImRpbWVuc2lvbiIsInZhbGlkRGltZW5zaW9ucyIsInZhbGlkYXRlU0FJU1Jlc3BvbnNlcyIsImJhc2VWYWxpZGF0aW9uIiwidmFsaWRhdGVNZXRob2RvbG9neSIsInZhbGlkTWV0aG9kb2xvZ2llcyIsInNhbml0aXplUmVzcG9uc2VzIiwibWFwIiwidG9TdHJpbmciLCJyZXNwb25zZUlkIiwiTWF0aCIsIm1heCIsIm1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/ValidationService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate%2Froute&page=%2Fapi%2Fassessment%2Fcalculate%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();