"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/assessment/calculate-interim/route";
exports.ids = ["app/api/assessment/calculate-interim/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&page=%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate-interim%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&page=%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate-interim%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_am112_OneDrive_Clients_MBTI_src_app_api_assessment_calculate_interim_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/assessment/calculate-interim/route.ts */ \"(rsc)/./src/app/api/assessment/calculate-interim/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/assessment/calculate-interim/route\",\n        pathname: \"/api/assessment/calculate-interim\",\n        filename: \"route\",\n        bundlePath: \"app/api/assessment/calculate-interim/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\am112\\\\OneDrive\\\\سطح المكتب\\\\Clients\\\\MBTI\\\\src\\\\app\\\\api\\\\assessment\\\\calculate-interim\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_am112_OneDrive_Clients_MBTI_src_app_api_assessment_calculate_interim_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/assessment/calculate-interim/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhc3Nlc3NtZW50JTJGY2FsY3VsYXRlLWludGVyaW0lMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmFzc2Vzc21lbnQlMkZjYWxjdWxhdGUtaW50ZXJpbSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmFzc2Vzc21lbnQlMkZjYWxjdWxhdGUtaW50ZXJpbSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNhbTExMiU1Q09uZURyaXZlJTVDJUQ4JUIzJUQ4JUI3JUQ4JUFEJTIwJUQ4JUE3JUQ5JTg0JUQ5JTg1JUQ5JTgzJUQ4JUFBJUQ4JUE4JTVDQ2xpZW50cyU1Q01CVEklNUNzcmMlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNVc2VycyU1Q2FtMTEyJTVDT25lRHJpdmUlNUMlRDglQjMlRDglQjclRDglQUQlMjAlRDglQTclRDklODQlRDklODUlRDklODMlRDglQUElRDglQTglNUNDbGllbnRzJTVDTUJUSSZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDNkQ7QUFDMUk7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tYnRpLWNvYWNoaW5nLXBsYXRmb3JtLz9jZTgxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXGFtMTEyXFxcXE9uZURyaXZlXFxcXNiz2LfYrSDYp9mE2YXZg9iq2KhcXFxcQ2xpZW50c1xcXFxNQlRJXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFzc2Vzc21lbnRcXFxcY2FsY3VsYXRlLWludGVyaW1cXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2Fzc2Vzc21lbnQvY2FsY3VsYXRlLWludGVyaW0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS1pbnRlcmltXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS1pbnRlcmltL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcYW0xMTJcXFxcT25lRHJpdmVcXFxc2LPYt9itINin2YTZhdmD2KrYqFxcXFxDbGllbnRzXFxcXE1CVElcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXNzZXNzbWVudFxcXFxjYWxjdWxhdGUtaW50ZXJpbVxcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXNzZXNzbWVudC9jYWxjdWxhdGUtaW50ZXJpbS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&page=%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate-interim%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/assessment/calculate-interim/route.ts":
/*!***********************************************************!*\
  !*** ./src/app/api/assessment/calculate-interim/route.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_services_MBTICalculatorService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/services/MBTICalculatorService */ \"(rsc)/./src/lib/services/MBTICalculatorService.ts\");\n\n\nasync function POST(request) {\n    const interimApiEnabled = process.env.NEXT_PUBLIC_INTERIM_API_ENABLED !== \"false\";\n    if (!interimApiEnabled) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Interim results temporarily unavailable\",\n            fallback: true,\n            redirect: \"/api/assessment/calculate\"\n        }, {\n            status: 503\n        });\n    }\n    try {\n        const body = await request.json();\n        const { sessionId, responses } = body;\n        if (!sessionId || !responses || !Array.isArray(responses)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Invalid request data. SessionId and responses array required.\"\n            }, {\n                status: 400\n            });\n        }\n        // Filter only core responses and validate count\n        const coreResponses = responses.filter((r)=>r.questionType === \"core\");\n        if (coreResponses.length !== 4) {\n            console.error(`Interim API: Expected 4 core responses, got ${coreResponses.length}. Total responses: ${responses.length}`);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: `Invalid core responses count. Expected 4, got ${coreResponses.length}`,\n                debug: {\n                    totalResponses: responses.length,\n                    coreResponses: coreResponses.length,\n                    responseTypes: responses.map((r)=>r.questionType)\n                }\n            }, {\n                status: 400\n            });\n        }\n        const calculator = _lib_services_MBTICalculatorService__WEBPACK_IMPORTED_MODULE_1__.MBTICalculatorService.getInstance();\n        const interimResult = calculator.calculateInterimResults(coreResponses);\n        const insights = generateInterimInsights(interimResult.mbtiType, interimResult.dimensionScores, body.language || \"en\");\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            interimResult: {\n                ...interimResult,\n                confidence: Math.min(interimResult.overallConfidence, 65),\n                insights,\n                disclaimer: getDisclaimer(body.language || \"en\")\n            }\n        });\n    } catch (error) {\n        console.error(\"Interim calculation error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Failed to calculate interim results\"\n        }, {\n            status: 500\n        });\n    }\n}\nfunction generateInterimInsights(mbtiType, dimensionScores, language) {\n    const insights = [];\n    const isArabic = language === \"ar\";\n    // Insight based on E/I dimension\n    const eiScore = dimensionScores.find((d)=>d.dimension === \"E/I\");\n    if (eiScore) {\n        if (eiScore.preference === \"E\") {\n            insights.push(isArabic ? \"يبدو أنك تستمد طاقتك من التفاعل مع الآخرين والعالم الخارجي\" : \"You appear to draw energy from interacting with others and the external world\");\n        } else {\n            insights.push(isArabic ? \"يبدو أنك تفضل التفكير الداخلي والتأمل للحصول على الطاقة\" : \"You seem to prefer inner reflection and introspection for energy\");\n        }\n    }\n    // Insight based on S/N dimension\n    const snScore = dimensionScores.find((d)=>d.dimension === \"S/N\");\n    if (snScore) {\n        if (snScore.preference === \"S\") {\n            insights.push(isArabic ? \"تميل إلى التركيز على التفاصيل الملموسة والحقائق الواقعية\" : \"You tend to focus on concrete details and practical realities\");\n        } else {\n            insights.push(isArabic ? \"تميل إلى رؤية الصورة الكبيرة والاحتمالات المستقبلية\" : \"You tend to see the big picture and future possibilities\");\n        }\n    }\n    // Insight based on T/F dimension\n    const tfScore = dimensionScores.find((d)=>d.dimension === \"T/F\");\n    if (tfScore) {\n        if (tfScore.preference === \"T\") {\n            insights.push(isArabic ? \"تفضل اتخاذ القرارات بناءً على المنطق والتحليل الموضوعي\" : \"You prefer making decisions based on logic and objective analysis\");\n        } else {\n            insights.push(isArabic ? \"تأخذ في الاعتبار القيم الشخصية وتأثير القرارات على الآخرين\" : \"You consider personal values and the impact of decisions on others\");\n        }\n    }\n    return insights.slice(0, 3) // Return maximum 3 insights\n    ;\n}\nfunction getDisclaimer(language) {\n    return language === \"ar\" ? \"هذه نتائج أولية بناءً على 4 أسئلة فقط. ستصبح النتائج أكثر دقة بعد إكمال الأسئلة الإضافية.\" : \"These are preliminary results based on only 4 questions. Results will become more accurate after completing additional questions.\";\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS1pbnRlcmltL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1RDtBQUNxQjtBQUdyRSxlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxNQUFNQyxvQkFBb0JDLFFBQVFDLEdBQUcsQ0FBQ0MsK0JBQStCLEtBQUs7SUFFMUUsSUFBSSxDQUFDSCxtQkFBbUI7UUFDdEIsT0FBT0oscURBQVlBLENBQUNRLElBQUksQ0FBQztZQUN2QkMsT0FBTztZQUNQQyxVQUFVO1lBQ1ZDLFVBQVU7UUFDWixHQUFHO1lBQUVDLFFBQVE7UUFBSTtJQUNuQjtJQUVBLElBQUk7UUFDRixNQUFNQyxPQUFPLE1BQU1WLFFBQVFLLElBQUk7UUFDL0IsTUFBTSxFQUFFTSxTQUFTLEVBQUVDLFNBQVMsRUFBRSxHQUFHRjtRQUVqQyxJQUFJLENBQUNDLGFBQWEsQ0FBQ0MsYUFBYSxDQUFDQyxNQUFNQyxPQUFPLENBQUNGLFlBQVk7WUFDekQsT0FBT2YscURBQVlBLENBQUNRLElBQUksQ0FDdEI7Z0JBQUVDLE9BQU87WUFBZ0UsR0FDekU7Z0JBQUVHLFFBQVE7WUFBSTtRQUVsQjtRQUVBLGdEQUFnRDtRQUNoRCxNQUFNTSxnQkFBZ0JILFVBQVVJLE1BQU0sQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsWUFBWSxLQUFLO1FBQy9ELElBQUlILGNBQWNJLE1BQU0sS0FBSyxHQUFHO1lBQzlCQyxRQUFRZCxLQUFLLENBQUMsQ0FBQyw0Q0FBNEMsRUFBRVMsY0FBY0ksTUFBTSxDQUFDLG1CQUFtQixFQUFFUCxVQUFVTyxNQUFNLENBQUMsQ0FBQztZQUN6SCxPQUFPdEIscURBQVlBLENBQUNRLElBQUksQ0FDdEI7Z0JBQ0VDLE9BQU8sQ0FBQyw4Q0FBOEMsRUFBRVMsY0FBY0ksTUFBTSxDQUFDLENBQUM7Z0JBQzlFRSxPQUFPO29CQUNMQyxnQkFBZ0JWLFVBQVVPLE1BQU07b0JBQ2hDSixlQUFlQSxjQUFjSSxNQUFNO29CQUNuQ0ksZUFBZVgsVUFBVVksR0FBRyxDQUFDUCxDQUFBQSxJQUFLQSxFQUFFQyxZQUFZO2dCQUNsRDtZQUNGLEdBQ0E7Z0JBQUVULFFBQVE7WUFBSTtRQUVsQjtRQUVBLE1BQU1nQixhQUFhM0Isc0ZBQXFCQSxDQUFDNEIsV0FBVztRQUNwRCxNQUFNQyxnQkFBZ0JGLFdBQVdHLHVCQUF1QixDQUFDYjtRQUV6RCxNQUFNYyxXQUFXQyx3QkFBd0JILGNBQWNJLFFBQVEsRUFBRUosY0FBY0ssZUFBZSxFQUFFdEIsS0FBS3VCLFFBQVEsSUFBSTtRQUVqSCxPQUFPcEMscURBQVlBLENBQUNRLElBQUksQ0FBQztZQUN2QjZCLFNBQVM7WUFDVFAsZUFBZTtnQkFDYixHQUFHQSxhQUFhO2dCQUNoQlEsWUFBWUMsS0FBS0MsR0FBRyxDQUFDVixjQUFjVyxpQkFBaUIsRUFBRTtnQkFDdERUO2dCQUNBVSxZQUFZQyxjQUFjOUIsS0FBS3VCLFFBQVEsSUFBSTtZQUM3QztRQUNGO0lBQ0YsRUFBRSxPQUFPM0IsT0FBTztRQUNkYyxRQUFRZCxLQUFLLENBQUMsOEJBQThCQTtRQUM1QyxPQUFPVCxxREFBWUEsQ0FBQ1EsSUFBSSxDQUN0QjtZQUFFQyxPQUFPO1FBQXNDLEdBQy9DO1lBQUVHLFFBQVE7UUFBSTtJQUVsQjtBQUNGO0FBRUEsU0FBU3FCLHdCQUF3QkMsUUFBZ0IsRUFBRUMsZUFBc0IsRUFBRUMsUUFBZ0I7SUFDekYsTUFBTUosV0FBcUIsRUFBRTtJQUM3QixNQUFNWSxXQUFXUixhQUFhO0lBRTlCLGlDQUFpQztJQUNqQyxNQUFNUyxVQUFVVixnQkFBZ0JXLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsU0FBUyxLQUFLO0lBQzFELElBQUlILFNBQVM7UUFDWCxJQUFJQSxRQUFRSSxVQUFVLEtBQUssS0FBSztZQUM5QmpCLFNBQVNrQixJQUFJLENBQ1hOLFdBQ0ksK0RBQ0E7UUFFUixPQUFPO1lBQ0xaLFNBQVNrQixJQUFJLENBQ1hOLFdBQ0ksNERBQ0E7UUFFUjtJQUNGO0lBRUEsaUNBQWlDO0lBQ2pDLE1BQU1PLFVBQVVoQixnQkFBZ0JXLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsU0FBUyxLQUFLO0lBQzFELElBQUlHLFNBQVM7UUFDWCxJQUFJQSxRQUFRRixVQUFVLEtBQUssS0FBSztZQUM5QmpCLFNBQVNrQixJQUFJLENBQ1hOLFdBQ0ksNkRBQ0E7UUFFUixPQUFPO1lBQ0xaLFNBQVNrQixJQUFJLENBQ1hOLFdBQ0ksd0RBQ0E7UUFFUjtJQUNGO0lBRUEsaUNBQWlDO0lBQ2pDLE1BQU1RLFVBQVVqQixnQkFBZ0JXLElBQUksQ0FBQ0MsQ0FBQUEsSUFBS0EsRUFBRUMsU0FBUyxLQUFLO0lBQzFELElBQUlJLFNBQVM7UUFDWCxJQUFJQSxRQUFRSCxVQUFVLEtBQUssS0FBSztZQUM5QmpCLFNBQVNrQixJQUFJLENBQ1hOLFdBQ0ksMkRBQ0E7UUFFUixPQUFPO1lBQ0xaLFNBQVNrQixJQUFJLENBQ1hOLFdBQ0ksK0RBQ0E7UUFFUjtJQUNGO0lBRUEsT0FBT1osU0FBU3FCLEtBQUssQ0FBQyxHQUFHLEdBQUcsNEJBQTRCOztBQUMxRDtBQUVBLFNBQVNWLGNBQWNQLFFBQWdCO0lBQ3JDLE9BQU9BLGFBQWEsT0FDaEIsOEZBQ0E7QUFDTiIsInNvdXJjZXMiOlsid2VicGFjazovL21idGktY29hY2hpbmctcGxhdGZvcm0vLi9zcmMvYXBwL2FwaS9hc3Nlc3NtZW50L2NhbGN1bGF0ZS1pbnRlcmltL3JvdXRlLnRzPzE5MTYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQgeyBNQlRJQ2FsY3VsYXRvclNlcnZpY2UgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9NQlRJQ2FsY3VsYXRvclNlcnZpY2UnXHJcbmltcG9ydCB7IFF1ZXN0aW9uUmVzcG9uc2UsIE1CVElEaW1lbnNpb24gfSBmcm9tICdAL2xpYi90eXBlcydcclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XHJcbiAgY29uc3QgaW50ZXJpbUFwaUVuYWJsZWQgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19JTlRFUklNX0FQSV9FTkFCTEVEICE9PSAnZmFsc2UnXHJcbiAgXHJcbiAgaWYgKCFpbnRlcmltQXBpRW5hYmxlZCkge1xyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgZXJyb3I6ICdJbnRlcmltIHJlc3VsdHMgdGVtcG9yYXJpbHkgdW5hdmFpbGFibGUnLFxyXG4gICAgICBmYWxsYmFjazogdHJ1ZSxcclxuICAgICAgcmVkaXJlY3Q6ICcvYXBpL2Fzc2Vzc21lbnQvY2FsY3VsYXRlJ1xyXG4gICAgfSwgeyBzdGF0dXM6IDUwMyB9KVxyXG4gIH1cclxuXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKVxyXG4gICAgY29uc3QgeyBzZXNzaW9uSWQsIHJlc3BvbnNlcyB9ID0gYm9keVxyXG5cclxuICAgIGlmICghc2Vzc2lvbklkIHx8ICFyZXNwb25zZXMgfHwgIUFycmF5LmlzQXJyYXkocmVzcG9uc2VzKSkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ0ludmFsaWQgcmVxdWVzdCBkYXRhLiBTZXNzaW9uSWQgYW5kIHJlc3BvbnNlcyBhcnJheSByZXF1aXJlZC4nIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICAvLyBGaWx0ZXIgb25seSBjb3JlIHJlc3BvbnNlcyBhbmQgdmFsaWRhdGUgY291bnRcclxuICAgIGNvbnN0IGNvcmVSZXNwb25zZXMgPSByZXNwb25zZXMuZmlsdGVyKHIgPT4gci5xdWVzdGlvblR5cGUgPT09ICdjb3JlJylcclxuICAgIGlmIChjb3JlUmVzcG9uc2VzLmxlbmd0aCAhPT0gNCkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBJbnRlcmltIEFQSTogRXhwZWN0ZWQgNCBjb3JlIHJlc3BvbnNlcywgZ290ICR7Y29yZVJlc3BvbnNlcy5sZW5ndGh9LiBUb3RhbCByZXNwb25zZXM6ICR7cmVzcG9uc2VzLmxlbmd0aH1gKVxyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBcclxuICAgICAgICAgIGVycm9yOiBgSW52YWxpZCBjb3JlIHJlc3BvbnNlcyBjb3VudC4gRXhwZWN0ZWQgNCwgZ290ICR7Y29yZVJlc3BvbnNlcy5sZW5ndGh9YCxcclxuICAgICAgICAgIGRlYnVnOiB7XHJcbiAgICAgICAgICAgIHRvdGFsUmVzcG9uc2VzOiByZXNwb25zZXMubGVuZ3RoLFxyXG4gICAgICAgICAgICBjb3JlUmVzcG9uc2VzOiBjb3JlUmVzcG9uc2VzLmxlbmd0aCxcclxuICAgICAgICAgICAgcmVzcG9uc2VUeXBlczogcmVzcG9uc2VzLm1hcChyID0+IHIucXVlc3Rpb25UeXBlKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBjYWxjdWxhdG9yID0gTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLmdldEluc3RhbmNlKClcclxuICAgIGNvbnN0IGludGVyaW1SZXN1bHQgPSBjYWxjdWxhdG9yLmNhbGN1bGF0ZUludGVyaW1SZXN1bHRzKGNvcmVSZXNwb25zZXMpXHJcblxyXG4gICAgY29uc3QgaW5zaWdodHMgPSBnZW5lcmF0ZUludGVyaW1JbnNpZ2h0cyhpbnRlcmltUmVzdWx0Lm1idGlUeXBlLCBpbnRlcmltUmVzdWx0LmRpbWVuc2lvblNjb3JlcywgYm9keS5sYW5ndWFnZSB8fCAnZW4nKVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGludGVyaW1SZXN1bHQ6IHtcclxuICAgICAgICAuLi5pbnRlcmltUmVzdWx0LFxyXG4gICAgICAgIGNvbmZpZGVuY2U6IE1hdGgubWluKGludGVyaW1SZXN1bHQub3ZlcmFsbENvbmZpZGVuY2UsIDY1KSwgLy8gQ2FwIGNvbmZpZGVuY2UgZm9yIGludGVyaW0gcmVzdWx0c1xyXG4gICAgICAgIGluc2lnaHRzLFxyXG4gICAgICAgIGRpc2NsYWltZXI6IGdldERpc2NsYWltZXIoYm9keS5sYW5ndWFnZSB8fCAnZW4nKSxcclxuICAgICAgfVxyXG4gICAgfSlcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignSW50ZXJpbSBjYWxjdWxhdGlvbiBlcnJvcjonLCBlcnJvcilcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBlcnJvcjogJ0ZhaWxlZCB0byBjYWxjdWxhdGUgaW50ZXJpbSByZXN1bHRzJyB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgIClcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGdlbmVyYXRlSW50ZXJpbUluc2lnaHRzKG1idGlUeXBlOiBzdHJpbmcsIGRpbWVuc2lvblNjb3JlczogYW55W10sIGxhbmd1YWdlOiBzdHJpbmcpOiBzdHJpbmdbXSB7XHJcbiAgY29uc3QgaW5zaWdodHM6IHN0cmluZ1tdID0gW11cclxuICBjb25zdCBpc0FyYWJpYyA9IGxhbmd1YWdlID09PSAnYXInXHJcblxyXG4gIC8vIEluc2lnaHQgYmFzZWQgb24gRS9JIGRpbWVuc2lvblxyXG4gIGNvbnN0IGVpU2NvcmUgPSBkaW1lbnNpb25TY29yZXMuZmluZChkID0+IGQuZGltZW5zaW9uID09PSAnRS9JJylcclxuICBpZiAoZWlTY29yZSkge1xyXG4gICAgaWYgKGVpU2NvcmUucHJlZmVyZW5jZSA9PT0gJ0UnKSB7XHJcbiAgICAgIGluc2lnaHRzLnB1c2goXHJcbiAgICAgICAgaXNBcmFiaWMgXHJcbiAgICAgICAgICA/ICfZitio2K/ZiCDYo9mG2YMg2KrYs9iq2YXYryDYt9in2YLYqtmDINmF2YYg2KfZhNiq2YHYp9i52YQg2YXYuSDYp9mE2KLYrtix2YrZhiDZiNin2YTYudin2YTZhSDYp9mE2K7Yp9ix2KzZiidcclxuICAgICAgICAgIDogJ1lvdSBhcHBlYXIgdG8gZHJhdyBlbmVyZ3kgZnJvbSBpbnRlcmFjdGluZyB3aXRoIG90aGVycyBhbmQgdGhlIGV4dGVybmFsIHdvcmxkJ1xyXG4gICAgICApXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpbnNpZ2h0cy5wdXNoKFxyXG4gICAgICAgIGlzQXJhYmljXHJcbiAgICAgICAgICA/ICfZitio2K/ZiCDYo9mG2YMg2KrZgdi22YQg2KfZhNiq2YHZg9mK2LEg2KfZhNiv2KfYrtmE2Yog2YjYp9mE2KrYo9mF2YQg2YTZhNit2LXZiNmEINi52YTZiSDYp9mE2LfYp9mC2KknXHJcbiAgICAgICAgICA6ICdZb3Ugc2VlbSB0byBwcmVmZXIgaW5uZXIgcmVmbGVjdGlvbiBhbmQgaW50cm9zcGVjdGlvbiBmb3IgZW5lcmd5J1xyXG4gICAgICApXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyBJbnNpZ2h0IGJhc2VkIG9uIFMvTiBkaW1lbnNpb25cclxuICBjb25zdCBzblNjb3JlID0gZGltZW5zaW9uU2NvcmVzLmZpbmQoZCA9PiBkLmRpbWVuc2lvbiA9PT0gJ1MvTicpXHJcbiAgaWYgKHNuU2NvcmUpIHtcclxuICAgIGlmIChzblNjb3JlLnByZWZlcmVuY2UgPT09ICdTJykge1xyXG4gICAgICBpbnNpZ2h0cy5wdXNoKFxyXG4gICAgICAgIGlzQXJhYmljXHJcbiAgICAgICAgICA/ICfYqtmF2YrZhCDYpdmE2Ykg2KfZhNiq2LHZg9mK2LIg2LnZhNmJINin2YTYqtmB2KfYtdmK2YQg2KfZhNmF2YTZhdmI2LPYqSDZiNin2YTYrdmC2KfYptmCINin2YTZiNin2YLYudmK2KknXHJcbiAgICAgICAgICA6ICdZb3UgdGVuZCB0byBmb2N1cyBvbiBjb25jcmV0ZSBkZXRhaWxzIGFuZCBwcmFjdGljYWwgcmVhbGl0aWVzJ1xyXG4gICAgICApXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBpbnNpZ2h0cy5wdXNoKFxyXG4gICAgICAgIGlzQXJhYmljXHJcbiAgICAgICAgICA/ICfYqtmF2YrZhCDYpdmE2Ykg2LHYpNmK2Kkg2KfZhNi12YjYsdipINin2YTZg9io2YrYsdipINmI2KfZhNin2K3YqtmF2KfZhNin2Kog2KfZhNmF2LPYqtmC2KjZhNmK2KknXHJcbiAgICAgICAgICA6ICdZb3UgdGVuZCB0byBzZWUgdGhlIGJpZyBwaWN0dXJlIGFuZCBmdXR1cmUgcG9zc2liaWxpdGllcydcclxuICAgICAgKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gSW5zaWdodCBiYXNlZCBvbiBUL0YgZGltZW5zaW9uXHJcbiAgY29uc3QgdGZTY29yZSA9IGRpbWVuc2lvblNjb3Jlcy5maW5kKGQgPT4gZC5kaW1lbnNpb24gPT09ICdUL0YnKVxyXG4gIGlmICh0ZlNjb3JlKSB7XHJcbiAgICBpZiAodGZTY29yZS5wcmVmZXJlbmNlID09PSAnVCcpIHtcclxuICAgICAgaW5zaWdodHMucHVzaChcclxuICAgICAgICBpc0FyYWJpY1xyXG4gICAgICAgICAgPyAn2KrZgdi22YQg2KfYqtiu2KfYsCDYp9mE2YLYsdin2LHYp9iqINio2YbYp9ih2Ysg2LnZhNmJINin2YTZhdmG2LfZgiDZiNin2YTYqtit2YTZitmEINin2YTZhdmI2LbZiNi52YonXHJcbiAgICAgICAgICA6ICdZb3UgcHJlZmVyIG1ha2luZyBkZWNpc2lvbnMgYmFzZWQgb24gbG9naWMgYW5kIG9iamVjdGl2ZSBhbmFseXNpcydcclxuICAgICAgKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaW5zaWdodHMucHVzaChcclxuICAgICAgICBpc0FyYWJpY1xyXG4gICAgICAgICAgPyAn2KrYo9iu2LAg2YHZiiDYp9mE2KfYudiq2KjYp9ixINin2YTZgtmK2YUg2KfZhNi02K7YtdmK2Kkg2YjYqtij2KvZitixINin2YTZgtix2KfYsdin2Kog2LnZhNmJINin2YTYotiu2LHZitmGJ1xyXG4gICAgICAgICAgOiAnWW91IGNvbnNpZGVyIHBlcnNvbmFsIHZhbHVlcyBhbmQgdGhlIGltcGFjdCBvZiBkZWNpc2lvbnMgb24gb3RoZXJzJ1xyXG4gICAgICApXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXR1cm4gaW5zaWdodHMuc2xpY2UoMCwgMykgLy8gUmV0dXJuIG1heGltdW0gMyBpbnNpZ2h0c1xyXG59XHJcblxyXG5mdW5jdGlvbiBnZXREaXNjbGFpbWVyKGxhbmd1YWdlOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gIHJldHVybiBsYW5ndWFnZSA9PT0gJ2FyJ1xyXG4gICAgPyAn2YfYsNmHINmG2KrYp9im2Kwg2KPZiNmE2YrYqSDYqNmG2KfYodmLINi52YTZiSA0INij2LPYptmE2Kkg2YHZgti3LiDYs9iq2LXYqNitINin2YTZhtiq2KfYptisINij2YPYq9ixINiv2YLYqSDYqNi52K8g2KXZg9mF2KfZhCDYp9mE2KPYs9im2YTYqSDYp9mE2KXYttin2YHZitipLidcclxuICAgIDogJ1RoZXNlIGFyZSBwcmVsaW1pbmFyeSByZXN1bHRzIGJhc2VkIG9uIG9ubHkgNCBxdWVzdGlvbnMuIFJlc3VsdHMgd2lsbCBiZWNvbWUgbW9yZSBhY2N1cmF0ZSBhZnRlciBjb21wbGV0aW5nIGFkZGl0aW9uYWwgcXVlc3Rpb25zLidcclxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJNQlRJQ2FsY3VsYXRvclNlcnZpY2UiLCJQT1NUIiwicmVxdWVzdCIsImludGVyaW1BcGlFbmFibGVkIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX0lOVEVSSU1fQVBJX0VOQUJMRUQiLCJqc29uIiwiZXJyb3IiLCJmYWxsYmFjayIsInJlZGlyZWN0Iiwic3RhdHVzIiwiYm9keSIsInNlc3Npb25JZCIsInJlc3BvbnNlcyIsIkFycmF5IiwiaXNBcnJheSIsImNvcmVSZXNwb25zZXMiLCJmaWx0ZXIiLCJyIiwicXVlc3Rpb25UeXBlIiwibGVuZ3RoIiwiY29uc29sZSIsImRlYnVnIiwidG90YWxSZXNwb25zZXMiLCJyZXNwb25zZVR5cGVzIiwibWFwIiwiY2FsY3VsYXRvciIsImdldEluc3RhbmNlIiwiaW50ZXJpbVJlc3VsdCIsImNhbGN1bGF0ZUludGVyaW1SZXN1bHRzIiwiaW5zaWdodHMiLCJnZW5lcmF0ZUludGVyaW1JbnNpZ2h0cyIsIm1idGlUeXBlIiwiZGltZW5zaW9uU2NvcmVzIiwibGFuZ3VhZ2UiLCJzdWNjZXNzIiwiY29uZmlkZW5jZSIsIk1hdGgiLCJtaW4iLCJvdmVyYWxsQ29uZmlkZW5jZSIsImRpc2NsYWltZXIiLCJnZXREaXNjbGFpbWVyIiwiaXNBcmFiaWMiLCJlaVNjb3JlIiwiZmluZCIsImQiLCJkaW1lbnNpb24iLCJwcmVmZXJlbmNlIiwicHVzaCIsInNuU2NvcmUiLCJ0ZlNjb3JlIiwic2xpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/assessment/calculate-interim/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/MBTICalculatorService.ts":
/*!***************************************************!*\
  !*** ./src/lib/services/MBTICalculatorService.ts ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   MBTICalculatorService: () => (/* binding */ MBTICalculatorService)\n/* harmony export */ });\nclass MBTICalculatorService {\n    constructor(){\n        // SAIS Consciousness Domain Mapping (Arabic)\n        this.consciousnessDomains = {\n            \"E/I\": {\n                name: \"مصدر حيويتك وتفاعلك\",\n                E: {\n                    name: \"التفاعل الخارجي\",\n                    description: \"استمداد الحيوية من التفاعل مع الطيف الواسع من النشاطات والأشخاص\"\n                },\n                I: {\n                    name: \"الانغماس الداخلي\",\n                    description: \"الانغماس في عالمك الداخلي الغني والاتصال بمركز جذري عميق وهادئ\"\n                }\n            },\n            \"S/N\": {\n                name: \"طريقة استقبالك للمعلومات\",\n                S: {\n                    name: \"الواقع المادي\",\n                    description: \"التفاعل مع الواقع المادي الملموس واستخدام الحواس الخمس\"\n                },\n                N: {\n                    name: \"البصيرة الحدسية\",\n                    description: \"الغوص في بحر الاحتمالات والمعاني الخفية باستخدام العين الثالثة\"\n                }\n            },\n            \"T/F\": {\n                name: \"مركز اتخاذ القرار\",\n                T: {\n                    name: \"التحليل المنطقي\",\n                    description: \"تحليل منطقي وموضوعي للحقائق وبناء هيكل عقلي متماسك\"\n                },\n                F: {\n                    name: \"بوصلة القيم الداخلية\",\n                    description: \"الاتصال بمركز القلب والانسجام مع مشاعر الآخرين وقيمك الداخلية\"\n                }\n            },\n            \"J/P\": {\n                name: \"تنظيم عالمك الخارجي\",\n                J: {\n                    name: \"الهيكل المنظم\",\n                    description: \"وضع هيكل زمني ونظام واضح للسيطرة والتنبؤ بالأحداث\"\n                },\n                P: {\n                    name: \"المرونة العفوية\",\n                    description: \"ترك مساحة للمرونة والعفوية وإبقاء الخيارات مفتوحة\"\n                }\n            }\n        };\n    }\n    static getInstance() {\n        if (!MBTICalculatorService.instance) {\n            MBTICalculatorService.instance = new MBTICalculatorService();\n        }\n        return MBTICalculatorService.instance;\n    }\n    calculateMBTI(input) {\n        const { sessionId, responses, methodology, isInterim = false } = input;\n        const dimensionScores = this.calculateDimensionScores(responses, methodology);\n        const mbtiType = this.determineMBTIType(dimensionScores);\n        const overallConfidence = this.calculateOverallConfidence(dimensionScores);\n        // Generate consciousness profile for SAIS methodology\n        let consciousnessProfile = undefined;\n        if (methodology === \"sais\") {\n            consciousnessProfile = this.generateConsciousnessProfile(dimensionScores);\n        }\n        return {\n            sessionId,\n            mbtiType,\n            dimensionScores,\n            overallConfidence,\n            methodology,\n            isInterim,\n            totalResponses: responses.length,\n            consciousnessProfile\n        };\n    }\n    calculateDimensionScores(responses, methodology) {\n        const dimensions = [\n            \"E/I\",\n            \"S/N\",\n            \"T/F\",\n            \"J/P\"\n        ];\n        const scores = [];\n        for (const dimension of dimensions){\n            const dimensionResponses = responses.filter((r)=>r.mbtiDimension === dimension);\n            let rawScoreA = 0;\n            let rawScoreB = 0;\n            for (const response of dimensionResponses){\n                if (methodology === \"sais\" && response.responseType === \"distribution\") {\n                    // For SAIS, we need to consider the tendency mapping\n                    // The distribution points represent strength of preference\n                    const pointsA = response.distributionA || 0;\n                    const pointsB = response.distributionB || 0;\n                    rawScoreA += pointsA;\n                    rawScoreB += pointsB;\n                } else if (response.responseType === \"binary\") {\n                    if (response.selectedOption === \"A\") {\n                        rawScoreA += 1;\n                    } else if (response.selectedOption === \"B\") {\n                        rawScoreB += 1;\n                    }\n                }\n            }\n            const preference = this.determinePreference(dimension, rawScoreA, rawScoreB, dimensionResponses);\n            const confidence = this.calculateConfidence(rawScoreA, rawScoreB, methodology);\n            // SAIS consciousness enhancements\n            let consciousnessPercentage = undefined;\n            let consciousnessDomain = undefined;\n            let totalPossiblePoints = undefined;\n            if (methodology === \"sais\") {\n                totalPossiblePoints = 15 // 3 questions × 5 points per question\n                ;\n                // Calculate consciousness percentage based on tendency tracking for SAIS\n                let winningScore = 0;\n                for (const response of dimensionResponses){\n                    if (response.tendency === preference) {\n                        // Add the distribution points for this tendency\n                        if (response.responseType === \"distribution\") {\n                            const points = response.selectedOption === \"A\" ? response.distributionA : response.distributionB;\n                            winningScore += points;\n                        }\n                    }\n                }\n                consciousnessPercentage = Math.round(winningScore / totalPossiblePoints * 100);\n                consciousnessDomain = this.consciousnessDomains[dimension].name;\n            }\n            scores.push({\n                dimension,\n                rawScoreA,\n                rawScoreB,\n                preference,\n                confidence,\n                consciousnessPercentage,\n                consciousnessDomain,\n                totalPossiblePoints\n            });\n        }\n        return scores;\n    }\n    determinePreference(dimension, scoreA, scoreB, dimensionResponses) {\n        // For SAIS, we need to check the tendency mapping from the responses\n        if (dimensionResponses && dimensionResponses.length > 0) {\n            const saisResponse = dimensionResponses.find((r)=>r.responseType === \"distribution\");\n            if (saisResponse && saisResponse.tendency) {\n                // If we have SAIS responses, use the tendency directly from the response\n                // which was determined based on the question's optionATendency/optionBTendency\n                const tendencyCounts = {};\n                for (const response of dimensionResponses){\n                    if (response.tendency) {\n                        if (!tendencyCounts[response.tendency]) {\n                            tendencyCounts[response.tendency] = 0;\n                        }\n                        // Weight by distribution points for SAIS\n                        if (response.responseType === \"distribution\") {\n                            const weight = response.selectedOption === \"A\" ? response.distributionA || 0 : response.distributionB || 0;\n                            tendencyCounts[response.tendency] += weight;\n                        } else {\n                            tendencyCounts[response.tendency] += 1;\n                        }\n                    }\n                }\n                // Return the tendency with the highest count\n                const preferences = Object.entries(tendencyCounts);\n                if (preferences.length > 0) {\n                    preferences.sort((a, b)=>b[1] - a[1]);\n                    return preferences[0][0];\n                }\n            }\n        }\n        // Fallback to standard mapping for non-SAIS or if tendencies not found\n        const dimensionMap = {\n            \"E/I\": {\n                A: \"E\",\n                B: \"I\"\n            },\n            \"S/N\": {\n                A: \"S\",\n                B: \"N\"\n            },\n            \"T/F\": {\n                A: \"T\",\n                B: \"F\"\n            },\n            \"J/P\": {\n                A: \"J\",\n                B: \"P\"\n            }\n        };\n        return scoreA > scoreB ? dimensionMap[dimension].A : dimensionMap[dimension].B;\n    }\n    calculateConfidence(scoreA, scoreB, methodology) {\n        const total = scoreA + scoreB;\n        if (total === 0) return 50;\n        const higher = Math.max(scoreA, scoreB);\n        let confidence = higher / total * 100;\n        // For SAIS methodology, apply a different confidence scale\n        // since the 5-point distribution allows for more nuanced responses\n        if (methodology === \"sais\") {\n            // SAIS confidence scale:\n            // 5-0 distribution = 100% confidence\n            // 4-1 distribution = 80% confidence  \n            // 3-2 distribution = 60% confidence\n            const difference = Math.abs(scoreA - scoreB);\n            const maxPossibleDifference = total;\n            if (maxPossibleDifference > 0) {\n                // Scale confidence based on the strength of the preference\n                confidence = 50 + difference / maxPossibleDifference * 50;\n            }\n        }\n        return Math.round(confidence);\n    }\n    determineMBTIType(dimensionScores) {\n        const typeString = dimensionScores.map((score)=>score.preference).join(\"\");\n        return typeString;\n    }\n    calculateOverallConfidence(dimensionScores) {\n        const totalConfidence = dimensionScores.reduce((sum, score)=>sum + score.confidence, 0);\n        return Math.round(totalConfidence / dimensionScores.length);\n    }\n    calculateInterimResults(responses) {\n        const dimensionOrder = [\n            \"E/I\",\n            \"S/N\",\n            \"T/F\",\n            \"J/P\"\n        ];\n        const interimResponses = [];\n        for(let i = 0; i < Math.min(4, responses.length); i++){\n            const response = responses[i];\n            if (!response.mbtiDimension && i < dimensionOrder.length) {\n                response.mbtiDimension = dimensionOrder[i];\n            }\n            interimResponses.push(response);\n        }\n        return this.calculateMBTI({\n            sessionId: responses[0]?.sessionId || \"\",\n            responses: interimResponses,\n            methodology: \"scenarios\",\n            isInterim: true\n        });\n    }\n    isSAISScoreValid(distributionA, distributionB) {\n        const validCombinations = [\n            [\n                5,\n                0\n            ],\n            [\n                4,\n                1\n            ],\n            [\n                3,\n                2\n            ],\n            [\n                2,\n                3\n            ],\n            [\n                1,\n                4\n            ],\n            [\n                0,\n                5\n            ]\n        ];\n        return validCombinations.some(([a, b])=>distributionA === a && distributionB === b);\n    }\n    validateSAISDistribution(pointA, pointB) {\n        return pointA >= 0 && pointA <= 5 && pointB >= 0 && pointB <= 5 && pointA + pointB === 5 && Number.isInteger(pointA) && Number.isInteger(pointB);\n    }\n    // SAIS Consciousness Profile Generation\n    generateConsciousnessProfile(dimensionScores) {\n        const getConsciousnessDimension = (dimension)=>{\n            const score = dimensionScores.find((s)=>s.dimension === dimension);\n            const domainData = this.consciousnessDomains[dimension];\n            // Safely access preference data with type checking\n            const preferenceKey = score.preference;\n            const preferenceData = domainData[preferenceKey];\n            if (!preferenceData) {\n                console.warn(`No preference data found for ${dimension}:${score.preference}`);\n                return {\n                    dimension,\n                    preference: score.preference,\n                    percentage: score.consciousnessPercentage || 0,\n                    arabicDomainName: score.preference,\n                    consciousnessDescription: \"وصف غير متاح\"\n                };\n            }\n            return {\n                dimension,\n                preference: score.preference,\n                percentage: score.consciousnessPercentage || 0,\n                arabicDomainName: preferenceData.name,\n                consciousnessDescription: preferenceData.description\n            };\n        };\n        return {\n            energySourcePattern: getConsciousnessDimension(\"E/I\"),\n            awarenessStyle: getConsciousnessDimension(\"S/N\"),\n            decisionMakingCenter: getConsciousnessDimension(\"T/F\"),\n            lifeStructurePreference: getConsciousnessDimension(\"J/P\")\n        };\n    }\n    // Test method for SAIS scoring verification\n    testSAISScoring(responses) {\n        console.log(\"SAIS Scoring Test:\");\n        console.log(\"==================\");\n        const result = this.calculateMBTI({\n            sessionId: \"test-session\",\n            responses,\n            methodology: \"sais\",\n            isInterim: false\n        });\n        console.log(\"MBTI Type:\", result.mbtiType);\n        console.log(\"Overall Confidence:\", result.overallConfidence + \"%\");\n        console.log(\"\\nDimension Breakdown:\");\n        result.dimensionScores.forEach((score)=>{\n            console.log(`${score.dimension}: ${score.preference} (${score.confidence}% confidence)`);\n            console.log(`  Raw scores: A=${score.rawScoreA}, B=${score.rawScoreB}`);\n            if (score.consciousnessPercentage) {\n                console.log(`  Consciousness: ${score.consciousnessPercentage}% - ${score.consciousnessDomain}`);\n            }\n        });\n        // Display consciousness profile\n        if (result.consciousnessProfile) {\n            console.log(\"\\nConsciousness Profile:\");\n            console.log(\"Energy Source:\", result.consciousnessProfile.energySourcePattern.arabicDomainName, `(${result.consciousnessProfile.energySourcePattern.percentage}%)`);\n            console.log(\"Awareness Style:\", result.consciousnessProfile.awarenessStyle.arabicDomainName, `(${result.consciousnessProfile.awarenessStyle.percentage}%)`);\n            console.log(\"Decision Center:\", result.consciousnessProfile.decisionMakingCenter.arabicDomainName, `(${result.consciousnessProfile.decisionMakingCenter.percentage}%)`);\n            console.log(\"Life Structure:\", result.consciousnessProfile.lifeStructurePreference.arabicDomainName, `(${result.consciousnessProfile.lifeStructurePreference.percentage}%)`);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL01CVElDYWxjdWxhdG9yU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7O0FBWU8sTUFBTUE7SUEyQlgsYUFBc0I7UUF4QnRCLDZDQUE2QzthQUM1QkMsdUJBQXVCO1lBQ3RDLE9BQU87Z0JBQ0xDLE1BQU07Z0JBQ05DLEdBQUc7b0JBQUVELE1BQU07b0JBQW1CRSxhQUFhO2dCQUFrRTtnQkFDN0dDLEdBQUc7b0JBQUVILE1BQU07b0JBQW9CRSxhQUFhO2dCQUFpRTtZQUMvRztZQUNBLE9BQU87Z0JBQ0xGLE1BQU07Z0JBQ05JLEdBQUc7b0JBQUVKLE1BQU07b0JBQWlCRSxhQUFhO2dCQUF5RDtnQkFDbEdHLEdBQUc7b0JBQUVMLE1BQU07b0JBQW1CRSxhQUFhO2dCQUFpRTtZQUM5RztZQUNBLE9BQU87Z0JBQ0xGLE1BQU07Z0JBQ05NLEdBQUc7b0JBQUVOLE1BQU07b0JBQW1CRSxhQUFhO2dCQUFxRDtnQkFDaEdLLEdBQUc7b0JBQUVQLE1BQU07b0JBQXdCRSxhQUFhO2dCQUFnRTtZQUNsSDtZQUNBLE9BQU87Z0JBQ0xGLE1BQU07Z0JBQ05RLEdBQUc7b0JBQUVSLE1BQU07b0JBQWlCRSxhQUFhO2dCQUFvRDtnQkFDN0ZPLEdBQUc7b0JBQUVULE1BQU07b0JBQW1CRSxhQUFhO2dCQUFvRDtZQUNqRztRQUNGO0lBRXVCO0lBRXZCLE9BQWNRLGNBQXFDO1FBQ2pELElBQUksQ0FBQ1osc0JBQXNCYSxRQUFRLEVBQUU7WUFDbkNiLHNCQUFzQmEsUUFBUSxHQUFHLElBQUliO1FBQ3ZDO1FBQ0EsT0FBT0Esc0JBQXNCYSxRQUFRO0lBQ3ZDO0lBRU9DLGNBQWNDLEtBQW1CLEVBQWlCO1FBQ3ZELE1BQU0sRUFBRUMsU0FBUyxFQUFFQyxTQUFTLEVBQUVDLFdBQVcsRUFBRUMsWUFBWSxLQUFLLEVBQUUsR0FBR0o7UUFFakUsTUFBTUssa0JBQWtCLElBQUksQ0FBQ0Msd0JBQXdCLENBQUNKLFdBQVdDO1FBQ2pFLE1BQU1JLFdBQVcs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Q0FBQ0osZ0JBQWdCLEVBQ3JGLENBQUMsQ0FBQyxFQUFFUSxPQUFPM0Ysb0JBQW9CLENBQUN1RixvQkFBb0IsQ0FBQ0wsVUFBVSxDQUFDLEVBQUUsQ0FBQztZQUMvRUYsUUFBUVUsR0FBRyxDQUFDLG1CQUFtQkMsT0FBTzNGLG9CQUFvQixDQUFDd0YsdUJBQXVCLENBQUNMLGdCQUFnQixFQUN2RixDQUFDLENBQUMsRUFBRVEsT0FBTzNGLG9CQUFvQixDQUFDd0YsdUJBQXVCLENBQUNOLFVBQVUsQ0FBQyxFQUFFLENBQUM7UUFDcEY7SUFDRjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbWJ0aS1jb2FjaGluZy1wbGF0Zm9ybS8uL3NyYy9saWIvc2VydmljZXMvTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLnRzPzIyYjUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcclxuICBRdWVzdGlvblJlc3BvbnNlLFxyXG4gIE1CVElUeXBlLFxyXG4gIE1CVElEaW1lbnNpb24sXHJcbiAgU2NvcmluZ0lucHV0LFxyXG4gIFNjb3JpbmdSZXN1bHQsXHJcbiAgRGltZW5zaW9uU2NvcmUsXHJcbiAgTWV0aG9kb2xvZ3lUeXBlLFxyXG4gIENvbnNjaW91c25lc3NQcm9maWxlLFxyXG4gIENvbnNjaW91c25lc3NEaW1lbnNpb24sXHJcbn0gZnJvbSAnQC9saWIvdHlwZXMnXHJcblxyXG5leHBvcnQgY2xhc3MgTUJUSUNhbGN1bGF0b3JTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogTUJUSUNhbGN1bGF0b3JTZXJ2aWNlXHJcblxyXG4gIC8vIFNBSVMgQ29uc2Npb3VzbmVzcyBEb21haW4gTWFwcGluZyAoQXJhYmljKVxyXG4gIHByaXZhdGUgcmVhZG9ubHkgY29uc2Npb3VzbmVzc0RvbWFpbnMgPSB7XHJcbiAgICAnRS9JJzoge1xyXG4gICAgICBuYW1lOiAn2YXYtdiv2LEg2K3ZitmI2YrYqtmDINmI2KrZgdin2LnZhNmDJyxcclxuICAgICAgRTogeyBuYW1lOiAn2KfZhNiq2YHYp9i52YQg2KfZhNiu2KfYsdis2YonLCBkZXNjcmlwdGlvbjogJ9in2LPYqtmF2K/Yp9ivINin2YTYrdmK2YjZitipINmF2YYg2KfZhNiq2YHYp9i52YQg2YXYuSDYp9mE2LfZitmBINin2YTZiNin2LPYuSDZhdmGINin2YTZhti02KfYt9in2Kog2YjYp9mE2KPYtNiu2KfYtScgfSxcclxuICAgICAgSTogeyBuYW1lOiAn2KfZhNin2YbYutmF2KfYsyDYp9mE2K/Yp9iu2YTZiicsIGRlc2NyaXB0aW9uOiAn2KfZhNin2YbYutmF2KfYsyDZgdmKINi52KfZhNmF2YMg2KfZhNiv2KfYrtmE2Yog2KfZhNi62YbZiiDZiNin2YTYp9iq2LXYp9mEINio2YXYsdmD2LIg2KzYsNix2Yog2LnZhdmK2YIg2YjZh9in2K/YpicgfVxyXG4gICAgfSxcclxuICAgICdTL04nOiB7XHJcbiAgICAgIG5hbWU6ICfYt9ix2YrZgtipINin2LPYqtmC2KjYp9mE2YMg2YTZhNmF2LnZhNmI2YXYp9iqJyxcclxuICAgICAgUzogeyBuYW1lOiAn2KfZhNmI2KfZgti5INin2YTZhdin2K/ZiicsIGRlc2NyaXB0aW9uOiAn2KfZhNiq2YHYp9i52YQg2YXYuSDYp9mE2YjYp9mC2Lkg2KfZhNmF2KfYr9mKINin2YTZhdmE2YXZiNizINmI2KfYs9iq2K7Yr9in2YUg2KfZhNit2YjYp9izINin2YTYrtmF2LMnIH0sXHJcbiAgICAgIE46IHsgbmFtZTogJ9in2YTYqNi12YrYsdipINin2YTYrdiv2LPZitipJywgZGVzY3JpcHRpb246ICfYp9mE2LrZiNi1INmB2Yog2KjYrdixINin2YTYp9it2KrZhdin2YTYp9iqINmI2KfZhNmF2LnYp9mG2Yog2KfZhNiu2YHZitipINio2KfYs9iq2K7Yr9in2YUg2KfZhNi52YrZhiDYp9mE2KvYp9mE2KvYqScgfVxyXG4gICAgfSxcclxuICAgICdUL0YnOiB7XHJcbiAgICAgIG5hbWU6ICfZhdix2YPYsiDYp9iq2K7Yp9iwINin2YTZgtix2KfYsScsXHJcbiAgICAgIFQ6IHsgbmFtZTogJ9in2YTYqtit2YTZitmEINin2YTZhdmG2LfZgtmKJywgZGVzY3JpcHRpb246ICfYqtit2YTZitmEINmF2YbYt9mC2Yog2YjZhdmI2LbZiNi52Yog2YTZhNit2YLYp9im2YIg2YjYqNmG2KfYoSDZh9mK2YPZhCDYudmC2YTZiiDZhdiq2YXYp9iz2YMnIH0sXHJcbiAgICAgIEY6IHsgbmFtZTogJ9io2YjYtdmE2Kkg2KfZhNmC2YrZhSDYp9mE2K/Yp9iu2YTZitipJywgZGVzY3JpcHRpb246ICfYp9mE2KfYqti12KfZhCDYqNmF2LHZg9iyINin2YTZgtmE2Kgg2YjYp9mE2KfZhtiz2KzYp9mFINmF2Lkg2YXYtNin2LnYsSDYp9mE2KLYrtix2YrZhiDZiNmC2YrZhdmDINin2YTYr9in2K7ZhNmK2KknIH1cclxuICAgIH0sXHJcbiAgICAnSi9QJzoge1xyXG4gICAgICBuYW1lOiAn2KrZhti42YrZhSDYudin2YTZhdmDINin2YTYrtin2LHYrNmKJyxcclxuICAgICAgSjogeyBuYW1lOiAn2KfZhNmH2YrZg9mEINin2YTZhdmG2LjZhScsIGRlc2NyaXB0aW9uOiAn2YjYtti5INmH2YrZg9mEINiy2YXZhtmKINmI2YbYuNin2YUg2YjYp9i22K0g2YTZhNiz2YrYt9ix2Kkg2YjYp9mE2KrZhtio2KQg2KjYp9mE2KPYrdiv2KfYqycgfSxcclxuICAgICAgUDogeyBuYW1lOiAn2KfZhNmF2LHZiNmG2Kkg2KfZhNi52YHZiNmK2KknLCBkZXNjcmlwdGlvbjogJ9iq2LHZgyDZhdiz2KfYrdipINmE2YTZhdix2YjZhtipINmI2KfZhNi52YHZiNmK2Kkg2YjYpdio2YLYp9ihINin2YTYrtmK2KfYsdin2Kog2YXZgdiq2YjYrdipJyB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNvbnN0cnVjdG9yKCkge31cclxuXHJcbiAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW5jZSgpOiBNQlRJQ2FsY3VsYXRvclNlcnZpY2Uge1xyXG4gICAgaWYgKCFNQlRJQ2FsY3VsYXRvclNlcnZpY2UuaW5zdGFuY2UpIHtcclxuICAgICAgTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLmluc3RhbmNlID0gbmV3IE1CVElDYWxjdWxhdG9yU2VydmljZSgpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gTUJUSUNhbGN1bGF0b3JTZXJ2aWNlLmluc3RhbmNlXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgY2FsY3VsYXRlTUJUSShpbnB1dDogU2NvcmluZ0lucHV0KTogU2NvcmluZ1Jlc3VsdCB7XHJcbiAgICBjb25zdCB7IHNlc3Npb25JZCwgcmVzcG9uc2VzLCBtZXRob2RvbG9neSwgaXNJbnRlcmltID0gZmFsc2UgfSA9IGlucHV0XHJcblxyXG4gICAgY29uc3QgZGltZW5zaW9uU2NvcmVzID0gdGhpcy5jYWxjdWxhdGVEaW1lbnNpb25TY29yZXMocmVzcG9uc2VzLCBtZXRob2RvbG9neSlcclxuICAgIGNvbnN0IG1idGlUeXBlID0gdGhpcy5kZXRlcm1pbmVNQlRJVHlwZShkaW1lbnNpb25TY29yZXMpXHJcbiAgICBjb25zdCBvdmVyYWxsQ29uZmlkZW5jZSA9IHRoaXMuY2FsY3VsYXRlT3ZlcmFsbENvbmZpZGVuY2UoZGltZW5zaW9uU2NvcmVzKVxyXG5cclxuICAgIC8vIEdlbmVyYXRlIGNvbnNjaW91c25lc3MgcHJvZmlsZSBmb3IgU0FJUyBtZXRob2RvbG9neVxyXG4gICAgbGV0IGNvbnNjaW91c25lc3NQcm9maWxlOiBDb25zY2lvdXNuZXNzUHJvZmlsZSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxyXG4gICAgaWYgKG1ldGhvZG9sb2d5ID09PSAnc2FpcycpIHtcclxuICAgICAgY29uc2Npb3VzbmVzc1Byb2ZpbGUgPSB0aGlzLmdlbmVyYXRlQ29uc2Npb3VzbmVzc1Byb2ZpbGUoZGltZW5zaW9uU2NvcmVzKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHNlc3Npb25JZCxcclxuICAgICAgbWJ0aVR5cGUsXHJcbiAgICAgIGRpbWVuc2lvblNjb3JlcyxcclxuICAgICAgb3ZlcmFsbENvbmZpZGVuY2UsXHJcbiAgICAgIG1ldGhvZG9sb2d5LFxyXG4gICAgICBpc0ludGVyaW0sXHJcbiAgICAgIHRvdGFsUmVzcG9uc2VzOiByZXNwb25zZXMubGVuZ3RoLFxyXG4gICAgICBjb25zY2lvdXNuZXNzUHJvZmlsZSxcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgY2FsY3VsYXRlRGltZW5zaW9uU2NvcmVzKFxyXG4gICAgcmVzcG9uc2VzOiBRdWVzdGlvblJlc3BvbnNlW10sXHJcbiAgICBtZXRob2RvbG9neTogTWV0aG9kb2xvZ3lUeXBlXHJcbiAgKTogRGltZW5zaW9uU2NvcmVbXSB7XHJcbiAgICBjb25zdCBkaW1lbnNpb25zOiBNQlRJRGltZW5zaW9uW10gPSBbJ0UvSScsICdTL04nLCAnVC9GJywgJ0ovUCddXHJcbiAgICBjb25zdCBzY29yZXM6IERpbWVuc2lvblNjb3JlW10gPSBbXVxyXG5cclxuICAgIGZvciAoY29uc3QgZGltZW5zaW9uIG9mIGRpbWVuc2lvbnMpIHtcclxuICAgICAgY29uc3QgZGltZW5zaW9uUmVzcG9uc2VzID0gcmVzcG9uc2VzLmZpbHRlcihyID0+IHIubWJ0aURpbWVuc2lvbiA9PT0gZGltZW5zaW9uKVxyXG4gICAgICBcclxuICAgICAgbGV0IHJhd1Njb3JlQSA9IDBcclxuICAgICAgbGV0IHJhd1Njb3JlQiA9IDBcclxuXHJcbiAgICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgZGltZW5zaW9uUmVzcG9uc2VzKSB7XHJcbiAgICAgICAgaWYgKG1ldGhvZG9sb2d5ID09PSAnc2FpcycgJiYgcmVzcG9uc2UucmVzcG9uc2VUeXBlID09PSAnZGlzdHJpYnV0aW9uJykge1xyXG4gICAgICAgICAgLy8gRm9yIFNBSVMsIHdlIG5lZWQgdG8gY29uc2lkZXIgdGhlIHRlbmRlbmN5IG1hcHBpbmdcclxuICAgICAgICAgIC8vIFRoZSBkaXN0cmlidXRpb24gcG9pbnRzIHJlcHJlc2VudCBzdHJlbmd0aCBvZiBwcmVmZXJlbmNlXHJcbiAgICAgICAgICBjb25zdCBwb2ludHNBID0gcmVzcG9uc2UuZGlzdHJpYnV0aW9uQSB8fCAwXHJcbiAgICAgICAgICBjb25zdCBwb2ludHNCID0gcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiB8fCAwXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHJhd1Njb3JlQSArPSBwb2ludHNBXHJcbiAgICAgICAgICByYXdTY29yZUIgKz0gcG9pbnRzQlxyXG4gICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2UucmVzcG9uc2VUeXBlID09PSAnYmluYXJ5Jykge1xyXG4gICAgICAgICAgaWYgKHJlc3BvbnNlLnNlbGVjdGVkT3B0aW9uID09PSAnQScpIHtcclxuICAgICAgICAgICAgcmF3U2NvcmVBICs9IDFcclxuICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc2VsZWN0ZWRPcHRpb24gPT09ICdCJykge1xyXG4gICAgICAgICAgICByYXdTY29yZUIgKz0gMVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgcHJlZmVyZW5jZSA9IHRoaXMuZGV0ZXJtaW5lUHJlZmVyZW5jZShkaW1lbnNpb24sIHJhd1Njb3JlQSwgcmF3U2NvcmVCLCBkaW1lbnNpb25SZXNwb25zZXMpXHJcbiAgICAgIGNvbnN0IGNvbmZpZGVuY2UgPSB0aGlzLmNhbGN1bGF0ZUNvbmZpZGVuY2UocmF3U2NvcmVBLCByYXdTY29yZUIsIG1ldGhvZG9sb2d5KVxyXG5cclxuICAgICAgLy8gU0FJUyBjb25zY2lvdXNuZXNzIGVuaGFuY2VtZW50c1xyXG4gICAgICBsZXQgY29uc2Npb3VzbmVzc1BlcmNlbnRhZ2U6IG51bWJlciB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZFxyXG4gICAgICBsZXQgY29uc2Npb3VzbmVzc0RvbWFpbjogc3RyaW5nIHwgdW5kZWZpbmVkID0gdW5kZWZpbmVkXHJcbiAgICAgIGxldCB0b3RhbFBvc3NpYmxlUG9pbnRzOiBudW1iZXIgfCB1bmRlZmluZWQgPSB1bmRlZmluZWRcclxuXHJcbiAgICAgIGlmIChtZXRob2RvbG9neSA9PT0gJ3NhaXMnKSB7XHJcbiAgICAgICAgdG90YWxQb3NzaWJsZVBvaW50cyA9IDE1IC8vIDMgcXVlc3Rpb25zIMOXIDUgcG9pbnRzIHBlciBxdWVzdGlvblxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIENhbGN1bGF0ZSBjb25zY2lvdXNuZXNzIHBlcmNlbnRhZ2UgYmFzZWQgb24gdGVuZGVuY3kgdHJhY2tpbmcgZm9yIFNBSVNcclxuICAgICAgICBsZXQgd2lubmluZ1Njb3JlID0gMFxyXG4gICAgICAgIGZvciAoY29uc3QgcmVzcG9uc2Ugb2YgZGltZW5zaW9uUmVzcG9uc2VzKSB7XHJcbiAgICAgICAgICBpZiAocmVzcG9uc2UudGVuZGVuY3kgPT09IHByZWZlcmVuY2UpIHtcclxuICAgICAgICAgICAgLy8gQWRkIHRoZSBkaXN0cmlidXRpb24gcG9pbnRzIGZvciB0aGlzIHRlbmRlbmN5XHJcbiAgICAgICAgICAgIGlmIChyZXNwb25zZS5yZXNwb25zZVR5cGUgPT09ICdkaXN0cmlidXRpb24nKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcG9pbnRzID0gcmVzcG9uc2Uuc2VsZWN0ZWRPcHRpb24gPT09ICdBJyA/IHJlc3BvbnNlLmRpc3RyaWJ1dGlvbkEhIDogcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiFcclxuICAgICAgICAgICAgICB3aW5uaW5nU2NvcmUgKz0gcG9pbnRzXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc2Npb3VzbmVzc1BlcmNlbnRhZ2UgPSBNYXRoLnJvdW5kKCh3aW5uaW5nU2NvcmUgLyB0b3RhbFBvc3NpYmxlUG9pbnRzKSAqIDEwMClcclxuICAgICAgICBjb25zY2lvdXNuZXNzRG9tYWluID0gdGhpcy5jb25zY2lvdXNuZXNzRG9tYWluc1tkaW1lbnNpb25dLm5hbWVcclxuICAgICAgfVxyXG5cclxuICAgICAgc2NvcmVzLnB1c2goe1xyXG4gICAgICAgIGRpbWVuc2lvbixcclxuICAgICAgICByYXdTY29yZUEsXHJcbiAgICAgICAgcmF3U2NvcmVCLFxyXG4gICAgICAgIHByZWZlcmVuY2UsXHJcbiAgICAgICAgY29uZmlkZW5jZSxcclxuICAgICAgICBjb25zY2lvdXNuZXNzUGVyY2VudGFnZSxcclxuICAgICAgICBjb25zY2lvdXNuZXNzRG9tYWluLFxyXG4gICAgICAgIHRvdGFsUG9zc2libGVQb2ludHMsXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHNjb3Jlc1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBkZXRlcm1pbmVQcmVmZXJlbmNlKFxyXG4gICAgZGltZW5zaW9uOiBNQlRJRGltZW5zaW9uLFxyXG4gICAgc2NvcmVBOiBudW1iZXIsXHJcbiAgICBzY29yZUI6IG51bWJlcixcclxuICAgIGRpbWVuc2lvblJlc3BvbnNlcz86IFF1ZXN0aW9uUmVzcG9uc2VbXVxyXG4gICk6IHN0cmluZyB7XHJcbiAgICAvLyBGb3IgU0FJUywgd2UgbmVlZCB0byBjaGVjayB0aGUgdGVuZGVuY3kgbWFwcGluZyBmcm9tIHRoZSByZXNwb25zZXNcclxuICAgIGlmIChkaW1lbnNpb25SZXNwb25zZXMgJiYgZGltZW5zaW9uUmVzcG9uc2VzLmxlbmd0aCA+IDApIHtcclxuICAgICAgY29uc3Qgc2Fpc1Jlc3BvbnNlID0gZGltZW5zaW9uUmVzcG9uc2VzLmZpbmQociA9PiByLnJlc3BvbnNlVHlwZSA9PT0gJ2Rpc3RyaWJ1dGlvbicpXHJcbiAgICAgIGlmIChzYWlzUmVzcG9uc2UgJiYgc2Fpc1Jlc3BvbnNlLnRlbmRlbmN5KSB7XHJcbiAgICAgICAgLy8gSWYgd2UgaGF2ZSBTQUlTIHJlc3BvbnNlcywgdXNlIHRoZSB0ZW5kZW5jeSBkaXJlY3RseSBmcm9tIHRoZSByZXNwb25zZVxyXG4gICAgICAgIC8vIHdoaWNoIHdhcyBkZXRlcm1pbmVkIGJhc2VkIG9uIHRoZSBxdWVzdGlvbidzIG9wdGlvbkFUZW5kZW5jeS9vcHRpb25CVGVuZGVuY3lcclxuICAgICAgICBjb25zdCB0ZW5kZW5jeUNvdW50czogUmVjb3JkPHN0cmluZywgbnVtYmVyPiA9IHt9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yIChjb25zdCByZXNwb25zZSBvZiBkaW1lbnNpb25SZXNwb25zZXMpIHtcclxuICAgICAgICAgIGlmIChyZXNwb25zZS50ZW5kZW5jeSkge1xyXG4gICAgICAgICAgICBpZiAoIXRlbmRlbmN5Q291bnRzW3Jlc3BvbnNlLnRlbmRlbmN5XSkge1xyXG4gICAgICAgICAgICAgIHRlbmRlbmN5Q291bnRzW3Jlc3BvbnNlLnRlbmRlbmN5XSA9IDBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAvLyBXZWlnaHQgYnkgZGlzdHJpYnV0aW9uIHBvaW50cyBmb3IgU0FJU1xyXG4gICAgICAgICAgICBpZiAocmVzcG9uc2UucmVzcG9uc2VUeXBlID09PSAnZGlzdHJpYnV0aW9uJykge1xyXG4gICAgICAgICAgICAgIGNvbnN0IHdlaWdodCA9IHJlc3BvbnNlLnNlbGVjdGVkT3B0aW9uID09PSAnQScgXHJcbiAgICAgICAgICAgICAgICA/IHJlc3BvbnNlLmRpc3RyaWJ1dGlvbkEgfHwgMCBcclxuICAgICAgICAgICAgICAgIDogcmVzcG9uc2UuZGlzdHJpYnV0aW9uQiB8fCAwXHJcbiAgICAgICAgICAgICAgdGVuZGVuY3lDb3VudHNbcmVzcG9uc2UudGVuZGVuY3ldICs9IHdlaWdodFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHRlbmRlbmN5Q291bnRzW3Jlc3BvbnNlLnRlbmRlbmN5XSArPSAxXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmV0dXJuIHRoZSB0ZW5kZW5jeSB3aXRoIHRoZSBoaWdoZXN0IGNvdW50XHJcbiAgICAgICAgY29uc3QgcHJlZmVyZW5jZXMgPSBPYmplY3QuZW50cmllcyh0ZW5kZW5jeUNvdW50cylcclxuICAgICAgICBpZiAocHJlZmVyZW5jZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgcHJlZmVyZW5jZXMuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pXHJcbiAgICAgICAgICByZXR1cm4gcHJlZmVyZW5jZXNbMF1bMF1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gRmFsbGJhY2sgdG8gc3RhbmRhcmQgbWFwcGluZyBmb3Igbm9uLVNBSVMgb3IgaWYgdGVuZGVuY2llcyBub3QgZm91bmRcclxuICAgIGNvbnN0IGRpbWVuc2lvbk1hcDogUmVjb3JkPE1CVElEaW1lbnNpb24sIHsgQTogc3RyaW5nOyBCOiBzdHJpbmcgfT4gPSB7XHJcbiAgICAgICdFL0knOiB7IEE6ICdFJywgQjogJ0knIH0sXHJcbiAgICAgICdTL04nOiB7IEE6ICdTJywgQjogJ04nIH0sXHJcbiAgICAgICdUL0YnOiB7IEE6ICdUJywgQjogJ0YnIH0sXHJcbiAgICAgICdKL1AnOiB7IEE6ICdKJywgQjogJ1AnIH0sXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHNjb3JlQSA+IHNjb3JlQiA/IGRpbWVuc2lvbk1hcFtkaW1lbnNpb25dLkEgOiBkaW1lbnNpb25NYXBbZGltZW5zaW9uXS5CXHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNhbGN1bGF0ZUNvbmZpZGVuY2Uoc2NvcmVBOiBudW1iZXIsIHNjb3JlQjogbnVtYmVyLCBtZXRob2RvbG9neT86IE1ldGhvZG9sb2d5VHlwZSk6IG51bWJlciB7XHJcbiAgICBjb25zdCB0b3RhbCA9IHNjb3JlQSArIHNjb3JlQlxyXG4gICAgaWYgKHRvdGFsID09PSAwKSByZXR1cm4gNTBcclxuXHJcbiAgICBjb25zdCBoaWdoZXIgPSBNYXRoLm1heChzY29yZUEsIHNjb3JlQilcclxuICAgIGxldCBjb25maWRlbmNlID0gKGhpZ2hlciAvIHRvdGFsKSAqIDEwMFxyXG4gICAgXHJcbiAgICAvLyBGb3IgU0FJUyBtZXRob2RvbG9neSwgYXBwbHkgYSBkaWZmZXJlbnQgY29uZmlkZW5jZSBzY2FsZVxyXG4gICAgLy8gc2luY2UgdGhlIDUtcG9pbnQgZGlzdHJpYnV0aW9uIGFsbG93cyBmb3IgbW9yZSBudWFuY2VkIHJlc3BvbnNlc1xyXG4gICAgaWYgKG1ldGhvZG9sb2d5ID09PSAnc2FpcycpIHtcclxuICAgICAgLy8gU0FJUyBjb25maWRlbmNlIHNjYWxlOlxyXG4gICAgICAvLyA1LTAgZGlzdHJpYnV0aW9uID0gMTAwJSBjb25maWRlbmNlXHJcbiAgICAgIC8vIDQtMSBkaXN0cmlidXRpb24gPSA4MCUgY29uZmlkZW5jZSAgXHJcbiAgICAgIC8vIDMtMiBkaXN0cmlidXRpb24gPSA2MCUgY29uZmlkZW5jZVxyXG4gICAgICBjb25zdCBkaWZmZXJlbmNlID0gTWF0aC5hYnMoc2NvcmVBIC0gc2NvcmVCKVxyXG4gICAgICBjb25zdCBtYXhQb3NzaWJsZURpZmZlcmVuY2UgPSB0b3RhbFxyXG4gICAgICBcclxuICAgICAgaWYgKG1heFBvc3NpYmxlRGlmZmVyZW5jZSA+IDApIHtcclxuICAgICAgICAvLyBTY2FsZSBjb25maWRlbmNlIGJhc2VkIG9uIHRoZSBzdHJlbmd0aCBvZiB0aGUgcHJlZmVyZW5jZVxyXG4gICAgICAgIGNvbmZpZGVuY2UgPSA1MCArIChkaWZmZXJlbmNlIC8gbWF4UG9zc2libGVEaWZmZXJlbmNlKSAqIDUwXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQoY29uZmlkZW5jZSlcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZGV0ZXJtaW5lTUJUSVR5cGUoZGltZW5zaW9uU2NvcmVzOiBEaW1lbnNpb25TY29yZVtdKTogTUJUSVR5cGUge1xyXG4gICAgY29uc3QgdHlwZVN0cmluZyA9IGRpbWVuc2lvblNjb3Jlc1xyXG4gICAgICAubWFwKHNjb3JlID0+IHNjb3JlLnByZWZlcmVuY2UpXHJcbiAgICAgIC5qb2luKCcnKVxyXG4gICAgXHJcbiAgICByZXR1cm4gdHlwZVN0cmluZyBhcyBNQlRJVHlwZVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjYWxjdWxhdGVPdmVyYWxsQ29uZmlkZW5jZShkaW1lbnNpb25TY29yZXM6IERpbWVuc2lvblNjb3JlW10pOiBudW1iZXIge1xyXG4gICAgY29uc3QgdG90YWxDb25maWRlbmNlID0gZGltZW5zaW9uU2NvcmVzLnJlZHVjZShcclxuICAgICAgKHN1bSwgc2NvcmUpID0+IHN1bSArIHNjb3JlLmNvbmZpZGVuY2UsXHJcbiAgICAgIDBcclxuICAgIClcclxuICAgIFxyXG4gICAgcmV0dXJuIE1hdGgucm91bmQodG90YWxDb25maWRlbmNlIC8gZGltZW5zaW9uU2NvcmVzLmxlbmd0aClcclxuICB9XHJcblxyXG4gIHB1YmxpYyBjYWxjdWxhdGVJbnRlcmltUmVzdWx0cyhyZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSk6IFNjb3JpbmdSZXN1bHQge1xyXG4gICAgY29uc3QgZGltZW5zaW9uT3JkZXI6IE1CVElEaW1lbnNpb25bXSA9IFsnRS9JJywgJ1MvTicsICdUL0YnLCAnSi9QJ11cclxuICAgIGNvbnN0IGludGVyaW1SZXNwb25zZXM6IFF1ZXN0aW9uUmVzcG9uc2VbXSA9IFtdXHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBNYXRoLm1pbig0LCByZXNwb25zZXMubGVuZ3RoKTsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gcmVzcG9uc2VzW2ldXHJcbiAgICAgIGlmICghcmVzcG9uc2UubWJ0aURpbWVuc2lvbiAmJiBpIDwgZGltZW5zaW9uT3JkZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgcmVzcG9uc2UubWJ0aURpbWVuc2lvbiA9IGRpbWVuc2lvbk9yZGVyW2ldXHJcbiAgICAgIH1cclxuICAgICAgaW50ZXJpbVJlc3BvbnNlcy5wdXNoKHJlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB0aGlzLmNhbGN1bGF0ZU1CVEkoe1xyXG4gICAgICBzZXNzaW9uSWQ6IHJlc3BvbnNlc1swXT8uc2Vzc2lvbklkIHx8ICcnLFxyXG4gICAgICByZXNwb25zZXM6IGludGVyaW1SZXNwb25zZXMsXHJcbiAgICAgIG1ldGhvZG9sb2d5OiAnc2NlbmFyaW9zJyxcclxuICAgICAgaXNJbnRlcmltOiB0cnVlLFxyXG4gICAgfSlcclxuICB9XHJcblxyXG4gIHB1YmxpYyBpc1NBSVNTY29yZVZhbGlkKGRpc3RyaWJ1dGlvbkE6IG51bWJlciwgZGlzdHJpYnV0aW9uQjogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICBjb25zdCB2YWxpZENvbWJpbmF0aW9ucyA9IFtcclxuICAgICAgWzUsIDBdLCBbNCwgMV0sIFszLCAyXSwgWzIsIDNdLCBbMSwgNF0sIFswLCA1XVxyXG4gICAgXVxyXG4gICAgXHJcbiAgICByZXR1cm4gdmFsaWRDb21iaW5hdGlvbnMuc29tZShcclxuICAgICAgKFthLCBiXSkgPT4gZGlzdHJpYnV0aW9uQSA9PT0gYSAmJiBkaXN0cmlidXRpb25CID09PSBiXHJcbiAgICApXHJcbiAgfVxyXG5cclxuICBwdWJsaWMgdmFsaWRhdGVTQUlTRGlzdHJpYnV0aW9uKHBvaW50QTogbnVtYmVyLCBwb2ludEI6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgcG9pbnRBID49IDAgJiYgcG9pbnRBIDw9IDUgJiZcclxuICAgICAgcG9pbnRCID49IDAgJiYgcG9pbnRCIDw9IDUgJiZcclxuICAgICAgcG9pbnRBICsgcG9pbnRCID09PSA1ICYmXHJcbiAgICAgIE51bWJlci5pc0ludGVnZXIocG9pbnRBKSAmJlxyXG4gICAgICBOdW1iZXIuaXNJbnRlZ2VyKHBvaW50QilcclxuICAgIClcclxuICB9XHJcblxyXG4gIC8vIFNBSVMgQ29uc2Npb3VzbmVzcyBQcm9maWxlIEdlbmVyYXRpb25cclxuICBwcml2YXRlIGdlbmVyYXRlQ29uc2Npb3VzbmVzc1Byb2ZpbGUoZGltZW5zaW9uU2NvcmVzOiBEaW1lbnNpb25TY29yZVtdKTogQ29uc2Npb3VzbmVzc1Byb2ZpbGUge1xyXG4gICAgY29uc3QgZ2V0Q29uc2Npb3VzbmVzc0RpbWVuc2lvbiA9IChkaW1lbnNpb246IE1CVElEaW1lbnNpb24pOiBDb25zY2lvdXNuZXNzRGltZW5zaW9uID0+IHtcclxuICAgICAgY29uc3Qgc2NvcmUgPSBkaW1lbnNpb25TY29yZXMuZmluZChzID0+IHMuZGltZW5zaW9uID09PSBkaW1lbnNpb24pIVxyXG4gICAgICBjb25zdCBkb21haW5EYXRhID0gdGhpcy5jb25zY2lvdXNuZXNzRG9tYWluc1tkaW1lbnNpb25dXHJcbiAgICAgIFxyXG4gICAgICAvLyBTYWZlbHkgYWNjZXNzIHByZWZlcmVuY2UgZGF0YSB3aXRoIHR5cGUgY2hlY2tpbmdcclxuICAgICAgY29uc3QgcHJlZmVyZW5jZUtleSA9IHNjb3JlLnByZWZlcmVuY2UgYXMgJ0UnIHwgJ0knIHwgJ1MnIHwgJ04nIHwgJ1QnIHwgJ0YnIHwgJ0onIHwgJ1AnXHJcbiAgICAgIGNvbnN0IHByZWZlcmVuY2VEYXRhID0gKGRvbWFpbkRhdGEgYXMgYW55KVtwcmVmZXJlbmNlS2V5XSBhcyB7IG5hbWU6IHN0cmluZzsgZGVzY3JpcHRpb246IHN0cmluZyB9XHJcbiAgICAgIFxyXG4gICAgICBpZiAoIXByZWZlcmVuY2VEYXRhKSB7XHJcbiAgICAgICAgY29uc29sZS53YXJuKGBObyBwcmVmZXJlbmNlIGRhdGEgZm91bmQgZm9yICR7ZGltZW5zaW9ufToke3Njb3JlLnByZWZlcmVuY2V9YClcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgZGltZW5zaW9uLFxyXG4gICAgICAgICAgcHJlZmVyZW5jZTogc2NvcmUucHJlZmVyZW5jZSxcclxuICAgICAgICAgIHBlcmNlbnRhZ2U6IHNjb3JlLmNvbnNjaW91c25lc3NQZXJjZW50YWdlIHx8IDAsXHJcbiAgICAgICAgICBhcmFiaWNEb21haW5OYW1lOiBzY29yZS5wcmVmZXJlbmNlLFxyXG4gICAgICAgICAgY29uc2Npb3VzbmVzc0Rlc2NyaXB0aW9uOiAn2YjYtdmBINi62YrYsSDZhdiq2KfYrScsXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4ge1xyXG4gICAgICAgIGRpbWVuc2lvbixcclxuICAgICAgICBwcmVmZXJlbmNlOiBzY29yZS5wcmVmZXJlbmNlLFxyXG4gICAgICAgIHBlcmNlbnRhZ2U6IHNjb3JlLmNvbnNjaW91c25lc3NQZXJjZW50YWdlIHx8IDAsXHJcbiAgICAgICAgYXJhYmljRG9tYWluTmFtZTogcHJlZmVyZW5jZURhdGEubmFtZSxcclxuICAgICAgICBjb25zY2lvdXNuZXNzRGVzY3JpcHRpb246IHByZWZlcmVuY2VEYXRhLmRlc2NyaXB0aW9uLFxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgZW5lcmd5U291cmNlUGF0dGVybjogZ2V0Q29uc2Npb3VzbmVzc0RpbWVuc2lvbignRS9JJyksXHJcbiAgICAgIGF3YXJlbmVzc1N0eWxlOiBnZXRDb25zY2lvdXNuZXNzRGltZW5zaW9uKCdTL04nKSwgXHJcbiAgICAgIGRlY2lzaW9uTWFraW5nQ2VudGVyOiBnZXRDb25zY2lvdXNuZXNzRGltZW5zaW9uKCdUL0YnKSxcclxuICAgICAgbGlmZVN0cnVjdHVyZVByZWZlcmVuY2U6IGdldENvbnNjaW91c25lc3NEaW1lbnNpb24oJ0ovUCcpLFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gVGVzdCBtZXRob2QgZm9yIFNBSVMgc2NvcmluZyB2ZXJpZmljYXRpb25cclxuICBwdWJsaWMgdGVzdFNBSVNTY29yaW5nKHJlc3BvbnNlczogUXVlc3Rpb25SZXNwb25zZVtdKTogdm9pZCB7XHJcbiAgICBjb25zb2xlLmxvZygnU0FJUyBTY29yaW5nIFRlc3Q6JylcclxuICAgIGNvbnNvbGUubG9nKCc9PT09PT09PT09PT09PT09PT0nKVxyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLmNhbGN1bGF0ZU1CVEkoe1xyXG4gICAgICBzZXNzaW9uSWQ6ICd0ZXN0LXNlc3Npb24nLFxyXG4gICAgICByZXNwb25zZXMsXHJcbiAgICAgIG1ldGhvZG9sb2d5OiAnc2FpcycsXHJcbiAgICAgIGlzSW50ZXJpbTogZmFsc2UsXHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZygnTUJUSSBUeXBlOicsIHJlc3VsdC5tYnRpVHlwZSlcclxuICAgIGNvbnNvbGUubG9nKCdPdmVyYWxsIENvbmZpZGVuY2U6JywgcmVzdWx0Lm92ZXJhbGxDb25maWRlbmNlICsgJyUnKVxyXG4gICAgY29uc29sZS5sb2coJ1xcbkRpbWVuc2lvbiBCcmVha2Rvd246JylcclxuICAgIFxyXG4gICAgcmVzdWx0LmRpbWVuc2lvblNjb3Jlcy5mb3JFYWNoKHNjb3JlID0+IHtcclxuICAgICAgY29uc29sZS5sb2coYCR7c2NvcmUuZGltZW5zaW9ufTogJHtzY29yZS5wcmVmZXJlbmNlfSAoJHtzY29yZS5jb25maWRlbmNlfSUgY29uZmlkZW5jZSlgKVxyXG4gICAgICBjb25zb2xlLmxvZyhgICBSYXcgc2NvcmVzOiBBPSR7c2NvcmUucmF3U2NvcmVBfSwgQj0ke3Njb3JlLnJhd1Njb3JlQn1gKVxyXG4gICAgICBpZiAoc2NvcmUuY29uc2Npb3VzbmVzc1BlcmNlbnRhZ2UpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgICBDb25zY2lvdXNuZXNzOiAke3Njb3JlLmNvbnNjaW91c25lc3NQZXJjZW50YWdlfSUgLSAke3Njb3JlLmNvbnNjaW91c25lc3NEb21haW59YClcclxuICAgICAgfVxyXG4gICAgfSlcclxuXHJcbiAgICAvLyBEaXNwbGF5IGNvbnNjaW91c25lc3MgcHJvZmlsZVxyXG4gICAgaWYgKHJlc3VsdC5jb25zY2lvdXNuZXNzUHJvZmlsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygnXFxuQ29uc2Npb3VzbmVzcyBQcm9maWxlOicpXHJcbiAgICAgIGNvbnNvbGUubG9nKCdFbmVyZ3kgU291cmNlOicsIHJlc3VsdC5jb25zY2lvdXNuZXNzUHJvZmlsZS5lbmVyZ3lTb3VyY2VQYXR0ZXJuLmFyYWJpY0RvbWFpbk5hbWUsIFxyXG4gICAgICAgICAgICAgICAgICBgKCR7cmVzdWx0LmNvbnNjaW91c25lc3NQcm9maWxlLmVuZXJneVNvdXJjZVBhdHRlcm4ucGVyY2VudGFnZX0lKWApXHJcbiAgICAgIGNvbnNvbGUubG9nKCdBd2FyZW5lc3MgU3R5bGU6JywgcmVzdWx0LmNvbnNjaW91c25lc3NQcm9maWxlLmF3YXJlbmVzc1N0eWxlLmFyYWJpY0RvbWFpbk5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIGAoJHtyZXN1bHQuY29uc2Npb3VzbmVzc1Byb2ZpbGUuYXdhcmVuZXNzU3R5bGUucGVyY2VudGFnZX0lKWApXHJcbiAgICAgIGNvbnNvbGUubG9nKCdEZWNpc2lvbiBDZW50ZXI6JywgcmVzdWx0LmNvbnNjaW91c25lc3NQcm9maWxlLmRlY2lzaW9uTWFraW5nQ2VudGVyLmFyYWJpY0RvbWFpbk5hbWUsXHJcbiAgICAgICAgICAgICAgICAgIGAoJHtyZXN1bHQuY29uc2Npb3VzbmVzc1Byb2ZpbGUuZGVjaXNpb25NYWtpbmdDZW50ZXIucGVyY2VudGFnZX0lKWApXHJcbiAgICAgIGNvbnNvbGUubG9nKCdMaWZlIFN0cnVjdHVyZTonLCByZXN1bHQuY29uc2Npb3VzbmVzc1Byb2ZpbGUubGlmZVN0cnVjdHVyZVByZWZlcmVuY2UuYXJhYmljRG9tYWluTmFtZSxcclxuICAgICAgICAgICAgICAgICAgYCgke3Jlc3VsdC5jb25zY2lvdXNuZXNzUHJvZmlsZS5saWZlU3RydWN0dXJlUHJlZmVyZW5jZS5wZXJjZW50YWdlfSUpYClcclxuICAgIH1cclxuICB9XHJcbn0iXSwibmFtZXMiOlsiTUJUSUNhbGN1bGF0b3JTZXJ2aWNlIiwiY29uc2Npb3VzbmVzc0RvbWFpbnMiLCJuYW1lIiwiRSIsImRlc2NyaXB0aW9uIiwiSSIsIlMiLCJOIiwiVCIsIkYiLCJKIiwiUCIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJjYWxjdWxhdGVNQlRJIiwiaW5wdXQiLCJzZXNzaW9uSWQiLCJyZXNwb25zZXMiLCJtZXRob2RvbG9neSIsImlzSW50ZXJpbSIsImRpbWVuc2lvblNjb3JlcyIsImNhbGN1bGF0ZURpbWVuc2lvblNjb3JlcyIsIm1idGlUeXBlIiwiZGV0ZXJtaW5lTUJUSVR5cGUiLCJvdmVyYWxsQ29uZmlkZW5jZSIsImNhbGN1bGF0ZU92ZXJhbGxDb25maWRlbmNlIiwiY29uc2Npb3VzbmVzc1Byb2ZpbGUiLCJ1bmRlZmluZWQiLCJnZW5lcmF0ZUNvbnNjaW91c25lc3NQcm9maWxlIiwidG90YWxSZXNwb25zZXMiLCJsZW5ndGgiLCJkaW1lbnNpb25zIiwic2NvcmVzIiwiZGltZW5zaW9uIiwiZGltZW5zaW9uUmVzcG9uc2VzIiwiZmlsdGVyIiwiciIsIm1idGlEaW1lbnNpb24iLCJyYXdTY29yZUEiLCJyYXdTY29yZUIiLCJyZXNwb25zZSIsInJlc3BvbnNlVHlwZSIsInBvaW50c0EiLCJkaXN0cmlidXRpb25BIiwicG9pbnRzQiIsImRpc3RyaWJ1dGlvbkIiLCJzZWxlY3RlZE9wdGlvbiIsInByZWZlcmVuY2UiLCJkZXRlcm1pbmVQcmVmZXJlbmNlIiwiY29uZmlkZW5jZSIsImNhbGN1bGF0ZUNvbmZpZGVuY2UiLCJjb25zY2lvdXNuZXNzUGVyY2VudGFnZSIsImNvbnNjaW91c25lc3NEb21haW4iLCJ0b3RhbFBvc3NpYmxlUG9pbnRzIiwid2lubmluZ1Njb3JlIiwidGVuZGVuY3kiLCJwb2ludHMiLCJNYXRoIiwicm91bmQiLCJwdXNoIiwic2NvcmVBIiwic2NvcmVCIiwic2Fpc1Jlc3BvbnNlIiwiZmluZCIsInRlbmRlbmN5Q291bnRzIiwid2VpZ2h0IiwicHJlZmVyZW5jZXMiLCJPYmplY3QiLCJlbnRyaWVzIiwic29ydCIsImEiLCJiIiwiZGltZW5zaW9uTWFwIiwiQSIsIkIiLCJ0b3RhbCIsImhpZ2hlciIsIm1heCIsImRpZmZlcmVuY2UiLCJhYnMiLCJtYXhQb3NzaWJsZURpZmZlcmVuY2UiLCJ0eXBlU3RyaW5nIiwibWFwIiwic2NvcmUiLCJqb2luIiwidG90YWxDb25maWRlbmNlIiwicmVkdWNlIiwic3VtIiwiY2FsY3VsYXRlSW50ZXJpbVJlc3VsdHMiLCJkaW1lbnNpb25PcmRlciIsImludGVyaW1SZXNwb25zZXMiLCJpIiwibWluIiwiaXNTQUlTU2NvcmVWYWxpZCIsInZhbGlkQ29tYmluYXRpb25zIiwic29tZSIsInZhbGlkYXRlU0FJU0Rpc3RyaWJ1dGlvbiIsInBvaW50QSIsInBvaW50QiIsIk51bWJlciIsImlzSW50ZWdlciIsImdldENvbnNjaW91c25lc3NEaW1lbnNpb24iLCJzIiwiZG9tYWluRGF0YSIsInByZWZlcmVuY2VLZXkiLCJwcmVmZXJlbmNlRGF0YSIsImNvbnNvbGUiLCJ3YXJuIiwicGVyY2VudGFnZSIsImFyYWJpY0RvbWFpbk5hbWUiLCJjb25zY2lvdXNuZXNzRGVzY3JpcHRpb24iLCJlbmVyZ3lTb3VyY2VQYXR0ZXJuIiwiYXdhcmVuZXNzU3R5bGUiLCJkZWNpc2lvbk1ha2luZ0NlbnRlciIsImxpZmVTdHJ1Y3R1cmVQcmVmZXJlbmNlIiwidGVzdFNBSVNTY29yaW5nIiwibG9nIiwicmVzdWx0IiwiZm9yRWFjaCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/MBTICalculatorService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&page=%2Fapi%2Fassessment%2Fcalculate-interim%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fassessment%2Fcalculate-interim%2Froute.ts&appDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cam112%5COneDrive%5C%D8%B3%D8%B7%D8%AD%20%D8%A7%D9%84%D9%85%D9%83%D8%AA%D8%A8%5CClients%5CMBTI&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();