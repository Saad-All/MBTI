(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[34],{7863:function(e,s,t){Promise.resolve().then(t.bind(t,7007))},257:function(e,s,t){"use strict";var n,r;e.exports=(null==(n=t.g.process)?void 0:n.env)&&"object"==typeof(null==(r=t.g.process)?void 0:r.env)?t.g.process:t(4227)},4227:function(e){!function(){var s={229:function(e){var s,t,n,r=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(s===setTimeout)return setTimeout(e,0);if((s===i||!s)&&setTimeout)return s=setTimeout,setTimeout(e,0);try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}!function(){try{s="function"==typeof setTimeout?setTimeout:i}catch(e){s=i}try{t="function"==typeof clearTimeout?clearTimeout:o}catch(e){t=o}}();var l=[],c=!1,u=-1;function m(){c&&n&&(c=!1,n.length?l=n.concat(l):u=-1,l.length&&d())}function d(){if(!c){var e=a(m);c=!0;for(var s=l.length;s;){for(n=l,l=[];++u<s;)n&&n[u].run();u=-1,s=l.length}n=null,c=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===o||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{t(e)}catch(s){try{return t.call(null,e)}catch(s){return t.call(this,e)}}}(e)}}function p(e,s){this.fun=e,this.array=s}function h(){}r.nextTick=function(e){var s=Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)s[t-1]=arguments[t];l.push(new p(e,s)),1!==l.length||c||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=h,r.addListener=h,r.once=h,r.off=h,r.removeListener=h,r.removeAllListeners=h,r.emit=h,r.prependListener=h,r.prependOnceListener=h,r.listeners=function(e){return[]},r.binding=function(e){throw Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw Error("process.chdir is not supported")},r.umask=function(){return 0}}},t={};function n(e){var r=t[e];if(void 0!==r)return r.exports;var i=t[e]={exports:{}},o=!0;try{s[e](i,i.exports,n),o=!1}finally{o&&delete t[e]}return i.exports}n.ab="//";var r=n(229);e.exports=r}()},7007:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var n=t(7437),r=t(2265),i=t(9376),o=t(3949),a=t(1186),l=t(4292),c=t(257);function u(){let e="false"!==c.env.NEXT_PUBLIC_INTERIM_RESULTS_ENABLED,s=(0,i.useRouter)(),{t}=(0,o.$G)(),{sessionId:u,responses:m,language:d,interimResults:p,setInterimResults:h,setCurrentStep:f,updateProgress:g}=(0,a.u7)(),[x,b]=(0,r.useState)(!0),[y,v]=(0,r.useState)(null);return((0,r.useEffect)(()=>{if(console.log("Interim page - responses:",m.length,"sessionId:",u),!u){console.error("No session ID found, redirecting to home"),s.push("/".concat(d));return}if(f("interim-results"),!e){s.push("/".concat(d,"/assessment/format"));return}(async()=>{console.log("All responses:",m),console.log("Response details:",m.map(e=>({id:e.questionId,type:e.questionType,dimension:e.mbtiDimension,option:e.selectedOption})));let e=m.filter(e=>"core"===e.questionType);if(console.log("Core responses found:",e.length),e.length<4){console.error("Not enough core responses:",e.length,"Total responses:",m.length),e.length>0&&e.length<4&&console.error("Partial responses detected, state might be corrupted"),setTimeout(()=>{s.push("/".concat(d,"/assessment/core"))},500);return}try{let s=await fetch("/api/assessment/calculate-interim",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:u,responses:e,language:d})});if(!s.ok)throw Error("Failed to calculate interim results");let t=await s.json();h(t.interimResult),g(30),b(!1)}catch(e){console.error("Error fetching interim results:",e),v(t("interim.error")),b(!1)}})()},[u,m,d,e,s,h,g,t,f]),x)?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600",children:t("interim.loading")})]})}):y?(0,n.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center text-red-600",children:[(0,n.jsx)("p",{children:y}),(0,n.jsx)(l.z,{onClick:()=>s.push("/".concat(d,"/assessment/core")),className:"mt-4",children:t("common.tryAgain")})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:(0,n.jsxs)("div",{className:"max-w-2xl w-full bg-white rounded-2xl shadow-xl p-8",children:[(0,n.jsxs)("div",{className:"text-center mb-8",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:t("interim.title")}),(0,n.jsx)("p",{className:"text-gray-600",children:t("interim.subtitle")})]}),p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-8 text-center",children:[(0,n.jsx)("div",{className:"inline-flex items-center justify-center w-32 h-32 bg-indigo-100 rounded-full mb-4",children:(0,n.jsx)("span",{className:"text-4xl font-bold text-indigo-600",children:p.mbtiType})}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:t("interim.confidenceLevel",{confidence:p.confidence})})]}),(0,n.jsxs)("div",{className:"space-y-4 mb-8",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:t("interim.insightsTitle")}),p.insights.map((e,s)=>(0,n.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,n.jsx)("p",{className:"text-gray-700",children:e})},s))]}),(0,n.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-8",children:(0,n.jsxs)("p",{className:"text-sm text-amber-800",children:[(0,n.jsxs)("span",{className:"font-semibold",children:[t("interim.note"),": "]}),p.disclaimer]})}),(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)(l.z,{onClick:()=>{f("format-selection"),s.push("/".concat(d,"/assessment/format"))},size:"lg",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700",children:t("interim.continueButton")})})]})]})})}},4292:function(e,s,t){"use strict";t.d(s,{z:function(){return r}});var n=t(7437);let r=(0,t(2265).forwardRef)((e,s)=>{let{className:t,children:r,variant:i="primary",size:o="md",disabled:a,loading:l,onClick:c,type:u="button",...m}=e;return(0,n.jsxs)("button",{ref:s,type:u,disabled:a||l,onClick:c,className:function(){for(var e,s,t=0,n="",r=arguments.length;t<r;t++)(e=arguments[t])&&(s=function e(s){var t,n,r="";if("string"==typeof s||"number"==typeof s)r+=s;else if("object"==typeof s){if(Array.isArray(s)){var i=s.length;for(t=0;t<i;t++)s[t]&&(n=e(s[t]))&&(r&&(r+=" "),r+=n)}else for(n in s)s[n]&&(r&&(r+=" "),r+=n)}return r}(e))&&(n&&(n+=" "),n+=s);return n}("inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-600 text-white hover:bg-gray-700",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50",ghost:"text-gray-700 hover:bg-gray-100"}[i],{sm:"h-8 px-3 text-sm",md:"h-10 px-4 py-2",lg:"h-12 px-8 text-lg"}[o],t),...m,children:[l&&(0,n.jsxs)("svg",{className:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r]})});r.displayName="Button"},1186:function(e,s,t){"use strict";t.d(s,{u7:function(){return l}});var n=t(9625),r=t(6885);let i={sessionId:"",currentStep:"welcome",language:"en",responses:[],selectedFormat:null,progress:0,isComplete:!1},o={theme:"light",direction:"ltr",sidebarOpen:!1,currentPage:"home"},a=(0,n.Ue)()((0,r.mW)((0,r.tJ)((e,s)=>({assessment:i,ui:o,setSessionId:s=>e(e=>({assessment:{...e.assessment,sessionId:s}})),setCurrentStep:s=>e(e=>({assessment:{...e.assessment,currentStep:s}})),setLanguage:s=>e(e=>({assessment:{...e.assessment,language:s},ui:{...e.ui,direction:"ar"===s?"rtl":"ltr"}})),addResponse:s=>e(e=>{let t;let n=e.assessment.responses.findIndex(e=>e.questionId===s.questionId);return n>=0?(t=[...e.assessment.responses])[n]=s:t=[...e.assessment.responses,s],{assessment:{...e.assessment,responses:t}}}),setResponses:s=>e(e=>({assessment:{...e.assessment,responses:s}})),setSelectedFormat:s=>e(e=>({assessment:{...e.assessment,selectedFormat:s}})),updateProgress:s=>e(e=>({assessment:{...e.assessment,progress:s}})),setProgress:s=>e(e=>({assessment:{...e.assessment,progress:s}})),completeAssessment:()=>e(e=>({assessment:{...e.assessment,isComplete:!0,currentStep:"results"}})),resetAssessment:()=>e(e=>({assessment:{...i,language:e.assessment.language}})),setInterimResults:s=>e(e=>({assessment:{...e.assessment,interimResults:s}})),setTheme:s=>e(e=>({ui:{...e.ui,theme:s}})),setDirection:s=>e(e=>({ui:{...e.ui,direction:s}})),toggleSidebar:()=>e(e=>({ui:{...e.ui,sidebarOpen:!e.ui.sidebarOpen}})),setCurrentPage:s=>e(e=>({ui:{...e.ui,currentPage:s}}))}),{name:"mbti-app-store",partialize:e=>({assessment:e.assessment,ui:{theme:e.ui.theme,direction:e.ui.direction}})}),{name:"MBTI App Store"})),l=()=>a(e=>({sessionId:e.assessment.sessionId,currentStep:e.assessment.currentStep,language:e.assessment.language,responses:e.assessment.responses,selectedFormat:e.assessment.selectedFormat,progress:e.assessment.progress,isComplete:e.assessment.isComplete,interimResults:e.assessment.interimResults,setSessionId:e.setSessionId,setCurrentStep:e.setCurrentStep,setLanguage:e.setLanguage,addResponse:e.addResponse,setResponses:e.setResponses,setSelectedFormat:e.setSelectedFormat,updateProgress:e.updateProgress,setProgress:e.setProgress,completeAssessment:e.completeAssessment,resetAssessment:e.resetAssessment,setInterimResults:e.setInterimResults}))}},function(e){e.O(0,[949,299,971,117,744],function(){return e(e.s=7863)}),_N_E=e.O()}]);